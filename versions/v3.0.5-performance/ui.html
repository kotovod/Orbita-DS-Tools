<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Orbita DS ‚ú¶ Tools</title>
  <link rel="icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0nMTYnIGhlaWdodD0nMTYnIHZpZXdCb3g9JzAgMCAxNiAxNicgZmlsbD0nbm9uZScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJz48ZyBjbGlwLXBhdGg9J3VybCgjY2xpcDBfNTMxXzI3MDMpJz48cGF0aCBmaWxsLXJ1bGU9J2V2ZW5vZGQnIGNsaXAtcnVsZT0nZXZlbm9kZCcgZD0nTTggMEM5LjU2NTk5IDQuNjc0MTdlLTA3IDEwLjkyMDQgMS44MDAxMyAxMS41NzcxIDQuNDIxODhDMTQuMTk5NSA1LjA3ODQ3IDE2IDYuNDMzNzkgMTYgOEMxNiA5LjU2NjE3IDE0LjE5OTQgMTAuOTIwNSAxMS41NzcxIDExLjU3NzFDMTAuOTIwNSAxNC4xOTk0IDkuNTY2MTcgMTYgOCAxNkM2LjQzMzc5IDE2IDUuMDc4NDcgMTQuMTk5NSA0LjQyMTg4IDExLjU3NzFDMS44MDAxMyAxMC45MjA0IDAgOS41NjU5OSAwIDhDMCA2LjQzMzk3IDEuOCA1LjA3ODU2IDQuNDIxODggNC40MjE4OEM1LjA3ODU2IDEuOCA2LjQzMzk3IDYuODQ1MzRlLTA4IDggMFpNOS4zODQ3NyAxMS45Mzg1QzguOTM0OTIgMTEuOTc3NyA4LjQ3MjMyIDEyIDggMTJDNy41MjczNSAxMiA3LjA2NDQxIDExLjk3NzggNi42MTQyNiAxMS45Mzg1QzYuNzIwMTEgMTIuMjM5MSA2LjgzNjA2IDEyLjUxNDkgNi45NTk5NiAxMi43NjI3QzcuMjM4NTQgMTMuMzE5OCA3LjUxODc0IDEzLjY2MjMgNy43MzQzOCAxMy44NDQ3QzcuODM3MzUgMTMuOTMxOCA3LjkxMTYyIDEzLjk3MDEgNy45NTExNyAxMy45ODYzQzcuOTcwNjUgMTMuOTk0MyA3Ljk4MzM1IDEzLjk5NzggNy45ODkyNiAxMy45OTlDNy45OTQ4IDE0LjAwMDEgNy45OTc5IDE0IDggMTRDOC4wMDIxIDE0IDguMDA1MiAxNC4wMDAxIDguMDEwNzQgMTMuOTk5QzguMDE2NjUgMTMuOTk3OCA4LjAyOTM1IDEzLjk5NDMgOC4wNDg4MyAxMy45ODYzQzguMDg4MzggMTMuOTcwMSA4LjE2MjY1IDEzLjkzMTggOC4yNjU2MiAxMy44NDQ3QzguNDgxMjYgMTMuNjYyMyA4Ljc2MTQ2IDEzLjMxOTggOS4wNDAwNCAxMi43NjI3QzkuMTYzOSAxMi41MTUgOS4yNzg5NCAxMi4yMzg5IDkuMzg0NzcgMTEuOTM4NVpNOCA2QzYuODk1NDMgNiA2IDYuODk1NDMgNiA4QzYgOS4xMDQ1NyA2Ljg5NTQzIDEwIDggMTBDOS4xMDQ1NyAxMCAxMCA5LjEwNDU3IDEwIDhDMTAgNi44OTU0MyA5LjEwNDU3IDYgOCA2Wk00LjA2MDU1IDYuNjE0MjZDMy43NjAzMSA2LjcyMDAzIDMuNDg0ODggNi44MzYxNyAzLjIzNzMgNi45NTk5NkMyLjY4MDE2IDcuMjM4NTQgMi4zMzc2OSA3LjUxODc0IDIuMTU1MjcgNy43MzQzOEMyLjA2ODE3IDcuODM3MzUgMi4wMjk4OSA3LjkxMTYyIDIuMDEzNjcgNy45NTExN0MyLjAwNTcgNy45NzA2NSAyLjAwMjE4IDcuOTgzMzUgMi4wMDA5OCA3Ljk4OTI2QzEuOTk5ODYgNy45OTQ4IDIgNy45OTc5IDIgOEMyIDguMDAyMSAxLjk5OTg2IDguMDA1MiAyLjAwMDk4IDguMDEwNzRDMi4wMDIxOCA4LjAxNjY1IDIuMDA1NyA4LjAyOTM1IDIuMDEzNjcgOC4wNDg4M0MyLjAyOTg5IDguMDg4MzggMi4wNjgxNyA4LjE2MjY1IDIuMTU1MjcgOC4yNjU2MkMyLjMzNzY5IDguNDgxMjYgMi42ODAxNiA4Ljc2MTQ2IDMuMjM3MyA5LjA0MDA0QzMuNDg0NzkgOS4xNjM3OCAzLjc2MDQzIDkuMjc5MDMgNC4wNjA1NSA5LjM4NDc3QzQuMDIxMyA4LjkzNDk1IDQgOC40NzIyOSA0IDhDNCA3LjUyNzM3IDQuMDIxMjQgNy4wNjQzOCA0LjA2MDU1IDYuNjE0MjZaTTExLjkzODUgNi42MTQyNkMxMS45Nzc4IDcuMDY0NDEgMTIgNy41MjczNCAxMiA4QzEyIDguNDcyMzIgMTEuOTc3NyA4LjkzNDkyIDExLjkzODUgOS4zODQ3N0MxMi4yMzg5IDkuMjc4OTQgMTIuNTE1IDkuMTYzOSAxMi43NjI3IDkuMDQwMDRDMTMuMzE5OCA4Ljc2MTQ2IDEzLjY2MjMgOC40ODEyNiAxMy44NDQ3IDguMjY1NjJDMTMuOTMxOCA4LjE2MjY1IDEzLjk3MDEgOC4wODgzOCAxMy45ODYzIDguMDQ4ODNDMTMuOTk0MyA4LjAyOTM1IDEzLjk5NzggOC4wMTY2NSAxMy45OTkgOC4wMTA3NEMxNC4wMDAxIDguMDA1MiAxNCA4LjAwMjEgMTQgOEMxNCA3Ljk5NzkgMTQuMDAwMSA3Ljk5NDggMTMuOTk5IDcuOTg5MjZDMTMuOTk3OCA3Ljk4MzM1IDEzLjk5NDMgNy45NzA2NSAxMy45ODYzIDcuOTUxMTdDMTMuOTcwMSA3LjkxMTYyIDEzLjkzMTggNy44MzczNSAxMy44NDQ3IDcuNzM0MzhDMTMuNjYyMyA3LjUxODc0IDEzLjMxOTggNy4yMzg1NCAxMi43NjI3IDYuOTU5OTZDMTIuNTE0OSA2LjgzNjA2IDEyLjIzOTEgNi43MjAxMSAxMS45Mzg1IDYuNjE0MjZaTTcuOTg5MjYgMi4wMDA5OEM3Ljk4MzM1IDIuMDAyMTggNy45NzA2NSAyLjAwNTcgNy45NTExNyAyLjAxMzY3QzcuOTExNjIgMi4wMjk4OSA3LjgzNzM1IDIuMDY4MTcgNy43MzQzOCAyLjE1NTI3QzcuNTE4NzQgMi4zMzc2OSA3LjIzODU0IDIuNjgwMTYgNi45NTk5NiAzLjIzNzNDNi44MzYxNyAzLjQ4NDg4IDYuNzIwMDMgMy43NjAzMSA2LjYxNDI2IDQuMDYwNTVDNy4wNjQzOCA0LjAyMTI0IDcuNTI3MzcgNCA4IDRDOC40NzIyOSA0IDguOTM0OTUgNC4wMjEzIDkuMzg0NzcgNC4wNjA1NUM5LjI3OTAzIDMuNzYwNDMgOS4xNjM3OCAzLjQ4NDc5IDkuMDQwMDQgMy4yMzczQzguNzYxNDYgMi42ODAxNiA4LjQ4MTI2IDIuMzM3NjkgOC4yNjU2MiAyLjE1NTI3QzguMTYyNjUgMi4wNjgxNyA4LjA4ODM4IDIuMDI5ODkgOC4wNDg4MyAyLjAxMzY3QzguMDI5MzUgMi4wMDU3IDguMDE2NjUgMi4wMDIxOCA4LjAxMDc0IDIuMDAwOThDOC4wMDUyIDEuOTk5ODYgOC4wMDIxIDIgOCAyQzcuOTk3OSAyIDcuOTk0OCAxLjk5OTg2IDcuOTg5MjYgMi4wMDA5OFonIGZpbGw9J3doaXRlJy8+PC9nPjxkZWZzPjxjbGlwUGF0aCBpZD0nY2xpcDBfNTMxXzI3MDMnPjxyZWN0IHdpZHRoPScxNicgaGVpZ2h0PScxNicgZmlsbD0nd2hpdGUnLz48L2NsaXBQYXRoPjwvZGVmcz48L3N2Zz4K">
  
  <!-- JSZip library for creating ZIP archives - –ø–æ–ø—Ä–æ–±—É–µ–º –¥—Ä—É–≥–æ–π CDN -->
  <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
  <style>
    body {
      font-family: 'Inter', 'Roboto', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #34343C;
      color: #FFFFFF;
      font-size: 14px;
      line-height: 1.5;
      overflow-y: auto;
      overflow-x: hidden;
      max-height: 100vh;
      min-height: 100vh;
      width: 100%;
    }

    html {
      background-color: #34343C;
      margin: 0;
      padding: 0;
      height: 100%;
    }

    /* –£–±–∏—Ä–∞–µ–º –ª—é–±—ã–µ –±–µ–ª—ã–µ –ø—Ä–æ—Å–≤–µ—Ç—ã */
    .header-container,
    .content-container,
    .button-container {
      background-color: inherit;
    }

    /* Iframe –≤ Figma –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ–Ω */
    * {
      box-sizing: border-box;
    }
    
    /* –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background-color: #34343c;
      border-radius: 0px;
    }
    
    ::-webkit-scrollbar-thumb {
      background-color: #505059;
      border-radius: 0px;
      transition: background-color 0.3s ease;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background-color: #F86025;
    }
    
    ::-webkit-scrollbar-corner {
      background-color: #34343C;
    }
    
    /* –ë–∞–∑–æ–≤—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes slideInDown {
      from {
        transform: translateY(-20px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }
    
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    
    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
      40% { transform: translateY(-5px); }
      60% { transform: translateY(-2px); }
    }
    
    /* –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è —Å–∏–º–≤–æ–ª–∞ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ */
    @keyframes starSpin {
      0% { transform: scale(1) rotate(0deg); color: #F86025; }
      25% { transform: scale(1.5) rotate(90deg); color: #FFD700; }
      50% { transform: scale(2) rotate(180deg); color: #FF9168; }
      75% { transform: scale(1.5) rotate(270deg); color: #F86025; }
      100% { transform: scale(1) rotate(360deg); color: #F86025; }
    }
    
    @keyframes starGlow {
      0% { text-shadow: 0 0 5px rgba(255, 215, 0, 0.3); }
      50% { text-shadow: 0 0 20px rgba(255, 215, 0, 0.8), 0 0 30px rgba(255, 138, 101, 0.6); }
      100% { text-shadow: 0 0 5px rgba(255, 215, 0, 0.3); }
    }
    
    @keyframes starColor {
      0% { color: #F86025; }
      25% { color: #FFD700; }
      50% { color: #FF9168; }
      75% { color: #F86025; }
      100% { color: #F86025; }
    }
    
    /* –ö–ª–∞—Å—Å—ã –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π */
    .animate-fadeIn {
      animation: fadeIn 0.25s ease forwards;
    }
    
    .animate-slideIn {
      animation: slideInDown 0.25s ease forwards;
    }
    
    .animate-pulse {
      animation: pulse 0.5s ease infinite;
    }
    
    .star-animation {
      display: inline-block;
      animation: starSpin 3s ease-in-out, starGlow 3s ease-in-out, starColor 3s ease-in-out;
      animation-iteration-count: 1;
      transform-origin: center;
    }

    h1 {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
    }
    
    .header-container {
      position: sticky;
      top: 0;
      background-color: #34343C;
      padding: 8px 16px 24px 16px;
      z-index: 10;
    }
    
    .content-container {
      padding: 0 16px;
    }
    
    .badge {
      display: none; /* –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∫—Ä—ã—Ç, –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –æ—à–∏–±–æ–∫ */
      align-items: center;
      justify-content: center;
      background-color: #F02D2D;
      color: white;
      border-radius: 12px;
      min-width: 16px;
      height: 24px;
      padding: 0 8px;
      font-size: 12px;
      font-weight: 600;
      margin-left: 8px;
      position: relative;
      z-index: 5;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    button {
      background-color: #F86025;
      color: white;
      border: none;
      border-radius: 12px;
      padding: 8px 9px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-bottom: 16px;
      position: relative;
      overflow: hidden;
    }
    
    button:after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 5px;
      height: 5px;
      background: rgba(255, 255, 255, 0.5);
      opacity: 0;
      border-radius: 100%;
      transform: scale(1, 1) translate(-50%);
      transform-origin: 50% 50%;
    }
    
    button:focus:not(:active)::after {
      animation: ripple 1s ease-out;
    }
    
    @keyframes ripple {
      0% {
        transform: scale(0, 0);
        opacity: 0.5;
      }
      20% {
        transform: scale(25, 25);
        opacity: 0.3;
      }
      100% {
        opacity: 0;
        transform: scale(40, 40);
      }
    }

    .primary-button {
      width: 100%;
    }

    .secondary-button {
      background-color: #44444C;
      font-size: 12px;
      padding: 12px 8px;
      margin: 0 4px 0 0;
    }

    .fix-button {
      background-color: #505059;
      font-size: 12px;
      padding: 4px;
      margin-left: 8px;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }
    
    .fix-button svg {
      width: 24px;
      height: 24px;
    }
    
    .fix-button .tooltip {
      position: absolute;
      visibility: hidden;
      width: 150px;
      background-color: #222228;
      color: #FFFFFF;
      text-align: center;
      border-radius: 8px;
      padding: 4px 8px;
      font-size: 12px;
      z-index: 2000; /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º z-index –¥–æ 2000, –∫–∞–∫ –∏ —É –¥—Ä—É–≥–∏—Ö —Ç—É–ª—Ç–∏–ø–æ–≤ */
      bottom: 125%; /* –í—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç—É–ª—Ç–∏–ø –Ω–∞–¥ –∫–Ω–æ–ø–∫–æ–π */
      left: 50%;
      margin-left: -75px;
      opacity: 0;
      transition: opacity 0.3s;
      pointer-events: none;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      border: 1px solid #44444C;
    }
    
    .fix-button:hover .tooltip {
      visibility: visible;
      opacity: 1;
    }

    button:hover {
      background-color: #E55520;
      /* transform: translateY(-2px); */
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    button:active {
      background-color: #D24A1B;
      /* transform: translateY(0); */
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .secondary-button:hover {
      background-color: #55555C;
    }

    .fix-button:hover {
      background-color: #E55520;
      animation: pulse 0.5s ease;
    }

    .results-container {
      margin-top: 0px;
      margin-bottom: 16px;
    }


    .error-item {
      background-color: #44444C;
      border-radius: 12px;
      padding: 6px 12px;
      margin-bottom: 6px;
    }

    .component-name {
      font-weight: 600;
      margin-bottom: 8px;
      color: #F86025;
      cursor: pointer;
      text-decoration: underline;
      display: inline-block;
    }

    .component-name:hover {
      color: #E55520;
    }

    .parent-name {
      font-size: 12px;
      color: #AAAAAA;
      margin-bottom: 8px;
    }

    .error-list {
      list-style-type: none;
      padding-left: 0;
      margin: 0;
    }

    .error-list li {
      padding: 0;
      border-bottom: 1px solid #505059;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
    }

    .error-message {
      flex: 1;
      display: flex;
      align-items: center;
    }
    
    .tooltip-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background-color: #55555C;
      color: rgb(161, 161, 161);
      font-size: 10px;
      margin-left: 8px;
      cursor: help;
      position: relative;
    }
    
    .tooltip {
      position: absolute;
      visibility: hidden;
      width: 250px;
      background-color: #222228;
      color: #FFFFFF;
      text-align: left;
      border-radius: 12px;
      padding: 8px;
      font-size: 12px;
      line-height: 1.4;
      z-index: 2000; /* –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º z-index, —á—Ç–æ–±—ã tooltip –æ—Ç–æ–±—Ä–∞–∂–∞–ª—Å—è –ø–æ–≤–µ—Ä—Ö –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
      bottom: 125%; /* –í—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç—É–ª—Ç–∏–ø –Ω–∞–¥ —ç–ª–µ–º–µ–Ω—Ç–æ–º */
      left: 50%;
      margin-left: -125px;
      opacity: 0;
      transition: opacity 0.3s;
      pointer-events: none;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      border: 1px solid #44444C;
    }
    
    .tooltip-icon:hover .tooltip {
      visibility: visible;
      opacity: 1;
    }

    .error-list li:last-child {
      border-bottom: none;
    }

    .no-errors {
      text-align: center;
      padding: 24px;
      color: #AAAAAA;
    }

    .loading {
      text-align: center;
      padding: 12px;
      color: #FFFFFF;
    }
    
    .progress-container {
      margin: 16px 0;
    }
    
    .progress-bar {
      width: 100%;
      height: 8px;
      background-color: #44444C;
      border-radius: 4px;
      overflow: hidden;
    }
    
    .progress-fill {
      height: 100%;
      background-color: #F86025;
      width: 0%;
      transition: width 0.3s ease;
    }
    
    .progress-text {
      margin-top: 8px;
      font-size: 12px;
      color: #AAAAAA;
      text-align: center;
    }
    
    .error-message {
      background-color: #505059;
      color: #FFFFFF;
      padding: 6px 12px;
      border-radius: 8px;
      margin-bottom: 8px;
    }

    .success-message {
      background-color: #2D5F3D;
      color: #FFFFFF;
      padding: 12px;
      border-radius: 8px;
      text-align: center;
      margin-bottom: 16px;
    }

    .button-container {
      display: flex;
      margin-bottom: 0px;
      gap: 8px;
    }
    
    .check-button {
      flex-grow: 1;
    }

    .tertiary-button {
      width: 200px;
      height: 40px;
      padding: 0;
      display: block;
      justify-content: center;
      align-items: center;
      background-color: #44444C;
    }
    
    .settings-button {
      width: 80px;
      height: 40px;
      padding: 0;
      display: block;
      justify-content: center;
      align-items: center;
      background-color: #44444C;
    }
    
    .settings-icon {
      width: 20px;
      height: 20px;
      fill: white;
    }

    .settings-dropdown {
      background-color: #44444C;
      border-radius: 12px;
      padding: 12px;
      margin-bottom: 16px;
      display: none;
      transform-origin: top center;
      transition: all 0.3s ease-out;
      opacity: 0;
    }
    
    .settings-dropdown.show {
      opacity: 1;
      transform: scaleY(1);
    }

    .settings-item {
      display: flex;
      align-items: center;
      margin-bottom: 8px;
      position: relative;
    }
    
    .dependent-item {
      margin-left: 20px;
      position: relative;
    }
    
    .dependent-item::before {
      content: "‚îî";
      position: absolute;
      left: -15px;
      color: #666;
    }
    
    .settings-divider {
      height: 1px;
      background-color: #55555C;
      margin: 12px 0;
    }
    
    .all-checks-item {
      font-weight: 500;
    }
    
    /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —á–µ–∫–±–æ–∫—Å–æ–≤ */
    .settings-item input[type="checkbox"] {
      position: absolute;
      opacity: 0;
      cursor: pointer;
      height: 0;
      width: 0;
    }
    
    .settings-item label {
      position: relative;
      padding-left: 28px;
      cursor: pointer;
      display: inline-block;
      line-height: 20px;
    }
    
    .settings-item label:before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      width: 20px;
      height: 20px;
      border-radius: 8px;
      background-color: #b5b7c040;
      transition: background-color 0.2s ease;
    }
    
    .settings-item input[type="checkbox"]:checked + label:before {
      background-color: #ff9168;
    }
    
    .settings-item input[type="checkbox"]:checked + label:after {
      content: '';
      position: absolute;
      left: 4px;
      top: 4px;
      width: 12px;
      height: 12px;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' focusable='false' aria-hidden='true' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='white' d='m11.43 3.807-6.155 6.428-4.203-4.21 1.062-1.06L5.253 8.09l5.094-5.32z'%3E%3C/path%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: center;
    }

    .settings-item:last-child {
      margin-bottom: 0;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è Node ID Inspector */
    .node-id-section {
      background-color: #44444C;
      border-radius: 12px;
      padding: 12px;
      margin-bottom: 16px;
      display: none; /* –°–∫—Ä—ã—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —Ä–µ–∂–∏–º–µ node-id-inspector */
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è AI Design Lint */
    .ai-design-lint-section {
      display: none; /* –°–∫—Ä—ã—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —Ä–µ–∂–∏–º–µ ai-design-lint */
    }
    
    .ai-design-lint-mode .ai-design-lint-section {
      display: block;
      margin-bottom: 0;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è Design System Validator */
    .design-system-validator-section {
      display: none; /* –°–∫—Ä—ã—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —Ä–µ–∂–∏–º–µ design-system-validator */
    }
    
    .design-system-validator-mode .design-system-validator-section {
      display: block;
      margin-bottom: 0;
    }
    
    /* –ö–Ω–æ–ø–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ */
    .settings-button:hover svg path {
      stroke: #FFFFFF;
    }
    
    .settings-button:active {
      transform: scale(0.95);
    }
    
    /* –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥ */
    .back-button:hover svg path {
      stroke: #FFFFFF;
    }
    
    .back-button:active {
      transform: scale(0.95);
    }
    
    .ai-analysis-result {
      background-color: #44444C;
      border-radius: 12px;
      padding: 12px;
      margin-top: 16px;
      max-height: 400px;
      overflow-y: auto;
    }
    
    .ai-analysis-result h4 {
      font-size: 13px;
      font-weight: 600;
      margin: 0 0 12px 0;
      color: #F86025;
    }
    
    .ai-analysis-result p {
      font-size: 12px;
      line-height: 1.6;
      color: #FFFFFF;
      margin-bottom: 8px;
    }
    
    .ai-analysis-result ul {
      list-style-type: none;
      padding-left: 0;
      margin: 8px 0;
    }
    
    .ai-analysis-result li {
      font-size: 12px;
      line-height: 1.6;
      color: #FFFFFF;
      padding: 6px 0;
      border-bottom: 1px solid #505059;
    }
    
    .ai-analysis-result li:last-child {
      border-bottom: none;
    }
    
    .ai-analysis-result li::before {
      content: "‚Ä¢";
      color: #F86025;
      font-weight: bold;
      display: inline-block;
      width: 1em;
      margin-right: 8px;
    }
    
    .ai-loading {
      text-align: center;
      padding: 24px;
      color: #AAAAAA;
      font-size: 12px;
    }
    
    .ai-loading::after {
      content: "...";
      animation: dots 1.5s steps(4, end) infinite;
    }
    
    /* –ù–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞ */
    .analysis-score-panel {
      background: linear-gradient(135deg, #44444C 0%, #3A3A42 100%);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 16px;
      border: 1px solid #505059;
    }

    .score-display {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
    }

    .score-number {
      font-size: 32px;
      font-weight: 700;
      color: #F86025;
      line-height: 1;
    }

    .score-label {
      font-size: 12px;
      color: #AAAAAA;
      margin-top: 4px;
    }

    .score-breakdown {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-top: 12px;
    }

    .score-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 0;
      border-bottom: 1px solid #505059;
    }

    .score-item:last-child {
      border-bottom: none;
    }

    .score-item-label {
      font-size: 11px;
      color: #FFFFFF;
    }

    .score-item-value {
      font-size: 11px;
      font-weight: 600;
      color: #F86025;
    }

    .analysis-section {
      background-color: #44444C;
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 12px;
    }

    .analysis-section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .analysis-section-title {
      font-size: 13px;
      font-weight: 600;
      color: #FFFFFF;
    }

    .analysis-section-toggle {
      background: none;
      border: none;
      color: #AAAAAA;
      cursor: pointer;
      font-size: 12px;
      padding: 4px;
    }

    .analysis-section-content {
      font-size: 12px;
      color: #FFFFFF;
    }

    .hardcoded-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 6px 0;
      border-bottom: 1px solid #505059;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .hardcoded-item:hover {
      background-color: #505059;
    }

    .hardcoded-item:active {
      background-color: #F86025;
      color: white;
    }

    .hardcoded-item:last-child {
      border-bottom: none;
    }

    .hardcoded-info {
      flex: 1;
    }

    .hardcoded-type {
      font-size: 11px;
      color: #F86025;
      font-weight: 600;
    }

    .hardcoded-description {
      font-size: 11px;
      color: #AAAAAA;
      margin-top: 2px;
    }

    .hardcoded-value {
      font-size: 11px;
      color: #FFFFFF;
      font-family: 'SF Mono', 'Monaco', monospace;
    }

    .token-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px;
      border-bottom: 1px solid #505059;
      border-radius: 4px;
      transition: all 0.15s ease;
    }

    .token-item:last-child {
      border-bottom: none;
    }
    
    .token-item:hover {
      background-color: rgba(76, 175, 80, 0.1);
      transform: translateX(2px);
    }

    .token-info {
      flex: 1;
    }

    .token-name {
      font-size: 11px;
      color: #4CAF50;
      font-weight: 600;
    }

    .token-type {
      font-size: 11px;
      color: #AAAAAA;
      margin-top: 2px;
    }

    .recommendation-item {
      padding: 8px 0;
      border-bottom: 1px solid #505059;
    }

    .recommendation-item:last-child {
      border-bottom: none;
    }

    .recommendation-priority {
      display: inline-block;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 10px;
      font-weight: 600;
      margin-right: 8px;
    }

    .recommendation-priority.high {
      background-color: #F44336;
      color: white;
    }

    .recommendation-priority.medium {
      background-color: #FF9800;
      color: white;
    }

    .recommendation-priority.low {
      background-color: #4CAF50;
      color: white;
    }

    .recommendation-message {
      font-size: 12px;
      color: #FFFFFF;
      margin-top: 4px;
    }

    .token-suggestion-item {
      padding: 8px;
      border-bottom: 1px solid #505059;
      border-radius: 4px;
      transition: all 0.15s ease;
    }

    .token-suggestion-item:last-child {
      border-bottom: none;
    }
    
    .token-suggestion-item:hover {
      background-color: rgba(248, 96, 37, 0.1);
      transform: translateX(2px);
    }

    .suggestion-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 4px;
    }

    .suggestion-hardcoded {
      font-size: 11px;
      color: #F86025;
      font-weight: 600;
    }

    .suggestion-confidence {
      font-size: 10px;
      color: #4CAF50;
      background: #2A2A32;
      padding: 2px 6px;
      border-radius: 4px;
    }

    .suggestion-token {
      font-size: 11px;
      color: #4CAF50;
      font-weight: 600;
      margin: 4px 0;
    }

    .suggestion-reason {
      font-size: 10px;
      color: #AAAAAA;
      font-style: italic;
    }
    
    @keyframes dots {
      0%, 20% { content: "."; }
      40% { content: ".."; }
      60%, 100% { content: "..."; }
    }
    
    /* –°—Ç–∏–ª–∏ –¥–ª—è —Ä–µ–∂–∏–º–∞ Node ID Inspector */
    .node-id-mode .node-id-section {
      display: block;
      margin-bottom: 0;
    }
    
    .node-id-mode .node-id-section h3 {
      margin-top: 0;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è SVG Export */
    .svg-export-section {
      /* background-color: #44444C;
      border-radius: 12px;
      padding: 12px;
      margin-bottom: 16px; */
      display: none; /* –°–∫—Ä—ã—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —Ä–µ–∂–∏–º–µ svg-export */
    }
    
    /* –°—Ç–∏–ª–∏ –¥–ª—è —Ä–µ–∂–∏–º–∞ SVG Export */
    .svg-export-mode .svg-export-section {
      display: block;
      margin-bottom: 0;
    }
    
    .svg-export-mode .svg-export-section h3 {
      margin-top: 0;
    }

    .export-stats {
      background-color: #44444C;
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 16px;
    }

    .stats-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      font-size: 14px;
    }

    .stats-item:last-child {
      margin-bottom: 0;
    }

    .stats-label {
      color: #fff;
    }

    .stats-value {
      color: #fff;
      font-weight: 600;
    }

    .export-info {
      background-color: #44444C;
      border-radius: 8px;
      padding: 8px;
      margin-top: 8px;
    }

    .export-info code {
      font-family: 'SF Mono', 'Monaco', 'Cascadia Code', 'Roboto Mono', monospace;
      font-size: 11px;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ü–≤–µ—Ç–∞ fill */
    .color-options {
      background-color: #44444C;
      border-radius: 8px;
      padding: 12px 12px 6px 12px;
    }

    .color-preset-buttons {
      display: flex;
      gap: 8px;
      margin-top: 8px;
    }

    .color-preset-btn {
      flex: 1;
      padding: 6px 8px;
      border: none;
      border-radius: 6px;
      font-size: 11px;
      font-weight: 500;
      cursor: pointer;
      /* transition: all 0.2s ease; */
    }

    .color-preset-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    .color-preset-btn.active {
      box-shadow: 0 0 0 2px #F86025;
    }

    .custom-color-input input[type="text"] {
      font-family: 'SF Mono', 'Monaco', 'Cascadia Code', 'Roboto Mono', monospace;
    }

    .custom-color-input input[type="text"]:focus {
      outline: none;
      border-color: #F86025;
      box-shadow: 0 0 0 1px rgba(248, 96, 37, 0.3);
    }

    .custom-color-input input[type="text"].has-color {
      border-left: 3px solid var(--selected-color, #F86025);
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–±–∞—Ä–∞ SVG —ç–∫—Å–ø–æ—Ä—Ç–∞ */
    .svg-export-progress {
      background-color: #2A2A32;
      border-radius: 8px;
      padding: 16px;
      margin-top: 12px;
    }

    .export-progress-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .export-progress-header span {
      font-size: 13px;
      font-weight: 500;
    }

    .export-counter {
      color: #F86025 !important;
      font-weight: 600;
      font-family: 'SF Mono', 'Monaco', 'Cascadia Code', 'Roboto Mono', monospace;
    }

    .export-progress-bar {
      background-color: #505059;
      border-radius: 6px;
      height: 8px;
      overflow: hidden;
      margin-bottom: 12px;
    }

    .export-progress-fill {
      background: linear-gradient(90deg, #F86025, #FF8B4A);
      height: 100%;
      width: 0%;
      transition: width 0.3s ease;
      border-radius: 6px;
    }

    .export-progress-details {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 11px;
    }

    .export-percentage {
      color: #F86025;
      font-weight: 600;
      font-family: 'SF Mono', 'Monaco', 'Cascadia Code', 'Roboto Mono', monospace;
    }

    .export-current-icon {
      color: #AAAAAA;
      font-style: italic;
      text-overflow: ellipsis;
      overflow: hidden;
      white-space: nowrap;
      max-width: 200px;
    }

    .node-ids-textarea {
      width: 100%;
      min-height: 80px;
      background-color: #2A2A32;
      border: 1px solid #505059;
      border-radius: 8px;
      padding: 8px;
      color: #FFFFFF;
      font-family: 'SF Mono', 'Monaco', 'Cascadia Code', 'Roboto Mono', monospace;
      font-size: 11px;
      line-height: 1.4;
      resize: vertical;
      box-sizing: border-box;
    }

    .node-ids-textarea:focus {
      outline: none;
      border-color: #F86025;
      box-shadow: 0 0 0 2px rgba(248, 96, 37, 0.2);
    }

    .node-ids-textarea::placeholder {
      color: #AAAAAA;
    }

    .current-node-id {
      word-break: break-all;
      font-family: 'SF Mono', 'Monaco', 'Cascadia Code', 'Roboto Mono', monospace;
    }

    .comparison-result {
      background-color: #2A2A32;
      border-radius: 8px;
      padding: 8px;
      margin-top: 8px;
      font-size: 12px;
      line-height: 1.4;
    }

    .comparison-result.match {
      background-color: #2D5F3D;
      color: #FFFFFF;
    }

    .comparison-result.no-match {
      background-color: #5F2D2D;
      color: #FFFFFF;
    }

    .comparison-result.info {
      background-color: #505059;
      color: #FFFFFF;
    }

  </style>
</head>
<body style="background-color: #34343C;">
  <div class="header-container">
    <div style="display: flex; align-items: center;">
      <h1>
        Orbita DS&nbsp;&nbsp;‚ú¶&nbsp;&nbsp;Tools
      </h1>
      <span id="error-badge" class="badge">0</span>
    </div>
    
    <div class="button-container">
      <button id="check-button" class="primary-button check-button">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
      <button id="create-cell-button" class="tertiary-button" title="–°–æ–∑–¥–∞—Ç—å Cell —Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º">–°–æ–∑–¥–∞—Ç—å Cell</button>
      <button id="settings-button" class="settings-button" title="–ß—Ç–æ –±—É–¥–µ–º –ø—Ä–æ–≤–µ—Ä—è—Ç—å">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M5.75195 8.00196C5.90055 8.00417 6.04242 8.00868 6.17285 8.01758C6.45841 8.03707 6.79738 8.0831 7.14844 8.22852C7.88321 8.53299 8.46701 9.11679 8.77148 9.85157C8.9169 10.2026 8.96294 10.5416 8.98242 10.8272C8.99136 10.9582 8.99584 11.1007 8.99805 11.25H16V12.75H8.99805C8.99584 12.8993 8.99136 13.0419 8.98242 13.1729C8.96294 13.4584 8.9169 13.7974 8.77148 14.1484C8.46701 14.8832 7.88321 15.467 7.14844 15.7715C6.79738 15.9169 6.45841 15.9629 6.17285 15.9824C5.91182 16.0002 5.60499 16 5.29004 16H4.70996C4.39501 16 4.08818 16.0002 3.82715 15.9824C3.54159 15.9629 3.20263 15.9169 2.85156 15.7715C2.11679 15.467 1.53299 14.8832 1.22852 14.1484C1.0831 13.7974 1.03706 13.4584 1.01758 13.1729L1.00195 12.75H0V11.25H1.00195C1.00416 11.1007 1.00864 10.9582 1.01758 10.8272C1.03706 10.5416 1.0831 10.2026 1.22852 9.85157C1.53299 9.11679 2.11679 8.53299 2.85156 8.22852C3.20263 8.0831 3.54159 8.03707 3.82715 8.01758C4.08818 7.99977 4.39501 7.99997 4.70996 8H5.29004L5.75195 8.00196ZM4.75 9.5C4.13845 9.5 3.79431 9.49968 3.5332 9.57618C3.49591 9.5871 3.46023 9.59999 3.42578 9.61426C3.10427 9.74749 2.84061 9.98786 2.67773 10.292C2.65452 10.3354 2.63325 10.38 2.61426 10.4258C2.53126 10.6262 2.50814 10.8657 2.50195 11.25C2.49963 11.394 2.5 11.5588 2.5 11.749V12.251C2.5 12.4412 2.49963 12.606 2.50195 12.75C2.50814 13.1343 2.53126 13.3738 2.61426 13.5742C2.76649 13.9416 3.05839 14.2335 3.42578 14.3857C3.46023 14.4 3.49592 14.4129 3.5332 14.4238C3.79431 14.5003 4.13845 14.5 4.75 14.5H5.25C5.94891 14.5 6.29856 14.4999 6.57422 14.3857C6.9416 14.2335 7.23351 13.9416 7.38574 13.5742C7.46874 13.3738 7.49186 13.1343 7.49805 12.75C7.50037 12.6057 7.5 12.4409 7.5 12.25V11.75C7.5 11.5592 7.50037 11.3943 7.49805 11.25C7.49263 10.9138 7.47409 10.6882 7.41406 10.5029C7.40551 10.4765 7.39608 10.4508 7.38574 10.4258C7.25252 10.1043 7.01214 9.84061 6.70801 9.67774C6.66465 9.65452 6.62005 9.63325 6.57422 9.61426C6.38037 9.53397 6.14982 9.51001 5.78711 9.50293L5.37695 9.5H4.75ZM11.752 0.00195683C11.9005 0.00417449 12.0424 0.00868269 12.1729 0.0175818C12.4584 0.0370653 12.7974 0.0831038 13.1484 0.228519C13.8832 0.532991 14.467 1.11679 14.7715 1.85157C14.9169 2.20263 14.9629 2.5416 14.9824 2.82715C14.9914 2.95815 14.9958 3.1007 14.998 3.25H16V4.75H14.998C14.9958 4.89931 14.9914 5.04185 14.9824 5.17286C14.9629 5.45841 14.9169 5.79738 14.7715 6.14844C14.467 6.88322 13.8832 7.46702 13.1484 7.77149C12.7974 7.9169 12.4584 7.96294 12.1729 7.98243C11.9118 8.00024 11.605 8.00004 11.29 8H10.71C10.395 8.00004 10.0882 8.00024 9.82715 7.98243C9.54159 7.96294 9.20262 7.9169 8.85156 7.77149C8.11679 7.46701 7.53299 6.88322 7.22852 6.14844C7.0831 5.79738 7.03706 5.45841 7.01758 5.17286L7.00195 4.75H0V3.25H7.00195C7.00416 3.1007 7.00864 2.95815 7.01758 2.82715C7.03706 2.54159 7.0831 2.20263 7.22852 1.85157C7.53299 1.11679 8.11679 0.532993 8.85156 0.228519C9.20262 0.0831048 9.54159 0.0370655 9.82715 0.0175818C10.0882 -0.000228366 10.395 -2.76315e-05 10.71 3.70663e-06H11.29L11.752 0.00195683ZM10.75 1.5C10.0511 1.5 9.70144 1.50008 9.42578 1.61426C9.0584 1.7665 8.76649 2.0584 8.61426 2.42578C8.53126 2.62617 8.50814 2.86574 8.50195 3.25C8.49963 3.39435 8.5 3.55915 8.5 3.75V4.25C8.5 4.44085 8.49963 4.60566 8.50195 4.75C8.50737 5.08624 8.52591 5.31176 8.58594 5.49707C8.59449 5.52346 8.60391 5.54925 8.61426 5.57422C8.74748 5.89574 8.98785 6.15939 9.29199 6.32227C9.33535 6.34548 9.37995 6.36675 9.42578 6.38575C9.68421 6.49279 10.0078 6.49959 10.623 6.5H11.25C11.8615 6.5 12.2057 6.50032 12.4668 6.42383C12.5041 6.41291 12.5398 6.40001 12.5742 6.38575C12.8957 6.25252 13.1594 6.01215 13.3223 5.70801C13.3455 5.66465 13.3668 5.62005 13.3857 5.57422C13.4687 5.37384 13.4919 5.13427 13.498 4.75C13.5004 4.60601 13.5 4.44123 13.5 4.25098V3.74903C13.5 3.55877 13.5004 3.394 13.498 3.25C13.4919 2.86574 13.4687 2.62617 13.3857 2.42578C13.2335 2.0584 12.9416 1.7665 12.5742 1.61426C12.5398 1.59999 12.5041 1.5871 12.4668 1.57618C12.2709 1.51879 12.0283 1.50456 11.6611 1.50098L11.25 1.5H10.75Z" fill="white"/>
        </svg>
      </button>
    </div>

    <!-- Node ID Inspector Section -->
    <div id="node-id-section" class="node-id-section">
      <h3 style="font-size: 14px; font-weight: 600; margin: 16px 0 8px 0; color: #F86025;">Node ID Inspector</h3>
      <div class="node-id-buttons">
        <button id="get-node-id-button" class="secondary-button" style="width: 100%; margin-bottom: 8px;">–ü–æ–ª—É—á–∏—Ç—å ID –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–≥–æ</button>
        <button id="compare-ids-button" class="secondary-button" style="width: 100%; margin-bottom: 8px;">–°—Ä–∞–≤–Ω–∏—Ç—å ID</button>
      </div>
      <div id="current-node-id" class="current-node-id" style="font-size: 12px; color: #AAAAAA; margin-bottom: 8px;">ID: –Ω–µ –≤—ã–±—Ä–∞–Ω</div>
      <textarea id="node-ids-textarea" class="node-ids-textarea" placeholder="–ó–¥–µ—Å—å –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è ID –≤—ã–¥–µ–ª–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤...&#10;–ö–∞–∂–¥—ã–π ID –Ω–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–µ" rows="4"></textarea>
      <div id="comparison-result" class="comparison-result" style="display: none;"></div>
    </div>

    <!-- AI Design Lint Section -->
    <div id="ai-design-lint-section" class="ai-design-lint-section">
      
      <!-- –û—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω -->
      <div id="ai-main-screen">
        

        
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –∫–Ω–æ–ø–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->

        <div style="font-size: 12px; color: #AAAAAA; margin-bottom: 16px; line-height: 1.5;">
          –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞—É–¥–∏—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é AI: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤, –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏, –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ –∫–æ–¥—É
        </div>
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
          <button id="ai-settings-button" class="settings-button" style="background: transparent; border: none; cursor: pointer; padding: 4px; display: flex; align-items: center; justify-content: center;">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M10 12.5C11.3807 12.5 12.5 11.3807 12.5 10C12.5 8.61929 11.3807 7.5 10 7.5C8.61929 7.5 7.5 8.61929 7.5 10C7.5 11.3807 8.61929 12.5 10 12.5Z" stroke="#AAAAAA" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M16.1667 12.5C16.0551 12.7513 16.0223 13.0301 16.0722 13.3006C16.122 13.5711 16.2521 13.8203 16.4458 14.0167L16.4917 14.0625C16.6466 14.2172 16.7694 14.4013 16.8533 14.6041C16.9372 14.8069 16.9806 15.0244 16.9806 15.2438C16.9806 15.4631 16.9372 15.6806 16.8533 15.8834C16.7694 16.0862 16.6466 16.2703 16.4917 16.425C16.337 16.5799 16.1528 16.7027 15.95 16.7866C15.7473 16.8705 15.5297 16.9139 15.3104 16.9139C15.0911 16.9139 14.8735 16.8705 14.6708 16.7866C14.468 16.7027 14.2838 16.5799 14.1292 16.425L14.0833 16.3792C13.887 16.1854 13.6378 16.0553 13.3673 16.0055C13.0968 15.9556 12.818 15.9884 12.5667 16.1C12.3203 16.2059 12.1103 16.3828 11.9631 16.6088C11.816 16.8348 11.738 17.0998 11.7375 17.3708V17.5C11.7375 17.942 11.5619 18.366 11.2494 18.6785C10.9368 18.9911 10.5128 19.1667 10.0708 19.1667C9.62886 19.1667 9.20484 18.9911 8.8923 18.6785C8.57976 18.366 8.40417 17.942 8.40417 17.5V17.4292C8.39771 17.1477 8.30996 16.8744 8.15178 16.6429C7.99359 16.4114 7.77203 16.2317 7.5125 16.125C7.26122 16.0134 6.98244 15.9806 6.71191 16.0305C6.44138 16.0803 6.19218 16.2104 5.99583 16.4042L5.95 16.45C5.79535 16.6049 5.61121 16.7277 5.40844 16.8116C5.20567 16.8955 4.98813 16.9389 4.76875 16.9389C4.54937 16.9389 4.33183 16.8955 4.12906 16.8116C3.92629 16.7277 3.74215 16.6049 3.5875 16.45C3.43261 16.2953 3.30983 16.1112 3.22593 15.9084C3.14203 15.7056 3.09861 15.4881 3.09861 15.2688C3.09861 15.0494 3.14203 14.8319 3.22593 14.6291C3.30983 14.4263 3.43261 14.2422 3.5875 14.0875L3.63333 14.0417C3.82713 13.8453 3.95723 13.5961 4.00707 13.3256C4.0569 13.0551 4.02413 12.7763 3.91833 12.525C3.81245 12.2786 3.63552 12.0686 3.40953 11.9215C3.18354 11.7743 2.91856 11.6963 2.6475 11.6958H2.5C2.05797 11.6958 1.63405 11.5202 1.32149 11.2077C1.00893 10.8951 0.833332 10.4711 0.833332 10.0292C0.833332 9.58721 1.00893 9.16319 1.32149 8.85065C1.63405 8.53811 2.05797 8.36252 2.5 8.36252H2.57083C2.85235 8.35606 3.12563 8.26831 3.35713 8.11012C3.58863 7.95194 3.76831 7.73038 3.875 7.47085C3.98663 7.21957 4.0194 6.94079 3.96957 6.67026C3.91974 6.39973 3.78964 6.15053 3.59583 5.95418L3.55 5.90835C3.39511 5.7537 3.27233 5.56956 3.18843 5.36679C3.10453 5.16402 3.06111 4.94648 3.06111 4.7271C3.06111 4.50772 3.10453 4.29018 3.18843 4.08741C3.27233 3.88464 3.39511 3.7005 3.55 3.54585C3.70465 3.39096 3.88879 3.26818 4.09156 3.18428C4.29433 3.10038 4.51187 3.05696 4.73125 3.05696C4.95063 3.05696 5.16817 3.10038 5.37094 3.18428C5.57371 3.26818 5.75785 3.39096 5.9125 3.54585L5.95833 3.59168C6.15468 3.78548 6.40388 3.91558 6.67441 3.96542C6.94494 4.01525 7.22372 3.98248 7.475 3.87668H7.5C7.74638 3.7708 7.95641 3.59387 8.10356 3.36788C8.25071 3.14189 8.32871 2.87691 8.32917 2.60585V2.50002C8.32917 2.05799 8.50476 1.63407 8.8173 1.32151C9.12984 1.00895 9.55377 0.833353 9.99583 0.833353C10.4379 0.833353 10.8618 1.00895 11.1744 1.32151C11.4869 1.63407 11.6625 2.05799 11.6625 2.50002V2.57085C11.663 2.84191 11.741 3.10689 11.8881 3.33288C12.0353 3.55887 12.2453 3.7358 12.4917 3.84168C12.7429 3.95331 13.0217 3.98608 13.2923 3.93625C13.5628 3.88642 13.812 3.75632 14.0083 3.56252L14.0542 3.51668C14.2088 3.3618 14.393 3.23902 14.5958 3.15512C14.7985 3.07121 15.0161 3.02779 15.2354 3.02779C15.4548 3.02779 15.6724 3.07121 15.8751 3.15512C16.0779 3.23902 16.262 3.3618 16.4167 3.51668C16.5716 3.67133 16.6943 3.85547 16.7782 4.05824C16.8621 4.26101 16.9056 4.47855 16.9056 4.69793C16.9056 4.91731 16.8621 5.13485 16.7782 5.33762C16.6943 5.54039 16.5716 5.72453 16.4167 5.87918L16.3708 5.92502C16.177 6.12137 16.0469 6.37057 15.9971 6.6411C15.9473 6.91163 15.98 7.19041 16.0858 7.44168V7.50002C16.1917 7.7464 16.3686 7.95643 16.5946 8.10358C16.8206 8.25073 17.0856 8.32873 17.3567 8.32918H17.5C17.942 8.32918 18.366 8.50478 18.6786 8.81732C18.9911 9.12986 19.1667 9.55378 19.1667 9.99585C19.1667 10.4379 18.9911 10.8618 18.6786 11.1744C18.366 11.4869 17.942 11.6625 17.5 11.6625H17.4292C17.1581 11.663 16.8931 11.741 16.6671 11.8881C16.4411 12.0353 16.2642 12.2453 16.1583 12.4917V12.5Z" stroke="#AAAAAA" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>

       


        <!-- –ö–Ω–æ–ø–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ -->
        <button id="analyze-design-button" class="primary-button" style="width: 100%; margin-bottom: 16px;">–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∏–∑–∞–π–Ω</button>

        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ -->
        <div id="ai-analysis-result" class="ai-analysis-result" style="display: none;"></div>

        <!-- –ù–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ -->
        <div id="component-analysis-panel" style="display: none;">
          <!-- –ü–∞–Ω–µ–ª—å –æ—Ü–µ–Ω–∫–∏ -->
          <div id="score-panel" class="analysis-score-panel">
            <div class="score-display">
              <div>
                <div id="score-number" class="score-number">0</div>
                <div class="score-label">Component Score</div>
              </div>
              <div class="score-breakdown">
                <div class="score-item">
                  <span class="score-item-label">Layers</span>
                  <span id="layers-count" class="score-item-value">0</span>
                </div>
                <div class="score-item">
                  <span class="score-item-label">Tokens</span>
                  <span id="tokens-count" class="score-item-value">0</span>
                </div>
                <div class="score-item">
                  <span class="score-item-label">Hardcoded</span>
                  <span id="hardcoded-count" class="score-item-value">0</span>
                </div>
                <div class="score-item">
                  <span class="score-item-label">Issues</span>
                  <span id="issues-count" class="score-item-value">0</span>
                </div>
              </div>
            </div>
          </div>

          <!-- –°–µ–∫—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤ -->
          <div id="tokens-section" class="analysis-section">
            <div class="analysis-section-header">
              <div class="analysis-section-title">Token Usage</div>
              <button class="analysis-section-toggle" onclick="toggleSection('tokens-content')">‚ñº</button>
            </div>
            <div id="tokens-content" class="analysis-section-content" style="display: block;">
              <div id="tokens-list"></div>
            </div>
          </div>

          <!-- –°–µ–∫—Ü–∏—è hardcoded –∑–Ω–∞—á–µ–Ω–∏–π -->
          <div id="hardcoded-section" class="analysis-section">
            <div class="analysis-section-header">
              <div class="analysis-section-title">Hard-coded Values</div>
              <button class="analysis-section-toggle" onclick="toggleSection('hardcoded-content')">‚ñº</button>
            </div>
            <div id="hardcoded-content" class="analysis-section-content" style="display: block;">
              <div id="hardcoded-list"></div>
            </div>
          </div>

          <!-- –°–µ–∫—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π -->
          <div id="recommendations-section" class="analysis-section">
            <div class="analysis-section-header">
              <div class="analysis-section-title">Recommendations</div>
              <button class="analysis-section-toggle" onclick="toggleSection('recommendations-content')">‚ñº</button>
            </div>
            <div id="recommendations-content" class="analysis-section-content" style="display: block;">
              <div id="recommendations-list"></div>
            </div>
          </div>

          <!-- –°–µ–∫—Ü–∏—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π —Ç–æ–∫–µ–Ω–æ–≤ -->
          <div id="token-suggestions-section" class="analysis-section">
            <div class="analysis-section-header">
              <div class="analysis-section-title">üí° Token Suggestions</div>
              <button class="analysis-section-toggle" onclick="toggleSection('token-suggestions-content')">‚ñº</button>
            </div>
            <div id="token-suggestions-content" class="analysis-section-content" style="display: block;">
              <div id="token-suggestions-list"></div>
            </div>
          </div>

          <!-- –ö–Ω–æ–ø–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞ -->
          <div style="display: flex; gap: 8px; margin-top: 16px;">
            <button id="export-json-button" class="secondary-button" style="flex: 1;">
              üìÑ Export JSON
            </button>
            <button id="export-markdown-button" class="secondary-button" style="flex: 1;">
              üìù Export Markdown
            </button>
          </div>

          <!-- AI Chat Panel -->
          <div id="ai-chat-panel" class="analysis-section" style="margin-top: 16px;">
            <div class="analysis-section-header">
              <div class="analysis-section-title">üí¨ AI Assistant</div>
              <button class="analysis-section-toggle" onclick="toggleSection('ai-chat-content')">‚ñº</button>
            </div>
            <div id="ai-chat-content" class="analysis-section-content" style="display: block;">
              <!-- –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞ -->
              <div id="ai-chat-history" style="max-height: 150px; overflow-y: auto; margin-bottom: 8px; padding: 6px; background: #2A2A32; border-radius: 6px; border: 1px solid #505059;">
                <div style="color: #AAAAAA; font-size: 11px; text-align: center; padding: 12px;">
                  –ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
                </div>
              </div>
              
              <!-- –ü–æ–ª–µ –≤–≤–æ–¥–∞ -->
              <div style="display: flex; flex-direction: column; gap: 8px;">
                <textarea id="ai-chat-input" placeholder="–ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É —Å –æ—Ç—Å—Ç—É–ø–∞–º–∏?" style="width: 100%; min-height: 60px; max-height: 120px; background: #2A2A32; border: 1px solid #505059; border-radius: 6px; padding: 8px; color: white; font-size: 12px; resize: vertical; font-family: inherit; line-height: 1.4;"></textarea>
                <button id="ai-chat-send-button" class="primary-button" style="width: 100%; padding: 10px; font-size: 12px;">
                  üí¨ –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å AI
                </button>
              </div>
              
              <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–∫–µ–Ω–∞—Ö -->
              <div id="ai-chat-tokens-info" style="font-size: 9px; color: #AAAAAA; text-align: center; margin-top: 4px; display: none;">
                <span id="ai-chat-tokens-count">0</span> —Å–æ–æ–±—â–µ–Ω–∏–π
              </div>
            </div>
          </div>
        </div>

        <!-- –î–∏–∞–ª–æ–≥–æ–≤—ã–π —Ä–µ–∂–∏–º -->
        <div id="ai-chat-section" style="display: none; margin-top: 16px;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
            <label style="font-size: 12px; color: #FFFFFF; font-weight: 600;">–ó–∞–¥–∞—Ç—å —É—Ç–æ—á–Ω—è—é—â–∏–π –≤–æ–ø—Ä–æ—Å:</label>
            <button id="ai-clear-history-button" class="secondary-button" style="padding: 4px 8px; font-size: 11px;">
              üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é
            </button>
          </div>
          
          <div style="display: flex; gap: 8px; margin-bottom: 8px;">
            <textarea id="ai-follow-up-input" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É —Å –æ—Ç—Å—Ç—É–ø–∞–º–∏? –ö–∞–∫–æ–π —Ç–æ–∫–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Ü–≤–µ—Ç–∞?" style="flex: 1; min-height: 44px; background: #2A2A32; border: 1px solid #505059; border-radius: 8px; padding: 8px; color: white; font-size: 12px; resize: vertical;"></textarea>
          </div>
          
          <button id="ai-ask-question-button" class="secondary-button" style="width: 100%; margin-bottom: 8px;">
            üí¨ –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å
          </button>
          
          <div id="ai-chat-tokens-info" style="font-size: 10px; color: #AAAAAA; text-align: center; display: none;">
            –ò—Å—Ç–æ—Ä–∏—è: <span id="ai-tokens-count">0</span> —Å–æ–æ–±—â–µ–Ω–∏–π
          </div>
        </div>
      </div>

      <!-- –≠–∫—Ä–∞–Ω –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
      <div id="ai-settings-screen" style="display: none;">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
        <div style="display: flex; align-items: center; margin-bottom: 16px;">
          <button id="ai-settings-back-button" class="back-button" style="background: transparent; border: none; cursor: pointer; padding: 4px; margin-right: 8px; display: flex; align-items: center;">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M12.5 15L7.5 10L12.5 5" stroke="#AAAAAA" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
          <h3 style="font-size: 14px; font-weight: 600; margin: 0; color: #F86025;">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ AI Design Lint</h3>
        </div>

        <!-- –ë–ª–æ–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ -->
        <div style="background: #2A2A32; border-radius: 8px; padding: 12px; margin-bottom: 16px; font-size: 11px; line-height: 1.5; color: #AAAAAA;">
          <div style="font-weight: 600; color: #FFFFFF; margin-bottom: 8px;">üîç –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è:</div>
        ‚Ä¢ Hard-coded –∑–Ω–∞—á–µ–Ω–∏—è vs —Ç–æ–∫–µ–Ω—ã<br>
        ‚Ä¢ –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –æ—Ç—Å—Ç—É–ø–æ–≤ (7px –≤–º–µ—Å—Ç–æ 8px)<br>
        ‚Ä¢ –ö–æ–Ω—Ç—Ä–∞—Å—Ç —Ü–≤–µ—Ç–æ–≤ (WCAG)<br>
        ‚Ä¢ Touch targets (44x44px –º–∏–Ω–∏–º—É–º)<br>
        ‚Ä¢ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞<br>
        ‚Ä¢ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∫–æ–¥—É (0-100%)
      </div>
      
        <!-- –¢–æ–∫–µ–Ω -->
      <div class="ai-token-input" style="margin-bottom: 16px;">
        <label for="yandex-token" style="font-size: 12px; color: #FFFFFF; display: block; margin-bottom: 8px;">Yandex OAuth Token:</label>
        <input type="password" id="yandex-token" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à OAuth —Ç–æ–∫–µ–Ω" style="width: 100%; background: #2A2A32; border: 1px solid #505059; border-radius: 8px; padding: 8px; color: white; font-size: 12px; font-family: 'SF Mono', 'Monaco', monospace;">
          <div style="font-size: 11px; color: #AAAAAA; margin-top: 4px;">
            –¢–æ–∫–µ–Ω –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ. <a href="https://oauth.yandex.ru/authorize?response_type=token&client_id=YOUR_CLIENT_ID" target="_blank" style="color: #F86025; text-decoration: none;">–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω</a>
          </div>
      </div>

        <!-- JSON –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º—ã -->
        <div style="margin-bottom: 16px;">
          <label style="font-size: 12px; color: #FFFFFF; display: block; margin-bottom: 8px;">JSON –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label>
          
          <!-- –ö–Ω–æ–ø–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ -->
          <div style="display: flex; gap: 8px; margin-bottom: 8px;">
            <button id="ai-load-json-button" class="secondary-button" style="flex: 1;">
              üìÅ –ó–∞–≥—Ä—É–∑–∏—Ç—å JSON
            </button>
            <button id="ai-clear-json-button" class="secondary-button" style="flex: 1;" disabled>
              üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å
            </button>
      </div>
          <input type="file" id="ai-json-file-input" accept=".json" style="display: none;">
          
          <!-- –°—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ JSON -->
          <div id="ai-json-status" style="font-size: 11px; color: #AAAAAA; padding: 8px; background: #2A2A32; border-radius: 6px; display: none;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <span id="ai-json-status-text">–§–∞–π–ª –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω</span>
              <button id="ai-view-json-button" style="background: transparent; border: none; color: #F86025; cursor: pointer; font-size: 11px; padding: 0;">–ü—Ä–æ—Å–º–æ—Ç—Ä</button>
            </div>
          </div>
          
          <div style="font-size: 11px; color: #AAAAAA; margin-top: 4px;">
            –ó–∞–≥—Ä—É–∑–∏—Ç–µ JSON —Å —Ç–æ–∫–µ–Ω–∞–º–∏, –ø—Ä–∞–≤–∏–ª–∞–º–∏ –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ –≤–∞—à–µ–π –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º—ã –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
          </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ JSON -->
        <div id="ai-json-modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); z-index: 1000; padding: 20px;">
          <div style="background: #2A2A32; border-radius: 12px; max-width: 500px; margin: 0 auto; max-height: 80vh; overflow: hidden; display: flex; flex-direction: column;">
            <div style="padding: 16px; border-bottom: 1px solid #505059; display: flex; justify-content: space-between; align-items: center;">
              <h4 style="margin: 0; color: #FFFFFF; font-size: 14px;">–ü—Ä–æ—Å–º–æ—Ç—Ä JSON –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º—ã</h4>
              <button id="ai-close-json-modal" style="background: transparent; border: none; color: #AAAAAA; cursor: pointer; font-size: 20px; padding: 0; line-height: 1;">&times;</button>
            </div>
            <div style="padding: 16px; overflow-y: auto; flex: 1;">
              <pre id="ai-json-preview" style="margin: 0; color: #FFFFFF; font-size: 11px; font-family: 'SF Mono', Monaco, monospace; white-space: pre-wrap; word-wrap: break-word;"></pre>
            </div>
          </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è -->
        <button id="ai-save-settings-button" class="secondary-button" style="width: 100%;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
      </div>

    </div>

    <!-- Design System Validator Section -->
    <div id="design-system-validator-section" class="design-system-validator-section">
      
      <!-- –ì–ª–∞–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ -->
      <div style="display: flex; gap: 8px; margin-bottom: 16px;">
        <button id="dsv-settings-button" class="secondary-button" style="flex: 1; padding: 10px 16px; font-size: 13px;">
          ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏
        </button>
        <button id="dsv-validate-button-main" class="primary-button" style="flex: 2; padding: 10px 16px; font-size: 13px;">
          üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
        </button>
      </div>

      <!-- –°—Ç–∞—Ç—É—Å —Ç–æ–∫–µ–Ω–æ–≤ (–≤—Å–µ–≥–¥–∞ –≤–∏–¥–µ–Ω) -->
      <div id="dsv-tokens-status-main" style="font-size: 10px; color: #AAAAAA; margin-bottom: 16px; display: none; background: #2A2A32; padding: 8px 12px; border-radius: 6px;">
        <span id="dsv-tokens-status-main-text">–¢–æ–∫–µ–Ω—ã –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã</span>
      </div>

      <!-- –ü–∞–Ω–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–∫ (—Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
      <div id="dsv-settings-panel" style="display: none; margin-bottom: 16px;">
      
      <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º -->
      <div style="font-size: 12px; color: #AAAAAA; margin-bottom: 16px; line-height: 1.5;">
        –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Figma Variables (–¥–∏–∑–∞–π–Ω-—Ç–æ–∫–µ–Ω–æ–≤) –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
      </div>

      <!-- –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ -->
      <div style="margin-bottom: 16px;">
        <label style="font-size: 12px; color: #FFFFFF; display: block; margin-bottom: 8px; font-weight: 600;">–†–µ–∂–∏–º –ø—Ä–æ–≤–µ—Ä–∫–∏:</label>
        <div style="display: flex; gap: 8px;">
          <button id="dsv-mode-local" class="dsv-mode-button" data-mode="local" style="flex: 1; padding: 8px 12px; background: #F86025; border: none; border-radius: 8px; color: white; cursor: pointer; font-size: 12px; transition: all 0.2s;">Local</button>
          <button id="dsv-mode-remote" class="dsv-mode-button" data-mode="remote" style="flex: 1; padding: 8px 12px; background: #2A2A32; border: 1px solid #505059; border-radius: 8px; color: white; cursor: pointer; font-size: 12px; transition: all 0.2s;">Remote</button>
          <button id="dsv-mode-all" class="dsv-mode-button" data-mode="all" style="flex: 1; padding: 8px 12px; background: #2A2A32; border: 1px solid #505059; border-radius: 8px; color: white; cursor: pointer; font-size: 12px; transition: all 0.2s;">All</button>
        </div>
      </div>

      <!-- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ó–∞–≥—Ä—É–∑–∫–∞ JSON —Å —Ç–æ–∫–µ–Ω–∞–º–∏ -->
      <div style="margin-bottom: 16px;">
        <details style="background: #2A2A32; border-radius: 8px; padding: 12px;">
          <summary style="font-size: 12px; color: #FFFFFF; font-weight: 600; cursor: pointer; list-style: none; display: flex; align-items: center; gap: 8px;">
            <span style="color: #F86025;">‚ñ∏</span> –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ó–∞–≥—Ä—É–∑–∏—Ç—å JSON —Å —Ç–æ–∫–µ–Ω–∞–º–∏
          </summary>
          <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #505059;">
            
            <!-- –≠–∫—Å–ø–æ—Ä—Ç —Ç–æ–∫–µ–Ω–æ–≤ –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Ñ–∞–π–ª–∞ -->
            <div style="margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px solid #505059;">
              <div style="font-size: 11px; color: #AAAAAA; margin-bottom: 8px; line-height: 1.4;">
                <strong style="color: #FFFFFF;">–®–∞–≥ 1:</strong> –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω—ã –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ Figma —Ñ–∞–π–ª–∞
              </div>
              <button id="dsv-export-tokens-button" class="secondary-button" style="width: 100%; font-size: 11px; padding: 8px 12px; background: #3A3A42; border: 1px solid #F86025;">
                üì§ –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω—ã –≤ JSON
              </button>
              <div id="dsv-export-status" style="font-size: 10px; color: #AAAAAA; margin-top: 6px; display: none;">
                <span id="dsv-export-status-text"></span>
              </div>
            </div>

            <!-- –ó–∞–≥—Ä—É–∑–∫–∞ JSON -->
            <div>
              <div style="font-size: 11px; color: #AAAAAA; margin-bottom: 8px; line-height: 1.4;">
                <strong style="color: #FFFFFF;">–®–∞–≥ 2:</strong> –ò–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –≥–æ—Ç–æ–≤—ã–π JSON —Ñ–∞–π–ª —Å —Ç–æ–∫–µ–Ω–∞–º–∏
                <a href="#" id="dsv-show-json-format" style="color: #F86025; text-decoration: none;">–§–æ—Ä–º–∞—Ç ‚Üí</a>
              </div>
              <input type="file" id="dsv-tokens-json-file" accept=".json" style="display: none;">
              <div style="display: flex; gap: 8px;">
                <button id="dsv-load-tokens-json-button" class="secondary-button" style="flex: 1; font-size: 11px; padding: 6px 12px;">
                  üìÅ –ó–∞–≥—Ä—É–∑–∏—Ç—å JSON
                </button>
                <button id="dsv-clear-tokens-json-button" class="secondary-button" style="flex: 1; font-size: 11px; padding: 6px 12px;" disabled>
                  üîÑ –ó–∞–º–µ–Ω–∏—Ç—å
                </button>
              </div>
              <div id="dsv-tokens-json-status" style="font-size: 10px; color: #AAAAAA; margin-top: 6px; display: none;">
                <span id="dsv-tokens-json-status-text">–§–∞–π–ª –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω</span>
              </div>
              <div style="font-size: 10px; color: #888; margin-top: 4px; line-height: 1.3;">
                üí° –¢–æ–∫–µ–Ω—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—É—Å–∫–µ
              </div>
            </div>

          </div>
        </details>
      </div>

      <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
      <div style="background: #2A2A32; border-radius: 8px; padding: 12px; margin-bottom: 16px; font-size: 11px; line-height: 1.5; color: #AAAAAA; border-left: 3px solid #F86025;">
        üí° <strong style="color: #FFFFFF;">–°–æ–≤–µ—Ç:</strong> –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –≤—ã–¥–µ–ª–µ–Ω–æ ‚Äî –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ –≤—Å—è —Ç–µ–∫—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞. –í—ã–¥–µ–ª–∏—Ç–µ –æ–±—ä–µ–∫—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤.
      </div>

      <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ -->
      <div style="margin-bottom: 16px;">
        <label style="font-size: 12px; color: #FFFFFF; display: block; margin-bottom: 8px; font-weight: 600;">–ù–∞—Å—Ç—Ä–æ–π–∫–∏:</label>
        
        <!-- –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ -->
        <div style="background: #2A2A32; border-radius: 8px; padding: 12px; margin-bottom: 8px;">
          <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px; color: #FFFFFF;">
            <input type="checkbox" id="dsv-skip-instances" style="margin-right: 8px; cursor: pointer;">
            <span>–ü—Ä–æ–ø—É—Å–∫–∞—Ç—å –≤–ª–æ–∂–µ–Ω–Ω—ã–µ Instance –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã</span>
          </label>
          <div style="font-size: 10px; color: #AAAAAA; margin-top: 4px; margin-left: 24px;">
            –ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ, Instance –≤–Ω—É—Ç—Ä–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –Ω–µ –±—É–¥—É—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å—Å—è –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
          </div>
        </div>

        <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º—ã—Ö —Å–≤–æ–π—Å—Ç–≤ -->
        <details style="background: #2A2A32; border-radius: 8px; padding: 12px;">
          <summary style="font-size: 12px; color: #FFFFFF; font-weight: 600; cursor: pointer; list-style: none; display: flex; align-items: center; gap: 8px; margin-bottom: 0;">
            <span style="color: #F86025;">‚ñ∏</span> –ü—Ä–æ–≤–µ—Ä—è–µ–º—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞
          </summary>
          <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #505059;">
            <div style="font-size: 10px; color: #AAAAAA; margin-bottom: 12px;">
              –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞–∫–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Ç–æ–∫–µ–Ω–æ–≤:
            </div>
            
            <!-- –¶–≤–µ—Ç–∞ -->
            <div style="margin-bottom: 12px;">
              <div style="font-size: 11px; color: #FFFFFF; font-weight: 600; margin-bottom: 6px;">üé® –¶–≤–µ—Ç–∞</div>
              <label style="display: flex; align-items: center; cursor: pointer; font-size: 11px; color: #FFFFFF; margin-bottom: 4px;">
                <input type="checkbox" id="dsv-check-fills" checked style="margin-right: 8px; cursor: pointer;">
                <span>Fill (–ó–∞–ª–∏–≤–∫–∞)</span>
              </label>
              <label style="display: flex; align-items: center; cursor: pointer; font-size: 11px; color: #FFFFFF;">
                <input type="checkbox" id="dsv-check-strokes" checked style="margin-right: 8px; cursor: pointer;">
                <span>Stroke (–û–±–≤–æ–¥–∫–∞)</span>
              </label>
            </div>

            <!-- –†–∞–∑–º–µ—Ä—ã –∏ –æ—Ç—Å—Ç—É–ø—ã -->
            <div style="margin-bottom: 12px;">
              <div style="font-size: 11px; color: #FFFFFF; font-weight: 600; margin-bottom: 6px;">üìè –†–∞–∑–º–µ—Ä—ã –∏ –æ—Ç—Å—Ç—É–ø—ã</div>
              <label style="display: flex; align-items: center; cursor: pointer; font-size: 11px; color: #FFFFFF; margin-bottom: 4px;">
                <input type="checkbox" id="dsv-check-corner-radius" checked style="margin-right: 8px; cursor: pointer;">
                <span>Corner Radius (–†–∞–¥–∏—É—Å —Å–∫—Ä—É–≥–ª–µ–Ω–∏—è)</span>
              </label>
              <label style="display: flex; align-items: center; cursor: pointer; font-size: 11px; color: #FFFFFF; margin-bottom: 4px;">
                <input type="checkbox" id="dsv-check-spacing" checked style="margin-right: 8px; cursor: pointer;">
                <span>Gap / Item Spacing (–û—Ç—Å—Ç—É–ø—ã –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏)</span>
              </label>
              <label style="display: flex; align-items: center; cursor: pointer; font-size: 11px; color: #FFFFFF;">
                <input type="checkbox" id="dsv-check-padding" checked style="margin-right: 8px; cursor: pointer;">
                <span>Padding (–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ—Ç—Å—Ç—É–ø—ã)</span>
              </label>
            </div>

            <!-- –≠—Ñ—Ñ–µ–∫—Ç—ã –∏ –ø—Ä–æ—á–µ–µ -->
            <div>
              <div style="font-size: 11px; color: #FFFFFF; font-weight: 600; margin-bottom: 6px;">‚ú® –≠—Ñ—Ñ–µ–∫—Ç—ã –∏ –ø—Ä–æ—á–µ–µ</div>
              <label style="display: flex; align-items: center; cursor: pointer; font-size: 11px; color: #FFFFFF; margin-bottom: 4px;">
                <input type="checkbox" id="dsv-check-effects" style="margin-right: 8px; cursor: pointer;">
                <span>Effects (–≠—Ñ—Ñ–µ–∫—Ç—ã: —Ç–µ–Ω–∏, —Ä–∞–∑–º—ã—Ç–∏–µ)</span>
              </label>
              <label style="display: flex; align-items: center; cursor: pointer; font-size: 11px; color: #FFFFFF; margin-bottom: 4px;">
                <input type="checkbox" id="dsv-check-opacity" style="margin-right: 8px; cursor: pointer;">
                <span>Opacity (–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å)</span>
              </label>
              <label style="display: flex; align-items: center; cursor: pointer; font-size: 11px; color: #FFFFFF;">
                <input type="checkbox" id="dsv-check-size" style="margin-right: 8px; cursor: pointer;">
                <span>Width/Height (–®–∏—Ä–∏–Ω–∞/–í—ã—Å–æ—Ç–∞)</span>
              </label>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∏ –±—ã—Å—Ç—Ä—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π -->
            <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #505059; display: flex; gap: 8px;">
              <button id="dsv-select-all-props" class="secondary-button" style="flex: 1; font-size: 10px; padding: 4px 8px;">
                ‚úì –í—Å–µ
              </button>
              <button id="dsv-select-none-props" class="secondary-button" style="flex: 1; font-size: 10px; padding: 4px 8px;">
                ‚úó –ù–µ—Ç
              </button>
              <button id="dsv-select-default-props" class="secondary-button" style="flex: 1; font-size: 10px; padding: 4px 8px;">
                ‚Ü∫ –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
              </button>
            </div>
          </div>
        </details>
      </div>

      </div><!-- –ö–æ–Ω–µ—Ü –ø–∞–Ω–µ–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->

      <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ -->
      <div id="dsv-results-panel" style="display: none;">
        
        <!-- –°–≤–æ–¥–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
        <div id="dsv-summary" style="background: #2A2A32; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
          <div style="font-size: 14px; font-weight: 600; color: #FFFFFF; margin-bottom: 12px;">üìä –°–≤–æ–¥–∫–∞</div>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 11px;">
            <div style="display: flex; justify-content: space-between;">
              <span style="color: #AAAAAA;">–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤:</span>
              <span id="dsv-total-nodes" style="color: #FFFFFF; font-weight: 600;">0</span>
            </div>
            <div style="display: flex; justify-content: space-between;">
              <span style="color: #AAAAAA;">–ù–∞–π–¥–µ–Ω–æ –ø—Ä–æ–±–ª–µ–º:</span>
              <span id="dsv-total-issues" style="color: #F44336; font-weight: 600;">0</span>
            </div>
            <div style="display: flex; justify-content: space-between;">
              <span style="color: #AAAAAA;">–° —Ç–æ–∫–µ–Ω–∞–º–∏:</span>
              <span id="dsv-with-variables" style="color: #4CAF50; font-weight: 600;">0</span>
            </div>
            <div style="display: flex; justify-content: space-between;">
              <span style="color: #AAAAAA;">–ë–µ–∑ —Ç–æ–∫–µ–Ω–æ–≤:</span>
              <span id="dsv-without-variables" style="color: #F86025; font-weight: 600;">0</span>
            </div>
          </div>
        </div>

        <!-- –°–ø–∏—Å–æ–∫ –ø—Ä–æ–±–ª–µ–º -->
        <div id="dsv-issues-section" style="display: none;">
          <div style="font-size: 14px; font-weight: 600; color: #FFFFFF; margin-bottom: 12px;">
            ‚ö†Ô∏è –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
          </div>
          <div id="dsv-issues-list" style="max-height: 300px; overflow-y: auto;">
            <!-- Issues will be inserted here -->
          </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –æ—Ç—á—ë—Ç–∞ -->
        <div style="margin-top: 16px;">
          <button id="dsv-export-report-button" class="secondary-button" style="width: 100%;">
            üìÑ –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á—ë—Ç (JSON)
          </button>
        </div>
      </div>

      <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
      <div id="dsv-loading-indicator" style="display: none; text-align: center; padding: 20px; color: #AAAAAA;">
        <div style="margin-bottom: 8px;">‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞...</div>
        <div id="dsv-progress-text" style="font-size: 11px;">–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ: <span id="dsv-progress-count">0</span> —ç–ª–µ–º–µ–Ω—Ç–æ–≤</div>
      </div>

    </div>

    <!-- SVG Export Section -->
    <div id="svg-export-section" class="svg-export-section">

      <div class="export-buttons">
        <button id="scan-icons-button" class="primary-button" style="width: 100%; margin-bottom: 16px;">–ü–æ—Å—á–∏—Ç–∞—Ç—å –∏–∫–æ–Ω–∫–∏</button>
      </div>
      
      <div id="export-stats" class="export-stats" style="display: none;">
        <div class="stats-item">
          <span class="stats-label">–ò–∫–æ–Ω–æ–∫ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö</span>
          <span id="component-sets-count" class="stats-value">0</span>
        </div>
        <div class="stats-item">
          <span class="stats-label">–ò–∫–æ–Ω–æ–∫ —Å —Ä–∞–∑–Ω—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏</span>
          <span id="total-variants-count" class="stats-value">0</span>
        </div>
      </div>

      

      

     

      
    </div>

    <div id="svg-export-section" class="svg-export-section">
      <div id="color-options" class="color-options" style="display: none; margin-bottom: 16px;">
        <div class="settings-item">
          <input type="checkbox" id="apply-fill-color" />
          <label for="apply-fill-color">–ó–∞–¥–∞—Ç—å —Ü–≤–µ—Ç –∏–∫–æ–Ω–∫–∞–º [fill]</label>
        </div>
        
        <div id="color-selection" style="display: none; margin-top: 16px;">
          <div class="color-preset-buttons">
            <button type="button" class="color-preset-btn" data-color="#000000" style="background: #000000; color: white;">–ß–µ—Ä–Ω—ã–π</button>
            <button type="button" class="color-preset-btn" data-color="#FFFFFF" style="background: #FFFFFF; color: black; border: 1px solid #666;">–ë–µ–ª—ã–π</button>
            <button type="button" class="color-preset-btn" data-color="#F86025" style="background: #F86025; color: white;">Orbita</button>
          </div>
          
          <div class="custom-color-input" style="margin-top: 0px;">
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
              <input type="color" id="custom-fill-color" value="#000000" style="width: 32px; height: 32px; border: none; border-radius: 8px; cursor: pointer;">
              <input type="text" id="custom-fill-hex" value="#000000" placeholder="#000000" style="background: #b5b7c026; border-radius: 8px; padding: 8px 16px; color: white; font-size: 14px; width: 120px;">
            </div>
          </div>
        </div>
      </div>

      <div class="export-buttons">
        <button id="export-icons-button" class="primary-button" style="width: 100%; display: none;">–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ SVG (zip)</button>
      </div>

      <!-- –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å–±–∞—Ä –¥–ª—è SVG —ç–∫—Å–ø–æ—Ä—Ç–∞ -->
      <div id="svg-export-progress" class="svg-export-progress" style="display: none;">
        <div class="export-progress-header">
          <span id="export-progress-text">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —ç–∫—Å–ø–æ—Ä—Ç—É...</span>
          <span id="export-counter" class="export-counter">0/0</span>
        </div>
        
        <div class="export-progress-bar">
          <div id="export-progress-fill" class="export-progress-fill"></div>
        </div>
        
        <div class="export-progress-details">
          <span id="export-percentage" class="export-percentage">0%</span>
          <span id="export-current-icon" class="export-current-icon">–ì–æ—Ç–æ–≤–∏–º—Å—è...</span>
        </div>
      </div>
    </div>
    
    <div id="settings-dropdown" class="settings-dropdown" style="display: none;">
      <!-- –ü—É–Ω–∫—Ç "–í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏" -->
      <div class="settings-item all-checks-item">
        <input type="checkbox" id="all-checks" checked>
        <label for="all-checks">–í—Å—ë –ø—Ä–æ–≤–µ—Ä—è—Ç—å</label>
      </div>
      
      <!-- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å -->
      <div class="settings-divider"></div>
      
      <!-- –ù–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ -->
      <div class="settings-item">
        <input type="checkbox" id="naming-check" checked>
        <label for="naming-check">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞</label>
        <div class="tooltip-icon">?
          <div class="tooltip">–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –∏–º—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å "orb-icon-", —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–∫–æ–Ω–∫–∏ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ –¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Å–∏–º–≤–æ–ª—ã (—Å—Ç—Ä–æ—á–Ω—ã–µ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã –∏ –¥–µ—Ñ–∏—Å—ã).</div>
        </div>
      </div>
      
      <!-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏ –∑–∞–≤–∏—Å–∏–º–∞—è –æ—Ç –Ω–µ–µ –ø—Ä–æ–≤–µ—Ä–∫–∞ description -->
      <div class="settings-item">
        <input type="checkbox" id="variants-check" checked>
        <label for="variants-check">–í–∞—Ä–∏–∞–Ω—Ç—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞</label>
        <div class="tooltip-icon">?
          <div class="tooltip">–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Å–≤–æ–π—Å—Ç–≤ Variant (outline/solid) –∏ Size (lg/md/sm/xs/xxs).</div>
        </div>
      </div>
      <div class="settings-item dependent-item">
        <input type="checkbox" id="description-check" checked>
        <label for="description-check">–û–ø–∏—Å–∞–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤</label>
        <div class="tooltip-icon">?
          <div class="tooltip">–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ description –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç—É "name-variant-size". –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤, —Ç–∞–∫ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è Variant –∏ Size.</div>
        </div>
      </div>
      
      <div class="settings-item">
        <input type="checkbox" id="sizes-check" checked>
        <label for="sizes-check">–†–∞–∑–º–µ—Ä—ã –∏–∫–æ–Ω–∫–∏</label>
        <div class="tooltip-icon">?
          <div class="tooltip">–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —Ä–∞–∑–º–µ—Ä—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º (32x32, 24x24, 16x16, 12x12 –∏–ª–∏ 8x8 px).</div>
        </div>
      </div>
      
      <!-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –∑–∞–≤–∏—Å–∏–º—ã–µ –æ—Ç –Ω–µ–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ -->
      <div class="settings-item">
        <input type="checkbox" id="structure-check" checked>
        <label for="structure-check">–°—Ç—Ä—É–∫—Ç—É—Ä—É –∏–∫–æ–Ω–∫–∏</label>
        <div class="tooltip-icon">?
          <div class="tooltip">–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Å–ª–æ—è Color-layer –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ Vector –≤–Ω—É—Ç—Ä–∏ –Ω–µ–≥–æ.</div>
        </div>
      </div>
      <div class="settings-item dependent-item">
        <input type="checkbox" id="constraints-check" checked>
        <label for="constraints-check">–í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ</label>
        <div class="tooltip-icon">?
          <div class="tooltip">–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —Å–ª–æ–π Color-layer –≤—ã—Ä–æ–≤–Ω–µ–Ω –ø–æ —Ü–µ–Ω—Ç—Ä—É (CENTER –¥–ª—è horizontal –∏ vertical constraints). –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, —Ç–∞–∫ –∫–∞–∫ —Ç—Ä–µ–±—É–µ—Ç –Ω–∞–ª–∏—á–∏—è —Å–ª–æ—è Color-layer.</div>
        </div>
      </div>
      <div class="settings-item dependent-item">
        <input type="checkbox" id="vector-check" checked>
        <label for="vector-check">–°–ª–æ–π Vector</label>
        <div class="tooltip-icon">?
          <div class="tooltip">–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —Å–ª–æ–π Vector –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω, –∏–º–µ–µ—Ç —Ç–∏–ø VECTOR –∏ –Ω–µ –∏–º–µ–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞. –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, —Ç–∞–∫ –∫–∞–∫ —Ç—Ä–µ–±—É–µ—Ç –Ω–∞–ª–∏—á–∏—è —Å–ª–æ—è Vector –≤–Ω—É—Ç—Ä–∏ Color-layer.</div>
        </div>
      </div>
      
      <div class="settings-item">
        <input type="checkbox" id="editGroup-check" checked>
        <label for="editGroup-check">–ù–∞–ª–∏—á–∏–µ –∏—Å—Ö–æ–¥–Ω–∏–∫–∞ –∏–∫–æ–Ω–∫–∏</label>
        <div class="tooltip-icon">?
          <div class="tooltip">–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∏ —Å–∫—Ä—ã—Ç–æ—Å—Ç—å –æ–±—ä–µ–∫—Ç–∞ —Å –∏–º–µ–Ω–µ–º "Edit" –∏–ª–∏ "edit" –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ö–æ–¥–Ω–∏–∫–∞ –∏–∫–æ–Ω–∫–∏. –û–±—ä–µ–∫—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±–æ–≥–æ —Ç–∏–ø–∞: —Ñ—Ä–µ–π–º, –≥—Ä—É–ø–ø–∞, –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ –¥—Ä—É–≥–∏–µ. –ü—Ä–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å–∫—Ä—ã—Ç—ã–π —Ñ—Ä–µ–π–º —Ä–∞–∑–º–µ—Ä–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.</div>
        </div>
      </div>

      <div class="settings-item">
        <input type="checkbox" id="noStroke-check" checked>
        <label for="noStroke-check">–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±–≤–æ–¥–∫–∏ —É —Å–ª–æ–µ–≤</label>
        <div class="tooltip-icon">?
          <div class="tooltip">–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —Å–ª–æ–∏ Color-layer –∏ Vector –Ω–µ –∏–º–µ—é—Ç –æ–±–≤–æ–¥–∫–∏ (Stroke). –ò–∫–æ–Ω–∫–∏ –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –∑–∞–ª–∏–≤–∫—É fill.</div>
        </div>
      </div>

      <div class="settings-item">
        <input type="checkbox" id="excludeDotNames-check" checked>
        <label for="excludeDotNames-check">–ò—Å–∫–ª—é—á–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å —Ç–æ—á–∫–æ–π</label>
        <div class="tooltip-icon">?
          <div class="tooltip">–ò—Å–∫–ª—é—á–∞–µ—Ç –∏–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å —Ç–æ—á–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, .orb-icon-test). –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.</div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="content-container">
    <div id="progress-container" class="progress-container" style="display: none;">
      <div class="progress-bar">
        <div id="progress-fill" class="progress-fill"></div>
      </div>
      <div id="progress-text" class="progress-text">0%</div>
    </div>
    
    <div id="status" class="loading" style="display: none;">
      –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∫–æ–Ω–æ–∫, –∏–º–µ–π —Ç–µ—Ä–ø–µ–Ω–∏–µ...
    </div>
    
    <div id="error-container" style="display: none;"></div>
    
    <div id="results-container" class="results-container"></div>
  </div>

  <script>
    // –§–ª–∞–≥ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞ false –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
    const DEBUG_MODE = false;
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É—Å–ª–æ–≤–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
    function debugLog(...args) {
      if (DEBUG_MODE) {
        console.log(...args);
      }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É—Å–ª–æ–≤–Ω–æ–≥–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
    function debugWarn(...args) {
      if (DEBUG_MODE) {
        console.warn(...args);
      }
    }
    
    // –ü–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã UI
    const checkButton = document.getElementById('check-button');
    const statusElement = document.getElementById('status');
    const resultsContainer = document.getElementById('results-container');
    const progressContainer = document.getElementById('progress-container');
    const progressFill = document.getElementById('progress-fill');
    const progressText = document.getElementById('progress-text');
    const errorContainer = document.getElementById('error-container');
    const settingsButton = document.getElementById('settings-button');
    const settingsDropdown = document.getElementById('settings-dropdown');
    const errorBadge = document.getElementById('error-badge');
    
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–≤–µ—Ä–æ–∫
    const checkboxes = {
      naming: document.getElementById('naming-check'),
      variants: document.getElementById('variants-check'),
      sizes: document.getElementById('sizes-check'),
      structure: document.getElementById('structure-check'),
      constraints: document.getElementById('constraints-check'),
      vector: document.getElementById('vector-check'),
      editGroup: document.getElementById('editGroup-check'),
      description: document.getElementById('description-check'),
      noStroke: document.getElementById('noStroke-check'),
      excludeDotNames: document.getElementById('excludeDotNames-check')
    };
    
    // –ß–µ–∫–±–æ–∫—Å "–í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏"
    const allChecksCheckbox = document.getElementById('all-checks');
    
    // –û–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ–∫–±–æ–∫—Å–æ–≤ —Å —É—á–µ—Ç–æ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
    function updateCheckboxStates() {
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ checkboxes –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
      if (!checkboxes) {
        debugWarn('updateCheckboxStates: checkboxes –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã');
        return;
      }
      
      // –ü—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
      const constraintsCheckbox = checkboxes.constraints;
      const vectorCheckbox = checkboxes.vector;
      const descriptionCheckbox = checkboxes.description;
      const structureCheckbox = checkboxes.structure;
      const variantsCheckbox = checkboxes.variants;
      
      // constraints –∑–∞–≤–∏—Å–∏—Ç –æ—Ç structure
      if (constraintsCheckbox && structureCheckbox) {
        if (!structureCheckbox.checked) {
          constraintsCheckbox.checked = false;
          constraintsCheckbox.disabled = true;
        } else {
          constraintsCheckbox.disabled = false;
        }
      }
      
      // vector –∑–∞–≤–∏—Å–∏—Ç –æ—Ç structure
      if (vectorCheckbox && structureCheckbox) {
        if (!structureCheckbox.checked) {
          vectorCheckbox.checked = false;
          vectorCheckbox.disabled = true;
        } else {
          vectorCheckbox.disabled = false;
        }
      }
      
      // description —á–∞—Å—Ç–∏—á–Ω–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç variants
      if (descriptionCheckbox && variantsCheckbox) {
        if (!variantsCheckbox.checked) {
          descriptionCheckbox.checked = false;
          descriptionCheckbox.disabled = true;
        } else {
          descriptionCheckbox.disabled = false;
        }
      }
    }
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —á–µ–∫–±–æ–∫—Å–∞ "–í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏"
    allChecksCheckbox.addEventListener('change', () => {
      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ —á–µ–∫–±–æ–∫—Å—ã –≤ —Ç–æ –∂–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, —á—Ç–æ –∏ "–í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏"
      for (const checkbox of Object.values(checkboxes)) {
        checkbox.checked = allChecksCheckbox.checked;
      }
      
      // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ–∫–±–æ–∫—Å–æ–≤ —Å —É—á–µ—Ç–æ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
      updateCheckboxStates();
    });
    
    // –°–æ–∑–¥–∞–µ–º –¥–µ–±–∞—É–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
    const debouncedUpdateSettings = debounce(() => {
      // –ü–æ–ª—É—á–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ —á–µ–∫–±–æ–∫—Å–æ–≤
      const settings = {};
      for (const [key, checkbox] of Object.entries(checkboxes)) {
        settings[key] = checkbox.checked;
      }
      
      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –ø–ª–∞–≥–∏–Ω
      parent.postMessage({
        pluginMessage: {
          type: 'update-settings',
          settings: settings
        }
      }, '*');
    }, 300); // –ó–∞–¥–µ—Ä–∂–∫–∞ –≤ 300 –º—Å
    
    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è —á–µ–∫–±–æ–∫—Å–æ–≤
    for (const [key, checkbox] of Object.entries(checkboxes)) {
      checkbox.addEventListener('change', () => {
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤—Å–µ—Ö —á–µ–∫–±–æ–∫—Å–æ–≤
        updateCheckboxStates();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ–∫–±–æ–∫—Å–∞ "–í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏"
        updateAllChecksState();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –ø–ª–∞–≥–∏–Ω–µ —Å debounce
        debouncedUpdateSettings();
      });
    }
    
    /**
     * –û–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ–∫–±–æ–∫—Å–∞ "–í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏" –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥—Ä—É–≥–∏—Ö —á–µ–∫–±–æ–∫—Å–æ–≤
     */
    function updateAllChecksState() {
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ checkboxes –∏ allChecksCheckbox –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
      if (!checkboxes || !allChecksCheckbox) {
        debugWarn('updateAllChecksState: checkboxes –∏–ª–∏ allChecksCheckbox –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã');
        return;
      }
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—Å–µ –ª–∏ —á–µ–∫–±–æ–∫—Å—ã –≤–∫–ª—é—á–µ–Ω—ã
      const checkboxValues = Object.values(checkboxes);
      if (checkboxValues.length === 0) {
        debugWarn('updateAllChecksState: –Ω–µ—Ç —á–µ–∫–±–æ–∫—Å–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏');
        return;
      }
      
      const allEnabled = checkboxValues.every(checkbox => checkbox && checkbox.checked);
      
      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ–∫–±–æ–∫—Å–∞ "–í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏"
      allChecksCheckbox.checked = allEnabled;
    }
    
    // –¢–µ–∫—É—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏
    let currentResults = [];
    
    // –§–ª–∞–≥ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏
    let isCheckingInProgress = false;
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ –∫–Ω–æ–ø–∫—É –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –¥–≤–æ–π–Ω–æ–≥–æ –∫–ª–∏–∫–∞
    const toggleSettingsDropdown = debounce(() => {
      if (settingsDropdown.style.display === 'block') {
        settingsDropdown.style.display = 'none';
      } else {
        settingsDropdown.style.display = 'block';
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ–∫–±–æ–∫—Å–æ–≤ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
        updateCheckboxStates();
      }
    }, 200);
    
    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
    settingsButton.addEventListener('click', toggleSettingsDropdown);
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ –∫–Ω–æ–ø–∫—É "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∫–æ–Ω–∫–∏"
    checkButton.addEventListener('click', () => {
      if (isCheckingInProgress) {
        // –ï—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —É–∂–µ –∑–∞–ø—É—â–µ–Ω–∞, –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –µ–µ
        isCheckingInProgress = false;
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ø–ª–∞–≥–∏–Ω –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏
        parent.postMessage({
          pluginMessage: {
            type: 'stop-check'
          }
        }, '*');
        
        // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–Ω–æ–ø–∫–µ –∏—Å—Ö–æ–¥–Ω—ã–π –≤–∏–¥
        checkButton.textContent = '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å';
        checkButton.style.backgroundColor = '#F86025';
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
        statusElement.textContent = '–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞';
        
        return;
      }
      
      // –ï—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ –∑–∞–ø—É—â–µ–Ω–∞, –∑–∞–ø—É—Å–∫–∞–µ–º –µ–µ
      isCheckingInProgress = true;
      
      // –ú–µ–Ω—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–∞ Icons Checker
      const headerTitle = document.querySelector('h1');
      if (headerTitle) {
        headerTitle.innerHTML = 'Orbita DS&nbsp;&nbsp;‚ú¶&nbsp;&nbsp;Icons Checker';
      }
      
      // –ú–µ–Ω—è–µ–º —Ç–µ–∫—Å—Ç –∏ —Ü–≤–µ—Ç –∫–Ω–æ–ø–∫–∏
      checkButton.textContent = '–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É';
      checkButton.style.backgroundColor = '#E74C3C';
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å
      statusElement.style.display = 'block';
      progressContainer.style.display = 'block';
      progressFill.style.width = '0%';
      progressText.textContent = '0%';
      resultsContainer.innerHTML = '';
      errorContainer.style.display = 'none';
      errorContainer.innerHTML = '';
      // –°–∫—Ä—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –Ω–∞—á–∞–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
      errorBadge.style.display = 'none';
      
      // –ü–æ–ª—É—á–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–≤–µ—Ä–æ–∫
      const settings = {};
      for (const [key, checkbox] of Object.entries(checkboxes)) {
        settings[key] = checkbox.checked;
      }
      
      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ø–ª–∞–≥–∏–Ω –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∫–æ–Ω–æ–∫
      parent.postMessage({
        pluginMessage: {
          type: 'check-icons',
          settings: settings
        }
      }, '*');
    });
    
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ –∫–Ω–æ–ø–∫—É "–°–æ–∑–¥–∞—Ç—å Cell"
    document.getElementById('create-cell-button').addEventListener('click', () => {
      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ø–ª–∞–≥–∏–Ω –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è Cell
      parent.postMessage({
        pluginMessage: {
          type: 'create-cell'
        }
      }, '*');
    });

    // Node ID Inspector —ç–ª–µ–º–µ–Ω—Ç—ã
    const getNodeIdButton = document.getElementById('get-node-id-button');
    const compareIdsButton = document.getElementById('compare-ids-button');
    const currentNodeIdDisplay = document.getElementById('current-node-id');
    const nodeIdsTextarea = document.getElementById('node-ids-textarea');
    const comparisonResult = document.getElementById('comparison-result');

    // SVG Export —ç–ª–µ–º–µ–Ω—Ç—ã
    const scanIconsButton = document.getElementById('scan-icons-button');
    const exportIconsButton = document.getElementById('export-icons-button');
    const exportStats = document.getElementById('export-stats');
    const componentSetsCount = document.getElementById('component-sets-count');
    const totalVariantsCount = document.getElementById('total-variants-count');
    const exportInfo = document.getElementById('export-info');
    const colorOptions = document.getElementById('color-options');
    const applyFillColorCheckbox = document.getElementById('apply-fill-color');
    const colorSelection = document.getElementById('color-selection');
    const customFillColor = document.getElementById('custom-fill-color');
    const customFillHex = document.getElementById('custom-fill-hex');
    const colorPresetButtons = document.querySelectorAll('.color-preset-btn');
    
    // –≠–ª–µ–º–µ–Ω—Ç—ã –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–±–∞—Ä–∞ –¥–ª—è SVG —ç–∫—Å–ø–æ—Ä—Ç–∞
    const svgExportProgress = document.getElementById('svg-export-progress');
    const exportProgressText = document.getElementById('export-progress-text');
    const exportCounter = document.getElementById('export-counter');
    const exportProgressFill = document.getElementById('export-progress-fill');
    const exportPercentage = document.getElementById('export-percentage');
    const exportCurrentIcon = document.getElementById('export-current-icon');
    
    // –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
    let scannedComponentSets = [];
    
    // –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è SVG —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞—Ä—Ö–∏–≤–∞
    let svgFiles = [];
    let expectedFilesCount = 0;
    
    // –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞ fill
    let selectedFillColor = '#000000';

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ –∫–Ω–æ–ø–∫—É "–ü–æ–ª—É—á–∏—Ç—å ID –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–≥–æ"
    getNodeIdButton.addEventListener('click', () => {
      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ø–ª–∞–≥–∏–Ω –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è ID –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞
      parent.postMessage({
        pluginMessage: {
          type: 'get-selected-node-id'
        }
      }, '*');
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ –∫–Ω–æ–ø–∫—É "–°—Ä–∞–≤–Ω–∏—Ç—å ID"
    compareIdsButton.addEventListener('click', () => {
      compareNodeIds();
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ –∫–Ω–æ–ø–∫—É "–°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É"
    scanIconsButton.addEventListener('click', () => {
        debugLog('SVG Export: –ù–∞—á–∏–Ω–∞–µ–º —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã');
      
      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ø–ª–∞–≥–∏–Ω –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏–∫–æ–Ω–æ–∫
      parent.postMessage({
        pluginMessage: {
          type: 'scan-icons-for-export'
        }
      }, '*');
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
      scanIconsButton.textContent = '–°–∫–∞–Ω–∏—Ä—É–µ–º...';
      scanIconsButton.disabled = true;
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ü–≤–µ—Ç–∞ fill
    applyFillColorCheckbox.addEventListener('change', () => {
      if (applyFillColorCheckbox.checked) {
        colorSelection.style.display = 'block';
      } else {
        colorSelection.style.display = 'none';
      }
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Ü–≤–µ—Ç–æ–≤
    colorPresetButtons.forEach(button => {
      button.addEventListener('click', () => {
        const color = button.getAttribute('data-color');
        setSelectedColor(color);
        updateActiveColorButton(button);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–ª—è –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞
        customFillColor.value = color;
        customFillHex.value = color.toUpperCase();
      });
    });

    // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ü–≤–µ—Ç–æ–≤–æ–≥–æ –ø–∏–∫–µ—Ä–∞ –∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—è
    customFillColor.addEventListener('change', () => {
      const color = customFillColor.value.toUpperCase();
      setSelectedColor(color);
      customFillHex.value = color;
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ —Ü–≤–µ—Ç –æ–¥–Ω–æ–º—É –∏–∑ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö
      const matchingButton = document.querySelector(`.color-preset-btn[data-color="${color}"]`);
      updateActiveColorButton(matchingButton);
    });

    customFillHex.addEventListener('input', () => {
      const color = customFillHex.value.toUpperCase();
      if (/^#[0-9A-Fa-f]{6}$/.test(color)) {
        setSelectedColor(color);
        customFillColor.value = color;
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ —Ü–≤–µ—Ç –æ–¥–Ω–æ–º—É –∏–∑ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö
        const matchingButton = document.querySelector(`.color-preset-btn[data-color="${color}"]`);
        updateActiveColorButton(matchingButton);
      }
    });

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞
    function setSelectedColor(color) {
      selectedFillColor = color.toUpperCase();
      debugLog('SVG Export: –í—ã–±—Ä–∞–Ω —Ü–≤–µ—Ç fill:', selectedFillColor);
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –≤–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ü–≤–µ—Ç–∞ –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º –ø–æ–ª–µ
      if (customFillHex) {
        customFillHex.style.setProperty('--selected-color', selectedFillColor);
        customFillHex.classList.add('has-color');
      }
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ–π –∫–Ω–æ–ø–∫–∏ —Ü–≤–µ—Ç–∞
    function updateActiveColorButton(activeButton) {
      colorPresetButtons.forEach(btn => btn.classList.remove('active'));
      if (activeButton) {
        activeButton.classList.add('active');
      }
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ –∫–Ω–æ–ø–∫—É "–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ SVG"
    exportIconsButton.addEventListener('click', () => {
      debugLog('SVG Export: –ù–∞—á–∏–Ω–∞–µ–º —ç–∫—Å–ø–æ—Ä—Ç, –Ω–∞–π–¥–µ–Ω–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç-—Å–µ—Ç–æ–≤:', scannedComponentSets.length);
      
      if (scannedComponentSets.length === 0) {
        debugLog('SVG Export: –û—à–∏–±–∫–∞ - –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞');
        displayMessage({
          type: 'error',
          message: '–°–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –ø—Ä–æ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É'
        });
        return;
      }
      
      debugLog('SVG Export: –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ —ç–∫—Å–ø–æ—Ä—Ç —Å –¥–∞–Ω–Ω—ã–º–∏:', scannedComponentSets);
      
      // –û—á–∏—â–∞–µ–º –º–∞—Å—Å–∏–≤ —Ñ–∞–π–ª–æ–≤ –∏ –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –æ–∂–∏–¥–∞–µ–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
      svgFiles = [];
      expectedFilesCount = scannedComponentSets.reduce((sum, cs) => sum + cs.variants, 0);
      debugLog('SVG Export: –û–∂–∏–¥–∞–µ—Ç—Å—è —Ñ–∞–π–ª–æ–≤:', expectedFilesCount);

      // –ü–æ–ª—É—á–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ü–≤–µ—Ç–∞
      const fillColorSettings = {
        applyFillColor: applyFillColorCheckbox.checked,
        fillColor: selectedFillColor
      };
      
      debugLog('SVG Export: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ü–≤–µ—Ç–∞:', fillColorSettings);
      
      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ø–ª–∞–≥–∏–Ω –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –∏–∫–æ–Ω–æ–∫
      parent.postMessage({
        pluginMessage: {
          type: 'export-icons-to-svg',
          componentSets: scannedComponentSets,
          colorSettings: fillColorSettings
        }
      }, '*');
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
      exportIconsButton.textContent = '–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º...';
      exportIconsButton.disabled = true;
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å–±–∞—Ä –¥–ª—è SVG —ç–∫—Å–ø–æ—Ä—Ç–∞
      svgExportProgress.style.display = 'block';
      exportProgressFill.style.width = '0%';
      exportProgressText.textContent = '–ù–∞—á–∏–Ω–∞–µ–º —ç–∫—Å–ø–æ—Ä—Ç...';
      exportCounter.textContent = `0/${expectedFilesCount}`;
      exportPercentage.textContent = '0%';
      exportCurrentIcon.textContent = '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞...';
      
      // –°–∫—Ä—ã–≤–∞–µ–º –æ–±—ã—á–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å–±–∞—Ä (–æ–Ω –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∫–æ–Ω–æ–∫)
      progressContainer.style.display = 'none';
    });

    // –§—É–Ω–∫—Ü–∏—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è Node ID
    function compareNodeIds() {
      const idsText = nodeIdsTextarea.value.trim();
      
      if (!idsText) {
        showComparisonResult('–í–≤–µ–¥–∏—Ç–µ ID –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è', 'info');
        return;
      }

      // –†–∞–∑–±–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç –Ω–∞ —Å—Ç—Ä–æ–∫–∏ –∏ —Ñ–∏–ª—å—Ç—Ä—É–µ–º –ø—É—Å—Ç—ã–µ
      const ids = idsText.split('\n').map(id => id.trim()).filter(id => id.length > 0);

      if (ids.length < 2) {
        showComparisonResult('–î–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –º–∏–Ω–∏–º—É–º 2 ID', 'info');
        return;
      }

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—Å–µ –ª–∏ ID –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ
      const firstId = ids[0];
      const allSame = ids.every(id => id === firstId);

      if (allSame) {
        showComparisonResult(`‚úÖ –í—Å–µ ${ids.length} ID –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ: ${firstId}`, 'match');
      } else {
        // –ù–∞—Ö–æ–¥–∏–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ ID
        const uniqueIds = [...new Set(ids)];
        showComparisonResult(`‚ùå –ù–∞–π–¥–µ–Ω–æ ${uniqueIds.length} —Ä–∞–∑–Ω—ã—Ö ID –∏–∑ ${ids.length} –≤—Å–µ–≥–æ:
${uniqueIds.map((id, index) => `${index + 1}. ${id}`).join('\n')}`, 'no-match');
      }
    }

    // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
    function showComparisonResult(message, type) {
      comparisonResult.textContent = message;
      comparisonResult.className = `comparison-result ${type}`;
      comparisonResult.style.display = 'block';
      
      // –°–∫—Ä—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
      setTimeout(() => {
        comparisonResult.style.display = 'none';
      }, 10000);
    }
    
    // ============================================
    // AI Design Lint —Ñ—É–Ω–∫—Ü–∏–∏ (–æ–±—ä—è–≤–ª—è–µ–º —Ä–∞–Ω–æ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö)
    // ============================================
    
    // –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –∫ Yandex Eliza API
    async function sendToElizaAPI(designInfo, userPrompt, token) {
      try {
        debugLog('AI Design Lint: –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –∫ Eliza API');
        debugLog('AI Design Lint: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ designInfo:', {
          hasDesignSystem: !!designInfo.designSystem,
          hasVariables: designInfo.designSystem ? !!designInfo.designSystem.variables : false,
          hasRules: designInfo.designSystem ? !!designInfo.designSystem.rules : false,
          elementsCount: designInfo.elements ? designInfo.elements.length : 0
        });
        
        // –§–æ—Ä–º–∏—Ä—É–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–æ–∫–µ–Ω–∞—Ö –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º—ã
        let designSystemContext = '';
        if (designInfo.designSystem && designInfo.designSystem.variables) {
          const ds = designInfo.designSystem;
          
          // –§–æ—Ä–º–∏—Ä—É–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–∫–µ–Ω–∞—Ö
          let tokensInfo = '–î–û–°–¢–£–ü–ù–´–ï –¢–û–ö–ï–ù–´ –î–ò–ó–ê–ô–ù-–°–ò–°–¢–ï–ú–´ ORBITA:\n\n';
          
          if (ds.variables.colors && ds.variables.colors.length > 0) {
            tokensInfo += `–¶–≤–µ—Ç–∞: ${ds.variables.colors.length} —Ç–æ–∫–µ–Ω–æ–≤ (—Ç–æ–ø: ${ds.variables.colors.slice(0, 5).map(v => v.name).join(', ')})\n`;
          }
          
          if (ds.variables.spacing && ds.variables.spacing.length > 0) {
            tokensInfo += `Spacing: ${ds.variables.spacing.length} —Ç–æ–∫–µ–Ω–æ–≤ (—Ç–æ–ø: ${ds.variables.spacing.slice(0, 5).map(v => v.name).join(', ')})\n`;
          }
          
          if (ds.variables.typography && ds.variables.typography.length > 0) {
            tokensInfo += `Typography: ${ds.variables.typography.length} —Ç–æ–∫–µ–Ω–æ–≤ (—Ç–æ–ø: ${ds.variables.typography.slice(0, 5).map(v => v.name).join(', ')})\n`;
          }
          
          // –§–æ—Ä–º–∏—Ä—É–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–∞–≤–∏–ª–∞—Ö
          let rulesInfo = '–ü–†–ê–í–ò–õ–ê –î–ò–ó–ê–ô–ù-–°–ò–°–¢–ï–ú–´:\n';
          if (ds.rules) {
            if (ds.rules.spacing) {
              rulesInfo += `- Spacing: ${ds.rules.spacing.description} (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ: ${ds.rules.spacing.standard.join(', ')}px)\n`;
            }
            if (ds.rules.cornerRadius) {
              rulesInfo += `- Border Radius: ${ds.rules.cornerRadius.description} (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ: ${ds.rules.cornerRadius.standard.join(', ')}px)\n`;
            }
            if (ds.rules.touchTargets) {
              rulesInfo += `- Touch Targets: ${ds.rules.touchTargets.description} (–º–∏–Ω–∏–º—É–º ${ds.rules.touchTargets.minimum}px)\n`;
            }
            if (ds.rules.contrast) {
              rulesInfo += `- Contrast: ${ds.rules.contrast.description} (–æ–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç: ${ds.rules.contrast.normalText}:1, –∫—Ä—É–ø–Ω—ã–π —Ç–µ–∫—Å—Ç: ${ds.rules.contrast.largeText}:1)\n`;
            }
          } else {
            // –ü—Ä–∞–≤–∏–ª–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –µ—Å–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ —Ñ–∞–π–ª–∞
            rulesInfo += `- Spacing: –í—Å–µ –æ—Ç—Å—Ç—É–ø—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∫—Ä–∞—Ç–Ω—ã 4px (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ: 0, 4, 8, 12, 16, 20, 24, 32, 40, 48, 56, 64px)\n`;
            rulesInfo += `- Border Radius: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (0, 2, 4, 6, 8, 12, 16, 20, 24, 32px)\n`;
            rulesInfo += `- Touch Targets: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (–º–∏–Ω–∏–º—É–º 44px)\n`;
            rulesInfo += `- Contrast: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç—Ä–∞—Å—Ç –ø–æ WCAG AA (–æ–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç: 4.5:1, –∫—Ä—É–ø–Ω—ã–π —Ç–µ–∫—Å—Ç: 3.0:1)\n`;
          }
          
          designSystemContext = tokensInfo + rulesInfo;
        }
        
        // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Å—Ç–æ–º–Ω—É—é –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º—É, –µ—Å–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ (—Å–æ–∫—Ä–∞—â—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
        if (customDesignSystemJson) {
          designSystemContext += '\n\n–ö–ê–°–¢–û–ú–ù–ê–Ø –î–ò–ó–ê–ô–ù-–°–ò–°–¢–ï–ú–ê:\n';
          
          // –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –∫–ª—é—á–µ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ JSON
          if (customDesignSystemJson.tokens) {
            designSystemContext += '–ö–∞—Å—Ç–æ–º–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã: ';
            const tokenCategories = Object.keys(customDesignSystemJson.tokens);
            designSystemContext += tokenCategories.join(', ') + '\n';
          }
          
          if (customDesignSystemJson.rules) {
            designSystemContext += '–ü—Ä–∞–≤–∏–ª–∞: ' + Object.keys(customDesignSystemJson.rules).join(', ') + '\n';
          }
          
          designSystemContext += '–ò–°–ü–û–õ–¨–ó–£–ô –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫–∞—Å—Ç–æ–º–Ω–æ–π –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º—ã –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.\n';
          debugLog('AI Design Lint: –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–∞—Å—Ç–æ–º–Ω–∞—è –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–∞ –≤ –ø—Ä–æ–º–ø—Ç (—Å–æ–∫—Ä–∞—â—ë–Ω–Ω–∞—è)');
        }
        
        // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ (—á—Ç–æ–±—ã –Ω–µ –ø—Ä–µ–≤—ã—Å–∏—Ç—å –ª–∏–º–∏—Ç —Ç–æ–∫–µ–Ω–æ–≤)
        const MAX_ELEMENTS = 20;
        let elementsToAnalyze = designInfo.elements;
        let isLimited = false;
        
        if (elementsToAnalyze.length > MAX_ELEMENTS) {
          isLimited = true;
          elementsToAnalyze = elementsToAnalyze.slice(0, MAX_ELEMENTS);
          debugLog(`AI Design Lint: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–æ –¥–æ ${MAX_ELEMENTS} —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–∑ ${designInfo.elements.length}`);
          
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
          if (aiAnalysisResult) {
            const warning = document.createElement('div');
            warning.style.cssText = 'background: #FF9800; color: #000; padding: 8px 12px; border-radius: 8px; margin-bottom: 12px; font-size: 11px; line-height: 1.4;';
            warning.innerHTML = `‚ö†Ô∏è <strong>–í–Ω–∏–º–∞–Ω–∏–µ:</strong> –í—ã–±—Ä–∞–Ω–æ ${designInfo.elements.length} —ç–ª–µ–º–µ–Ω—Ç–æ–≤. –î–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤ –±—É–¥—É—Ç –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ ${MAX_ELEMENTS}. –î–ª—è –ø–æ–ª–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –º–µ–Ω—å—à–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤.`;
            aiAnalysisResult.insertBefore(warning, aiAnalysisResult.firstChild);
          }
        }
        
        // –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ (—É–±–∏—Ä–∞–µ–º –∏–∑–±—ã—Ç–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é)
        const optimizedElements = elementsToAnalyze.map(el => {
          const optimized = {
            id: el.id,
            name: el.name,
            type: el.type,
            width: el.width,
            height: el.height
          };
          
          // –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–ª—è
          if (el.fills && el.fills.length > 0) {
            optimized.fills = el.fills.map(f => ({
              type: f.type,
              color: f.color,
              isHardcoded: f.isHardcoded,
              variable: f.variable ? { name: f.variable.name } : undefined
            })).filter(f => f.variable || f.isHardcoded);
          }
          
          if (el.autoLayout) {
            optimized.autoLayout = {
              mode: el.autoLayout.mode,
              paddingLeft: el.autoLayout.paddingLeft,
              paddingRight: el.autoLayout.paddingRight,
              paddingTop: el.autoLayout.paddingTop,
              paddingBottom: el.autoLayout.paddingBottom,
              itemSpacing: el.autoLayout.itemSpacing,
              hasNonStandardSpacing: el.autoLayout.hasNonStandardSpacing,
              nonStandardValues: el.autoLayout.nonStandardValues
            };
          }
          
          if (el.fontSize) {
            optimized.fontSize = el.fontSize;
            optimized.fontSizeHardcoded = el.fontSizeHardcoded;
            if (el.fontSizeVariable) {
              optimized.fontSizeVariable = { name: el.fontSizeVariable.name };
            }
          }
          
          if (el.cornerRadius !== undefined) {
            optimized.cornerRadius = el.cornerRadius;
            optimized.nonStandardCornerRadius = el.nonStandardCornerRadius;
          }
          
          // –î–æ–±–∞–≤–ª—è–µ–º –¥–æ—á–µ—Ä–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã, –Ω–æ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π —É—Ä–æ–≤–µ–Ω—å
          if (el.children && el.children.length > 0) {
            optimized.childrenCount = el.children.length;
            optimized.childrenTypes = el.childrenTypes;
          }
          
          return optimized;
        });
        
        // –§–æ—Ä–º–∏—Ä—É–µ–º –ø—Ä–æ–º–ø—Ç –¥–ª—è AI
        const limitNote = isLimited ? `\n\n–í–ù–ò–ú–ê–ù–ò–ï: –ê–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –ø–µ—Ä–≤—ã–µ ${MAX_ELEMENTS} —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–∑ ${designInfo.elements.length}. –î–ª—è –ø–æ–ª–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –º–µ–Ω—å—à–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤.` : '';
        
        const systemPrompt = `–¢—ã - AI-–ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ Figma –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—â–∏–π—Å—è –Ω–∞ –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–µ Orbita, –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∏ –∫–∞—á–µ—Å—Ç–≤–µ –∫–æ–¥–∞. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ - –ø—Ä–æ–≤–µ—Å—Ç–∏ –≥–ª—É–±–æ–∫–∏–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞—É–¥–∏—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.

–ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –ö–û–ú–ü–û–ù–ï–ù–¢–ï (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞):
${JSON.stringify(optimizedElements, null, 2)}${limitNote}

${designSystemContext}

–í–ê–ñ–ù–û: –í –¥–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –∏–º–µ–µ—Ç —Å–≤–æ–π ID (–ø–æ–ª–µ "id"). –ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º—ã –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û —É–∫–∞–∑—ã–≤–∞–π ID —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ [ID:element_id].

–¢–†–ï–ë–û–í–ê–ù–ò–Ø –ö –ê–ù–ê–õ–ò–ó–£:

1. **–ö–û–ù–ö–†–ï–¢–ù–´–ï –ü–†–û–ë–õ–ï–ú–´** - –ù–∞–π–¥–∏ —Ä–µ–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –≤ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
   - –ñ–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (hard-coded values) –≤–º–µ—Å—Ç–æ —Ç–æ–∫–µ–Ω–æ–≤
     * –ü—Ä–æ–≤–µ—Ä—å fills - –µ—Å–ª–∏ –Ω–µ—Ç –ø–æ–ª—è "variable", –∑–Ω–∞—á–∏—Ç —Ü–≤–µ—Ç hard-coded
     * –ü—Ä–æ–≤–µ—Ä—å autoLayout - –µ—Å–ª–∏ –µ—Å—Ç—å "hasNonStandardSpacing: true" –∏ "nonStandardValues", —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞
     * –ü—Ä–æ–≤–µ—Ä—å "fontSizeHardcoded: true" - –∑–Ω–∞—á–∏—Ç —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–∫–µ–Ω
   - –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ä–∞–∑–º–µ—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç—Å—Ç—É–ø—ã 7px –≤–º–µ—Å—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π)
   - –ü—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–Ω—Ç—Ä–∞—Å—Ç–æ–º —Ü–≤–µ—Ç–æ–≤ (–ø—Ä–æ–≤–µ—Ä—å RGB –∑–Ω–∞—á–µ–Ω–∏—è –≤ fills)
   - –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã —à—Ä–∏—Ñ—Ç–æ–≤
   - –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (hover, disabled, etc)

2. **ACCESSIBILITY AUDIT**:
   - –ü—Ä–æ–≤–µ—Ä—å –∫–æ–Ω—Ç—Ä–∞—Å—Ç —Ü–≤–µ—Ç–æ–≤ (–∏—Å–ø–æ–ª—å–∑—É–π —Ñ–æ—Ä–º—É–ª—É WCAG: –∫–æ–Ω—Ç—Ä–∞—Å—Ç = (L1 + 0.05) / (L2 + 0.05), –≥–¥–µ L = 0.2126*R + 0.7152*G + 0.0722*B)
   - –ü—Ä–æ–≤–µ—Ä—å —Ä–∞–∑–º–µ—Ä—ã –¥–ª—è touch targets (–º–∏–Ω–∏–º—É–º 44x44px –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤)
   - –ü—Ä–æ–≤–µ—Ä—å —á–∏—Ç–∞–µ–º–æ—Å—Ç—å —Ç–µ–∫—Å—Ç–∞ (fontSize –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å >= 12px –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞)

3. **DESIGN TOKENS**:
   - –£–∫–∞–∂–∏, –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–∏—â–∏ "isHardcoded: true", "fontSizeHardcoded: true", "hasNonStandardSpacing: true")
   - –ü—Ä–µ–¥–ª–æ–∂–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –∏–∑ —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º—ã –≤—ã—à–µ
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ hard-coded –∑–Ω–∞—á–µ–Ω–∏—è —É–∫–∞–∂–∏ ID —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ [ID:element_id]

4. **COMPONENT STRUCTURE**:
   - –ü—Ä–æ–≤–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å Auto Layout –Ω–∞—Å—Ç—Ä–æ–µ–∫ (mode, spacing, padding)
   - –ü—Ä–æ–≤–µ—Ä—å –∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Å–ª–æ–µ–≤ (name)
   - –ü—Ä–æ–≤–µ—Ä—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º—ã
   - –ü—Ä–æ–≤–µ—Ä—å cornerRadius –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º (–∏—â–∏ "nonStandardCornerRadius: true")

5. **CODE-READINESS SCORE**:
   - –û—Ü–µ–Ω–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∫ –ø–µ—Ä–µ–¥–∞—á–µ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É (0-100%)
   - –£–∫–∞–∂–∏, —á—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –¥–ª—è 100%

–§–û–†–ú–ê–¢ –û–¢–í–ï–¢–ê:
–î–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø–æ–ª—å–∑—É–π —Ñ–æ—Ä–º–∞—Ç:
[ID:element_id] –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
–ì–¥–µ element_id - —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è "id" –ø—Ä–æ–±–ª–µ–º–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞

–ü—Ä–∏–º–µ—Ä—ã:
- ‚ùå –ù–ï: "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä—ã —à—Ä–∏—Ñ—Ç–∞"
- ‚úÖ –î–ê: "[ID:123:456] –¢–µ–∫—Å—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç fontSize: 13px (hard-coded), —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ç–æ–∫–µ–Ω text-sm (14px)"
- ‚úÖ –î–ê: "[ID:789:012] –û—Ç—Å—Ç—É–ø paddingLeft: 7px –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º, –∏—Å–ø–æ–ª—å–∑—É–π 8px (spacing-2)"
- ‚úÖ –î–ê: "[ID:345:678] –¶–≤–µ—Ç fill: rgb(0.2, 0.3, 0.4) hard-coded, –∏—Å–ø–æ–ª—å–∑—É–π —Ç–æ–∫–µ–Ω color-primary-500"

–í –∫–æ–Ω—Ü–µ –¥–∞–π CODE-READINESS SCORE –≤ —Ñ–æ—Ä–º–∞—Ç–µ: "Score: XX%" –≥–¥–µ XX - —á–∏—Å–ª–æ –æ—Ç 0 –¥–æ 100.

–ù–∞—á–Ω–∏ —Å —Å–∞–º—ã—Ö –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º.`;

        const userMessage = userPrompt || '–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –¥–∏–∑–∞–π–Ω –∏ –¥–∞–π –¥–µ—Ç–∞–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º ID –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤.';
        
        const response = await fetch('https://api.eliza.yandex.net/openai/v1/chat/completions', {
          method: 'POST',
          headers: {
            'Authorization': `OAuth ${token}`,
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            model: 'gpt-4o-mini',
            messages: [
              {
                role: 'system',
                content: systemPrompt
              },
              {
                role: 'user',
                content: userMessage
              }
            ],
            temperature: 0.7,
            max_tokens: 2000
          })
        });
        
        if (!response.ok) {
          const errorText = await response.text();
          console.error('AI Design Lint: –û—à–∏–±–∫–∞ API:', response.status, errorText);
          throw new Error(`–û—à–∏–±–∫–∞ API (${response.status}): ${errorText}`);
        }
        
        const data = await response.json();
        debugLog('AI Design Lint: –ü–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç –æ—Ç API:', data);
        
        // Yandex Eliza API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –ø–æ–ª–µ response
        let actualResponse = data;
        if (data.response) {
          actualResponse = data.response;
          debugLog('AI Design Lint: –ò–∑–≤–ª–µ—á–µ–Ω response:', actualResponse);
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç OpenAI (choices)
        if (actualResponse.choices && actualResponse.choices.length > 0) {
          const choice = actualResponse.choices[0];
          const content = choice.message?.content || choice.text;
          if (content) {
            debugLog('AI Design Lint: –£—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω –∫–æ–Ω—Ç–µ–Ω—Ç:', content.substring(0, 100) + '...');
            return {
              success: true,
              analysis: content
            };
          }
        }
        
        // –ï—Å–ª–∏ —ç—Ç–æ –¥—Ä—É–≥–æ–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞
        if (actualResponse.result) {
          return {
            success: true,
            analysis: actualResponse.result
          };
        }
        
        // –ï—Å–ª–∏ –æ—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ–∫—Å—Ç –Ω–∞–ø—Ä—è–º—É—é
        if (actualResponse.content || actualResponse.text) {
          return {
            success: true,
            analysis: actualResponse.content || actualResponse.text
          };
        }
        
        console.error('AI Design Lint: –ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞:', actualResponse);
        throw new Error(`–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç –æ—Ç API. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.`);
        
      } catch (error) {
        console.error('AI Design Lint: –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –∫ API:', error);
        return {
          success: false,
          error: error.message
        };
      }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ AI-–∞–Ω–∞–ª–∏–∑–∞
    function displayAIAnalysis(analysis, designInfo) {
      if (!aiAnalysisResult) return;
      
      aiAnalysisResult.style.display = 'block';
      aiAnalysisResult.innerHTML = '';
      
      // –ü–∞—Ä—Å–∏–º –æ—Ç–≤–µ—Ç AI –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
      const parsedAnalysis = parseAIAnalysis(analysis, designInfo);
      
      // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –æ—Ü–µ–Ω–∫—É –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
      if (parsedAnalysis.score !== null) {
        const scoreSection = document.createElement('div');
        scoreSection.style.cssText = 'background: #2A2A32; border-radius: 8px; padding: 12px; margin-bottom: 16px; display: flex; justify-content: space-between; align-items: center;';
        
        const scoreLabel = document.createElement('div');
        scoreLabel.style.cssText = 'font-size: 13px; font-weight: 600; color: #FFFFFF;';
        scoreLabel.textContent = 'üèÜ Code Readiness Score';
        
        const scoreValue = document.createElement('div');
        scoreValue.style.cssText = `font-size: 18px; font-weight: 700; color: ${parsedAnalysis.score >= 80 ? '#4CAF50' : parsedAnalysis.score >= 60 ? '#FF9800' : '#F02D2D'};`;
        scoreValue.textContent = `${parsedAnalysis.score}%`;
        
        scoreSection.appendChild(scoreLabel);
        scoreSection.appendChild(scoreValue);
        aiAnalysisResult.appendChild(scoreSection);
      }
      
      // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø—Ä–æ–±–ª–µ–º—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
      if (parsedAnalysis.issues.length > 0) {
        const issuesTitle = document.createElement('h4');
        issuesTitle.style.cssText = 'font-size: 13px; font-weight: 600; margin: 16px 0 12px 0; color: #F86025;';
        issuesTitle.textContent = '‚ö†Ô∏è –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã';
        aiAnalysisResult.appendChild(issuesTitle);
        
        parsedAnalysis.issues.forEach(issue => {
          const issueCard = createIssueCard(issue, designInfo);
          aiAnalysisResult.appendChild(issueCard);
        });
      }
      
      // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –∞–Ω–∞–ª–∏–∑–∞
      const fullAnalysisToggle = document.createElement('div');
      fullAnalysisToggle.style.cssText = 'margin-top: 16px; cursor: pointer; color: #F86025; font-size: 12px; font-weight: 600;';
      fullAnalysisToggle.textContent = '‚ñº –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑';
      
      const fullAnalysisContent = document.createElement('div');
      fullAnalysisContent.style.cssText = 'display: none; margin-top: 8px; padding: 12px; background: #2A2A32; border-radius: 8px; font-size: 12px; line-height: 1.6; white-space: pre-wrap;';
      fullAnalysisContent.textContent = analysis;
      
      fullAnalysisToggle.addEventListener('click', () => {
        const isVisible = fullAnalysisContent.style.display === 'block';
        fullAnalysisContent.style.display = isVisible ? 'none' : 'block';
        fullAnalysisToggle.textContent = isVisible ? '‚ñº –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑' : '‚ñ≤ –°–∫—Ä—ã—Ç—å –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑';
      });
      
      aiAnalysisResult.appendChild(fullAnalysisToggle);
      aiAnalysisResult.appendChild(fullAnalysisContent);
      
      // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
      const copyButton = document.createElement('button');
      copyButton.className = 'secondary-button';
      copyButton.textContent = '–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã';
      copyButton.style.width = '100%';
      copyButton.style.marginTop = '12px';
      copyButton.addEventListener('click', () => {
        navigator.clipboard.writeText(analysis)
          .then(() => {
            copyButton.textContent = '‚úì –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
            setTimeout(() => {
              copyButton.textContent = '–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã';
            }, 2000);
          })
          .catch(error => {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞:', error);
            copyButton.textContent = '–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è';
            setTimeout(() => {
              copyButton.textContent = '–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã';
            }, 2000);
          });
      });
      aiAnalysisResult.appendChild(copyButton);
    }
    
    // –§—É–Ω–∫—Ü–∏—è –ø–∞—Ä—Å–∏–Ω–≥–∞ AI-–∞–Ω–∞–ª–∏–∑–∞ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    function parseAIAnalysis(analysis, designInfo) {
      const result = {
        score: null,
        issues: []
      };
      
      // –ò–∑–≤–ª–µ–∫–∞–µ–º –æ—Ü–µ–Ω–∫—É (–∏—â–µ–º —á–∏—Å–ª–∞ —Å % –∏–ª–∏ "score: XX")
      const scoreMatch = analysis.match(/(?:score|–≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å|readiness)[:\s]*(\d+)%?/i);
      if (scoreMatch) {
        result.score = parseInt(scoreMatch[1]);
      }
      
      // –ò–∑–≤–ª–µ–∫–∞–µ–º –ø—Ä–æ–±–ª–µ–º—ã (–∏—â–µ–º –º–∞—Ä–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏ –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è)
      const lines = analysis.split('\n');
      let currentCategory = 'general';
      
      lines.forEach(line => {
        line = line.trim();
        
        // –ò–∑–≤–ª–µ–∫–∞–µ–º element ID –∏–∑ —Ñ–æ—Ä–º–∞—Ç–∞ [ID:element_id]
        let extractedElementId = null;
        const idMatch = line.match(/\[ID:([^\]]+)\]/);
        if (idMatch) {
          extractedElementId = idMatch[1];
          // –£–¥–∞–ª—è–µ–º ID –∏–∑ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
          line = line.replace(/\[ID:[^\]]+\]\s*/, '');
          debugLog('AI Design Lint: –ù–∞–π–¥–µ–Ω ID —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –æ—Ç–≤–µ—Ç–µ AI:', extractedElementId);
        }
        
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é
        if (line.match(/hard.?coded|–∂–µ—Å—Ç–∫–æ.?–∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω/i)) {
          currentCategory = 'hardcoded';
        } else if (line.match(/token|—Ç–æ–∫–µ–Ω/i)) {
          currentCategory = 'tokens';
        } else if (line.match(/spacing|–æ—Ç—Å—Ç—É–ø/i)) {
          currentCategory = 'spacing';
        } else if (line.match(/color|—Ü–≤–µ—Ç|contrast|–∫–æ–Ω—Ç—Ä–∞—Å—Ç/i)) {
          currentCategory = 'colors';
        } else if (line.match(/accessibility|–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å/i)) {
          currentCategory = 'accessibility';
        }
        
        // –ò–∑–≤–ª–µ–∫–∞–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
        if (line.match(/^[\-\*‚Ä¢]\s+/) || line.match(/^\d+\.\s+/)) {
          const issueText = line.replace(/^[\-\*‚Ä¢\d\.]\s+/, '');
          if (issueText.length > 10) {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–π ID –∏–∑ —Ñ–æ—Ä–º–∞—Ç–∞ [ID:xxx] –∏–ª–∏ –∏—â–µ–º —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ —Ç–µ–∫—Å—Ç–µ –ø—Ä–æ–±–ª–µ–º—ã
            let elementId = extractedElementId;
            let elementName = null;
            
            // –ï—Å–ª–∏ ID –Ω–µ –∏–∑–≤–ª–µ—á–µ–Ω, –∏—â–µ–º –∏–º–µ–Ω–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –∫–∞–≤—ã—á–∫–∞—Ö –∏–ª–∏ –ø–æ—Å–ª–µ —Å–ª–æ–≤ "—ç–ª–µ–º–µ–Ω—Ç", "—Å–ª–æ–π", "–∫–æ–º–ø–æ–Ω–µ–Ω—Ç"
            if (!elementId) {
            const namePatterns = [
              /"([^"]+)"/,           // "–∏–º—è"
              /¬´([^¬ª]+)¬ª/,           // ¬´–∏–º—è¬ª
              /—ç–ª–µ–º–µ–Ω—Ç[:\s]+([^\s,\.]+)/i,
              /—Å–ª–æ–π[:\s]+([^\s,\.]+)/i,
              /–∫–æ–º–ø–æ–Ω–µ–Ω—Ç[:\s]+([^\s,\.]+)/i,
              /layer[:\s]+([^\s,\.]+)/i,
              /component[:\s]+([^\s,\.]+)/i
            ];
            
            for (const pattern of namePatterns) {
              const match = issueText.match(pattern);
              if (match && designInfo.allNodes) {
                const mentionedName = match[1].trim();
                // –ò—â–µ–º —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –∏–ª–∏ —á–∞—Å—Ç–∏—á–Ω–æ–µ (–µ—Å–ª–∏ –∏–º—è —Å–æ–¥–µ—Ä–∂–∏—Ç —É–ø–æ–º–∏–Ω–∞–µ–º–æ–µ)
                const foundNode = designInfo.allNodes.find(n => 
                  n.name === mentionedName || 
                  n.name.toLowerCase().includes(mentionedName.toLowerCase()) ||
                  mentionedName.toLowerCase().includes(n.name.toLowerCase())
                );
                if (foundNode) {
                  elementId = foundNode.id;
                  elementName = foundNode.name;
                  debugLog(`AI Design Lint: –ù–∞–π–¥–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç "${elementName}" (${elementId})`);
                  break;
                  }
                }
              }
            }
            
            // –ï—Å–ª–∏ —É –Ω–∞—Å –µ—Å—Ç—å ID, –ø–æ–ø—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ –∏–º—è —ç–ª–µ–º–µ–Ω—Ç–∞
            if (elementId && !elementName && designInfo.allNodes) {
              const foundNode = designInfo.allNodes.find(n => n.id === elementId);
              if (foundNode) {
                elementName = foundNode.name;
                debugLog(`AI Design Lint: –ù–∞–π–¥–µ–Ω–æ –∏–º—è –¥–ª—è ID ${elementId}: "${elementName}"`);
              }
            }
            
            result.issues.push({
              category: currentCategory,
              text: issueText,
              severity: line.includes('–∫—Ä–∏—Ç–∏—á') || line.includes('critical') ? 'high' : 'medium',
              elementId: elementId,
              elementName: elementName
            });
          }
        }
      });
      
      // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã, —Å–æ–∑–¥–∞–µ–º –∏–∑ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–∏–∑–∞–π–Ω–∞
      if (result.issues.length === 0 && designInfo.elements) {
        designInfo.elements.forEach(element => {
          // –ü—Ä–æ–≤–µ—Ä—è–µ–º hard-coded —Ü–≤–µ—Ç–∞
          if (element.fills) {
            element.fills.forEach(fill => {
              if (fill.isHardcoded && fill.color) {
                result.issues.push({
                  category: 'hardcoded',
                  text: `–≠–ª–µ–º–µ–Ω—Ç "${element.name}" –∏—Å–ø–æ–ª—å–∑—É–µ—Ç hard-coded —Ü–≤–µ—Ç –≤–º–µ—Å—Ç–æ —Ç–æ–∫–µ–Ω–∞`,
                  severity: 'medium',
                  elementId: element.id,
                  elementName: element.name
                });
              }
            });
          }
          
          // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã
          if (element.autoLayout && element.autoLayout.hasNonStandardSpacing) {
            result.issues.push({
              category: 'spacing',
              text: `–≠–ª–µ–º–µ–Ω—Ç "${element.name}" –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã: ${element.autoLayout.nonStandardValues.join(', ')}px`,
              severity: 'medium',
              elementId: element.id,
              elementName: element.name
            });
          }
          
          // –ü—Ä–æ–≤–µ—Ä—è–µ–º hard-coded —Ä–∞–∑–º–µ—Ä—ã —à—Ä–∏—Ñ—Ç–∞
          if (element.fontSizeHardcoded) {
            result.issues.push({
              category: 'hardcoded',
              text: `–¢–µ–∫—Å—Ç "${element.name}" –∏—Å–ø–æ–ª—å–∑—É–µ—Ç hard-coded —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞: ${element.fontSize}px`,
              severity: 'medium',
              elementId: element.id,
              elementName: element.name
            });
          }
        });
      }
      
      return result;
    }
    
    // –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–æ–±–ª–µ–º—ã
    function createIssueCard(issue, designInfo) {
      const card = document.createElement('div');
      card.style.cssText = 'background: #44444C; border-radius: 8px; padding: 10px 12px; margin-bottom: 8px; border-left: 3px solid ' + 
        (issue.severity === 'high' ? '#F02D2D' : '#FF9800');
      
      const header = document.createElement('div');
      header.style.cssText = 'display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 6px;';
      
      const categoryBadge = document.createElement('span');
      categoryBadge.style.cssText = 'font-size: 10px; font-weight: 600; padding: 2px 6px; border-radius: 4px; background: #2A2A32; color: #F86025; text-transform: uppercase;';
      categoryBadge.textContent = getCategoryLabel(issue.category);
      
      header.appendChild(categoryBadge);
      
      // –ï—Å–ª–∏ –µ—Å—Ç—å elementId, –¥–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –ø–µ—Ä–µ—Ö–æ–¥–∞
      if (issue.elementId) {
        const focusButton = document.createElement('button');
        focusButton.style.cssText = 'background: #505059; color: white; border: none; border-radius: 6px; padding: 4px 8px; font-size: 11px; cursor: pointer; font-weight: 500;';
        focusButton.textContent = '‚Üí –ü–µ—Ä–µ–π—Ç–∏';
        focusButton.addEventListener('click', () => {
          parent.postMessage({
            pluginMessage: {
              type: 'focus-node',
              nodeId: issue.elementId
            }
          }, '*');
        });
        header.appendChild(focusButton);
      }
      
      card.appendChild(header);
      
      const text = document.createElement('div');
      text.style.cssText = 'font-size: 12px; line-height: 1.5; color: #FFFFFF;';
      text.textContent = issue.text;
      card.appendChild(text);
      
      return card;
    }
    
    // –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –º–µ—Ç–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    function getCategoryLabel(category) {
      const labels = {
        'hardcoded': 'üîß Hard-coded',
        'tokens': 'üé® Tokens',
        'spacing': 'üìè Spacing',
        'colors': 'üé® Colors',
        'accessibility': '‚ôø A11y',
        'general': 'üìã General'
      };
      return labels[category] || 'üìã General';
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ UI –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞
    function setupUIMode(mode) {
      const body = document.body;
      const mainFunctionality = document.querySelectorAll('.button-container, #settings-dropdown, .content-container');
      const nodeIdSection = document.getElementById('node-id-section');
      const svgExportSection = document.getElementById('svg-export-section');
      const aiDesignLintSection = document.getElementById('ai-design-lint-section');
      const dsvSection = document.getElementById('design-system-validator-section');
      const headerTitle = document.querySelector('h1');
      const errorBadge = document.getElementById('error-badge');
      
      // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ —Ä–µ–∂–∏–º—ã
      body.classList.remove('node-id-mode', 'svg-export-mode', 'ai-design-lint-mode', 'design-system-validator-mode');
      
      if (mode === 'node-id-inspector') {
        // –†–µ–∂–∏–º Node ID Inspector
        body.classList.add('node-id-mode');
        
        // –°–∫—Ä—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
        mainFunctionality.forEach(el => {
          if (el) el.style.display = 'none';
        });
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º Node ID Inspector
        if (nodeIdSection) {
          nodeIdSection.style.display = 'block';
          nodeIdSection.style.marginBottom = '0';
        }
        
        // –°–∫—Ä—ã–≤–∞–µ–º SVG Export Section
        if (svgExportSection) {
          svgExportSection.style.display = 'none';
        }
        
        // –ú–µ–Ω—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
        if (headerTitle) {
          headerTitle.innerHTML = 'Orbita DS&nbsp;&nbsp;‚ú¶&nbsp;&nbsp;Node ID Inspector';
        }
        
        // –°–∫—Ä—ã–≤–∞–µ–º badge —Å –æ—à–∏–±–∫–∞–º–∏
        if (errorBadge) {
          errorBadge.style.display = 'none';
        }
      } else if (mode === 'svg-export') {
        // –†–µ–∂–∏–º SVG Export
        body.classList.add('svg-export-mode');
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É JSZip –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ —Ä–µ–∂–∏–º
        debugLog('SVG Export: –ü–µ—Ä–µ—Ö–æ–¥ –≤ —Ä–µ–∂–∏–º —ç–∫—Å–ø–æ—Ä—Ç–∞, JSZip –¥–æ—Å—Ç—É–ø–µ–Ω:', typeof JSZip !== 'undefined');
        
        // –°–∫—Ä—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
        mainFunctionality.forEach(el => {
          if (el) el.style.display = 'none';
        });
        
        // –°–∫—Ä—ã–≤–∞–µ–º Node ID Inspector
        if (nodeIdSection) {
          nodeIdSection.style.display = 'none';
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º SVG Export Section
        if (svgExportSection) {
          svgExportSection.style.display = 'block';
          svgExportSection.style.marginBottom = '0';
        }
        
        // –ú–µ–Ω—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
        if (headerTitle) {
          headerTitle.innerHTML = 'Orbita DS&nbsp;&nbsp;‚ú¶&nbsp;&nbsp;SVG Export';
        }
        
        // –°–∫—Ä—ã–≤–∞–µ–º badge —Å –æ—à–∏–±–∫–∞–º–∏
        if (errorBadge) {
          errorBadge.style.display = 'none';
        }
      } else if (mode === 'ai-design-lint') {
        // –†–µ–∂–∏–º AI Design Lint
        body.classList.add('ai-design-lint-mode');
        
        // –°–∫—Ä—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
        mainFunctionality.forEach(el => {
          if (el) el.style.display = 'none';
        });
        
        // –°–∫—Ä—ã–≤–∞–µ–º Node ID Inspector –∏ SVG Export
        if (nodeIdSection) {
          nodeIdSection.style.display = 'none';
        }
        
        if (svgExportSection) {
          svgExportSection.style.display = 'none';
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º AI Design Lint Section
        if (aiDesignLintSection) {
          aiDesignLintSection.style.display = 'block';
          aiDesignLintSection.style.marginBottom = '0';
        }
        
        // –ú–µ–Ω—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
        if (headerTitle) {
          headerTitle.innerHTML = 'Orbita DS&nbsp;&nbsp;‚ú¶&nbsp;&nbsp;AI Design Lint';
        }
        
        // –°–∫—Ä—ã–≤–∞–µ–º badge —Å –æ—à–∏–±–∫–∞–º–∏
        if (errorBadge) {
          errorBadge.style.display = 'none';
        }
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω –∏ JSON
        loadSavedToken();
        loadCustomDesignSystem();
      } else if (mode === 'design-system-validator') {
        // –†–µ–∂–∏–º Design System Validator
        body.classList.add('design-system-validator-mode');
        
        // –°–∫—Ä—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
        mainFunctionality.forEach(el => {
          if (el) el.style.display = 'none';
        });
        
        // –°–∫—Ä—ã–≤–∞–µ–º –¥—Ä—É–≥–∏–µ —Å–µ–∫—Ü–∏–∏
        if (nodeIdSection) {
          nodeIdSection.style.display = 'none';
        }
        
        if (svgExportSection) {
          svgExportSection.style.display = 'none';
        }
        
        if (aiDesignLintSection) {
          aiDesignLintSection.style.display = 'none';
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º Design System Validator Section
        if (dsvSection) {
          dsvSection.style.display = 'block';
          dsvSection.style.marginBottom = '0';
        }
        
        // –ú–µ–Ω—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
        if (headerTitle) {
          headerTitle.innerHTML = 'Orbita DS&nbsp;&nbsp;‚ú¶&nbsp;&nbsp;Design System Validator';
        }
        
        // –°–∫—Ä—ã–≤–∞–µ–º badge —Å –æ—à–∏–±–∫–∞–º–∏
        if (errorBadge) {
          errorBadge.style.display = 'none';
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è Design System Validator
        initDesignSystemValidator();
      } else {
        // –†–µ–∂–∏–º –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∫–æ–Ω–æ–∫ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
        mainFunctionality.forEach(el => {
          if (el) el.style.display = '';
        });
        
        // –°–∫—Ä—ã–≤–∞–µ–º Node ID Inspector, SVG Export, AI Design Lint –∏ Design System Validator (—á–µ—Ä–µ–∑ CSS)
        if (nodeIdSection) {
          nodeIdSection.style.display = 'none';
        }
        
        if (svgExportSection) {
          svgExportSection.style.display = 'none';
        }
        
        if (aiDesignLintSection) {
          aiDesignLintSection.style.display = 'none';
        }
        
        if (dsvSection) {
          dsvSection.style.display = 'none';
        }
        
        // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫
        if (headerTitle) {
          headerTitle.innerHTML = 'Orbita DS&nbsp;&nbsp;‚ú¶&nbsp;&nbsp;Tools';
        }
      }
    }
    
    // Design System Validator - –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    let dsvValidationMode = 'local'; // local, remote, all
    let dsvCurrentReport = null;
    
    // –§—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Design System Validator
    function initDesignSystemValidator() {
      // –ü–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã
      const settingsButton = document.getElementById('dsv-settings-button');
      const settingsPanel = document.getElementById('dsv-settings-panel');
      const validateButtonMain = document.getElementById('dsv-validate-button-main');
      const modeButtons = document.querySelectorAll('.dsv-mode-button');
      const validateButton = document.getElementById('dsv-validate-button');
      const exportButton = document.getElementById('dsv-export-report-button');
      
      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
      if (settingsButton && settingsPanel) {
        settingsButton.addEventListener('click', () => {
          const isHidden = settingsPanel.style.display === 'none';
          settingsPanel.style.display = isHidden ? 'block' : 'none';
          settingsButton.textContent = isHidden ? '‚ùå –ó–∞–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏' : '‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏';
        });
      }
      
      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≥–ª–∞–≤–Ω–æ–π –∫–Ω–æ–ø–∫–∏ "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å"
      if (validateButtonMain) {
        validateButtonMain.addEventListener('click', () => {
          runDSVValidation();
        });
      }
      
      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤—ã–±–æ—Ä–∞ —Ä–µ–∂–∏–º–∞
      modeButtons.forEach(button => {
        button.addEventListener('click', () => {
          // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –∫–Ω–æ–ø–æ–∫
          modeButtons.forEach(btn => {
            btn.style.background = '#2A2A32';
            btn.style.border = '1px solid #505059';
          });
          button.style.background = '#F86025';
          button.style.border = 'none';
          
          // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º
          dsvValidationMode = button.dataset.mode;
          debugLog('Design System Validator: –í—ã–±—Ä–∞–Ω —Ä–µ–∂–∏–º', dsvValidationMode);
        });
      });
      
      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ (–æ—Å—Ç–∞–≤–ª—è–µ–º –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
      if (validateButton) {
        validateButton.addEventListener('click', () => {
          runDSVValidation();
        });
      }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ DSV
    function runDSVValidation() {
      debugLog('Design System Validator: –ó–∞–ø—É—Å–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏, —Ä–µ–∂–∏–º:', dsvValidationMode);
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
      const loadingIndicator = document.getElementById('dsv-loading-indicator');
      const resultsPanel = document.getElementById('dsv-results-panel');
      
      if (loadingIndicator) loadingIndicator.style.display = 'block';
      if (resultsPanel) resultsPanel.style.display = 'none';
      
      // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
      const progressCount = document.getElementById('dsv-progress-count');
      if (progressCount) progressCount.textContent = '0';
      
      // –ü–æ–ª—É—á–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
      const skipInstancesCheckbox = document.getElementById('dsv-skip-instances');
      const skipInstances = skipInstancesCheckbox ? skipInstancesCheckbox.checked : false;
      
      // –°–æ–±–∏—Ä–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º—ã—Ö —Å–≤–æ–π—Å—Ç–≤
      const propertiesToCheck = {
        fills: document.getElementById('dsv-check-fills')?.checked ?? true,
        strokes: document.getElementById('dsv-check-strokes')?.checked ?? true,
        cornerRadius: document.getElementById('dsv-check-corner-radius')?.checked ?? true,
        spacing: document.getElementById('dsv-check-spacing')?.checked ?? true,
        padding: document.getElementById('dsv-check-padding')?.checked ?? true,
        effects: document.getElementById('dsv-check-effects')?.checked ?? false,
        opacity: document.getElementById('dsv-check-opacity')?.checked ?? false,
        size: document.getElementById('dsv-check-size')?.checked ?? false
      };
      
      debugLog('DSV: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏:', propertiesToCheck);
      
      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ø–ª–∞–≥–∏–Ω —Å –æ–ø—Ü–∏—è–º–∏
      // –¢–æ–∫–µ–Ω—ã —Ç–µ–ø–µ—Ä—å —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ –ø–ª–∞–≥–∏–Ω–∞ (code.js)
      parent.postMessage({
        pluginMessage: {
          type: 'dsv-validate',
          mode: dsvValidationMode,
          options: {
            skipInstances: skipInstances,
            propertiesToCheck: propertiesToCheck
          }
        }
      }, '*');
    }
    
    // –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ DSV (–æ—Å—Ç–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏)
    (function continueInitDSV() {
      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –∏ –∑–∞–≥—Ä—É–∑–∫–∏ JSON —Å —Ç–æ–∫–µ–Ω–∞–º–∏
      const exportButton = document.getElementById('dsv-export-report-button');
      const exportTokensButton = document.getElementById('dsv-export-tokens-button');
      const exportStatus = document.getElementById('dsv-export-status');
      const exportStatusText = document.getElementById('dsv-export-status-text');
      const loadTokensJsonButton = document.getElementById('dsv-load-tokens-json-button');
      const clearTokensJsonButton = document.getElementById('dsv-clear-tokens-json-button');
      const tokensJsonFileInput = document.getElementById('dsv-tokens-json-file');
      const tokensJsonStatus = document.getElementById('dsv-tokens-json-status');
      const tokensJsonStatusText = document.getElementById('dsv-tokens-json-status-text');
      
      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —ç–∫—Å–ø–æ—Ä—Ç–∞ —Ç–æ–∫–µ–Ω–æ–≤
      if (exportTokensButton) {
        exportTokensButton.addEventListener('click', () => {
          debugLog('Design System Validator: –ó–∞–ø—Ä–æ—Å —ç–∫—Å–ø–æ—Ä—Ç–∞ —Ç–æ–∫–µ–Ω–æ–≤');
          
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏
          if (exportStatus) {
            exportStatus.style.display = 'block';
            exportStatusText.textContent = '‚è≥ –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é —Ç–æ–∫–µ–Ω—ã...';
            exportStatusText.style.color = '#AAAAAA';
          }
          
          // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ —ç–∫—Å–ø–æ—Ä—Ç
          parent.postMessage({
            pluginMessage: {
              type: 'dsv-export-tokens'
            }
          }, '*');
        });
      }
      
      if (loadTokensJsonButton && tokensJsonFileInput) {
        loadTokensJsonButton.addEventListener('click', () => {
          tokensJsonFileInput.click();
        });
        
        tokensJsonFileInput.addEventListener('change', (e) => {
          const file = e.target.files[0];
          if (!file) return;
          
          const reader = new FileReader();
          reader.onload = (event) => {
            try {
              const jsonData = JSON.parse(event.target.result);
              debugLog('Design System Validator: JSON –∑–∞–≥—Ä—É–∂–µ–Ω', jsonData);
              
              // –í–∞–ª–∏–¥–∞—Ü–∏—è JSON
              if (!jsonData.tokens || !Array.isArray(jsonData.tokens)) {
                throw new Error('JSON –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∞—Å—Å–∏–≤ "tokens"');
              }
              
              // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–æ–∫–µ–Ω—ã –≤ code.js –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è
              parent.postMessage({
                pluginMessage: {
                  type: 'dsv-save-tokens',
                  tokens: jsonData.tokens
                }
              }, '*');
              
              // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏
              if (tokensJsonStatus) {
                tokensJsonStatus.style.display = 'block';
                tokensJsonStatusText.textContent = '‚è≥ –ó–∞–≥—Ä—É–∂–∞—é —Ç–æ–∫–µ–Ω—ã...';
                tokensJsonStatusText.style.color = '#AAAAAA';
              }
              
              debugLog('Design System Validator: –¢–æ–∫–µ–Ω—ã –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ –ø–ª–∞–≥–∏–Ω');
            } catch (error) {
              debugError('Design System Validator: –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON', error);
              if (tokensJsonStatus) {
                tokensJsonStatus.style.display = 'block';
                tokensJsonStatusText.textContent = `‚ùå –û—à–∏–±–∫–∞: ${error.message}`;
                tokensJsonStatusText.style.color = '#F44336';
              }
            }
          };
          reader.readAsText(file);
        });
      }
      
      if (clearTokensJsonButton) {
        clearTokensJsonButton.addEventListener('click', () => {
          // –û—Ç–∫—Ä—ã–≤–∞–µ–º –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞ –¥–ª—è –∑–∞–º–µ–Ω—ã —Ç–æ–∫–µ–Ω–æ–≤
          if (tokensJsonFileInput) {
            tokensJsonFileInput.click();
          }
          
          debugLog('Design System Validator: –û—Ç–∫—Ä—ã—Ç –¥–∏–∞–ª–æ–≥ –∑–∞–º–µ–Ω—ã —Ç–æ–∫–µ–Ω–æ–≤');
        });
      }
      
      // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —É –ø–ª–∞–≥–∏–Ω–∞, –µ—Å—Ç—å –ª–∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã
      parent.postMessage({
        pluginMessage: {
          type: 'dsv-get-tokens-status'
        }
      }, '*');
      
      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–æ–∫–∞–∑–∞ —Ñ–æ—Ä–º–∞—Ç–∞ JSON
      const showJsonFormatLink = document.getElementById('dsv-show-json-format');
      if (showJsonFormatLink) {
        showJsonFormatLink.addEventListener('click', (e) => {
          e.preventDefault();
          
          const formatExample = `{
  "tokens": [
    {
      "name": "color/primary/500",
      "type": "COLOR",
      "value": "#F86025",
      "isRemote": true
    },
    {
      "name": "spacing/md",
      "type": "FLOAT",
      "value": 16,
      "isRemote": true
    }
  ]
}`;
          
          const message = `üìã –§–û–†–ú–ê–¢ JSON –î–õ–Ø –¢–û–ö–ï–ù–û–í\n\n` +
            `–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ:\n` +
            `‚Ä¢ name - –∏–º—è —Ç–æ–∫–µ–Ω–∞ (—Å—Ç—Ä–æ–∫–∞)\n\n` +
            `–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–æ–ª—è:\n` +
            `‚Ä¢ type - —Ç–∏–ø —Ç–æ–∫–µ–Ω–∞ (COLOR, FLOAT, STRING)\n` +
            `‚Ä¢ value - –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞\n` +
            `‚Ä¢ isRemote - —Ç–æ–∫–µ–Ω –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (true/false)\n` +
            `‚Ä¢ description - –æ–ø–∏—Å–∞–Ω–∏–µ\n\n` +
            `–ü—Ä–∏–º–µ—Ä:\n${formatExample}\n\n` +
            `üìñ –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: DSV_JSON_TOKENS_GUIDE.md\n` +
            `üì¶ –ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞: tokens-example.json\n` +
            `üîß –°–∫—Ä–∏–ø—Ç —ç–∫—Å–ø–æ—Ä—Ç–∞: export-tokens-script.js`;
          
          alert(message);
        });
      }
      
      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —á–µ–∫–±–æ–∫—Å–∞–º–∏ —Å–≤–æ–π—Å—Ç–≤
      const selectAllPropsBtn = document.getElementById('dsv-select-all-props');
      const selectNonePropsBtn = document.getElementById('dsv-select-none-props');
      const selectDefaultPropsBtn = document.getElementById('dsv-select-default-props');
      
      const propertyCheckboxes = [
        'dsv-check-fills',
        'dsv-check-strokes',
        'dsv-check-corner-radius',
        'dsv-check-spacing',
        'dsv-check-padding',
        'dsv-check-effects',
        'dsv-check-opacity',
        'dsv-check-size'
      ];
      
      // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω—ã: fills, strokes, corner-radius, spacing, padding
      const defaultEnabled = [
        'dsv-check-fills',
        'dsv-check-strokes',
        'dsv-check-corner-radius',
        'dsv-check-spacing',
        'dsv-check-padding'
      ];
      
      if (selectAllPropsBtn) {
        selectAllPropsBtn.addEventListener('click', () => {
          propertyCheckboxes.forEach(id => {
            const checkbox = document.getElementById(id);
            if (checkbox) checkbox.checked = true;
          });
          debugLog('DSV: –í—ã–±—Ä–∞–Ω—ã –≤—Å–µ —Å–≤–æ–π—Å—Ç–≤–∞');
        });
      }
      
      if (selectNonePropsBtn) {
        selectNonePropsBtn.addEventListener('click', () => {
          propertyCheckboxes.forEach(id => {
            const checkbox = document.getElementById(id);
            if (checkbox) checkbox.checked = false;
          });
          debugLog('DSV: –û—Ç–∫–ª—é—á–µ–Ω—ã –≤—Å–µ —Å–≤–æ–π—Å—Ç–≤–∞');
        });
      }
      
      if (selectDefaultPropsBtn) {
        selectDefaultPropsBtn.addEventListener('click', () => {
          propertyCheckboxes.forEach(id => {
            const checkbox = document.getElementById(id);
            if (checkbox) {
              checkbox.checked = defaultEnabled.includes(id);
            }
          });
          debugLog('DSV: –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —Å–≤–æ–π—Å—Ç–≤–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é');
        });
      }
      
      debugLog('Design System Validator: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
    })(); // –ó–∞–∫—Ä—ã—Ç–∏–µ continueInitDSV –∏ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –≤—ã–∑–æ–≤
    
    // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏
    function displayDSVResults(report) {
      debugLog('Design System Validator: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤', report);
      
      // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
      const loadingIndicator = document.getElementById('dsv-loading-indicator');
      if (loadingIndicator) loadingIndicator.style.display = 'none';
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
      const resultsPanel = document.getElementById('dsv-results-panel');
      if (resultsPanel) resultsPanel.style.display = 'block';
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ç—á—ë—Ç
      dsvCurrentReport = report;
      
      // –û–±–Ω–æ–≤–ª—è–µ–º —Å–≤–æ–¥–∫—É
      document.getElementById('dsv-total-nodes').textContent = report.totalNodes || 0;
      document.getElementById('dsv-total-issues').textContent = report.totalIssues || 0;
      document.getElementById('dsv-with-variables').textContent = report.nodesWithVariables || 0;
      document.getElementById('dsv-without-variables').textContent = report.nodesWithoutVariables || 0;
      
      // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–±–ª–µ–º
      const issuesSection = document.getElementById('dsv-issues-section');
      const issuesList = document.getElementById('dsv-issues-list');
      
      if (report.issues && report.issues.length > 0) {
        issuesSection.style.display = 'block';
        issuesList.innerHTML = '';
        
        report.issues.forEach((issue, index) => {
          const issueCard = createDSVIssueCard(issue, index);
          issuesList.appendChild(issueCard);
        });
      } else {
        issuesSection.style.display = 'none';
      }
    }
    
    // –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–æ–±–ª–µ–º—ã
    function createDSVIssueCard(issue, issueIndex) {
      const card = document.createElement('div');
      card.style.cssText = 'background: #44444C; border-radius: 8px; padding: 12px; margin-bottom: 8px; border-left: 3px solid ' + 
        (issue.severity === 'high' ? '#F44336' : issue.severity === 'medium' ? '#FF9800' : '#FFC107') + '; cursor: pointer; transition: all 0.2s;';
      
      card.addEventListener('mouseenter', () => {
        card.style.background = '#505059';
      });
      
      card.addEventListener('mouseleave', () => {
        card.style.background = '#44444C';
      });
      
      // –ö–ª–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —ç–ª–µ–º–µ–Ω—Ç—É
      const cardClickHandler = (e) => {
        // –ù–µ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –µ—Å–ª–∏ –∫–ª–∏–∫ –±—ã–ª –ø–æ –∫–Ω–æ–ø–∫–µ
        if (e.target.tagName === 'BUTTON' || e.target.closest('button')) {
          return;
        }
        if (issue.nodeId) {
          parent.postMessage({
            pluginMessage: {
              type: 'dsv-focus-node',
              nodeId: issue.nodeId
            }
          }, '*');
        }
      };
      card.addEventListener('click', cardClickHandler);
      
      // –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å —Ç–∏–ø–æ–º –ø—Ä–æ–±–ª–µ–º—ã
      const header = document.createElement('div');
      header.style.cssText = 'display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;';
      
      const typeLabel = document.createElement('span');
      typeLabel.style.cssText = 'font-size: 10px; font-weight: 600; padding: 3px 8px; border-radius: 4px; background: #2A2A32; color: #F86025; text-transform: uppercase;';
      typeLabel.textContent = issue.type || 'Issue';
      
      const nodeLabel = document.createElement('span');
      nodeLabel.style.cssText = 'font-size: 10px; color: #AAAAAA; font-family: "SF Mono", Monaco, monospace;';
      nodeLabel.textContent = '‚Üí ' + (issue.nodeName || 'Unknown');
      
      header.appendChild(typeLabel);
      header.appendChild(nodeLabel);
      
      // –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
      const description = document.createElement('div');
      description.style.cssText = 'font-size: 12px; line-height: 1.5; color: #FFFFFF; margin-bottom: 4px;';
      description.textContent = issue.description || 'No description';
      
      // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–µ—Å–ª–∏ –µ—Å—Ç—å)
      if (issue.property) {
        const propertyLabel = document.createElement('div');
        propertyLabel.style.cssText = 'font-size: 11px; color: #AAAAAA; margin-top: 4px;';
        propertyLabel.textContent = `Property: ${issue.property}`;
        description.appendChild(propertyLabel);
      }
      
      card.appendChild(header);
      card.appendChild(description);
      
      // –ï—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –µ–≥–æ
      if (issue.suggestedToken && issue.type === 'No Variable') {
        const tokenSuggestion = document.createElement('div');
        tokenSuggestion.style.cssText = 'margin-top: 8px; padding: 8px; background: rgba(76, 175, 80, 0.1); border-radius: 6px; border: 1px solid rgba(76, 175, 80, 0.3);';
        
        const suggestionLabel = document.createElement('div');
        suggestionLabel.style.cssText = 'font-size: 10px; color: #4CAF50; font-weight: 600; margin-bottom: 4px; text-transform: uppercase;';
        suggestionLabel.textContent = 'üí° –ù–∞–π–¥–µ–Ω –ø–æ–¥—Ö–æ–¥—è—â–∏–π —Ç–æ–∫–µ–Ω';
        
        const tokenInfo = document.createElement('div');
        tokenInfo.style.cssText = 'font-size: 11px; color: #FFFFFF; margin-bottom: 6px;';
        tokenInfo.textContent = `${issue.suggestedToken.name} = ${formatTokenValue(issue.suggestedToken.value)}`;
        
        const bindButton = document.createElement('button');
        bindButton.style.cssText = 'padding: 6px 12px; background: #4CAF50; color: white; border: none; border-radius: 4px; font-size: 11px; font-weight: 600; cursor: pointer; transition: background 0.2s;';
        bindButton.textContent = 'üîó –ü—Ä–∏–≤—è–∑–∞—Ç—å —Ç–æ–∫–µ–Ω';
        bindButton.dataset.issueIndex = issueIndex;
        
        bindButton.addEventListener('mouseenter', () => {
          bindButton.style.background = '#45a049';
        });
        
        bindButton.addEventListener('mouseleave', () => {
          bindButton.style.background = '#4CAF50';
        });
        
        bindButton.addEventListener('click', (e) => {
          e.stopPropagation(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –ø–µ—Ä–µ—Ö–æ–¥ –∫ —ç–ª–µ–º–µ–Ω—Ç—É
          bindTokenToIssue(issue, issueIndex, bindButton);
        });
        
        tokenSuggestion.appendChild(suggestionLabel);
        tokenSuggestion.appendChild(tokenInfo);
        tokenSuggestion.appendChild(bindButton);
        
        card.appendChild(tokenSuggestion);
      }
      
      return card;
    }
    
    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞
    function formatTokenValue(value) {
      if (typeof value === 'number') {
        return value;
      } else if (typeof value === 'object' && value.r !== undefined) {
        // –¶–≤–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ RGB
        const r = Math.round(value.r * 255);
        const g = Math.round(value.g * 255);
        const b = Math.round(value.b * 255);
        return `rgb(${r}, ${g}, ${b})`;
      } else if (typeof value === 'string') {
        return value;
      }
      return JSON.stringify(value);
    }
    
    // –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–≤—è–∑–∫–∏ —Ç–æ–∫–µ–Ω–∞ –∫ —ç–ª–µ–º–µ–Ω—Ç—É
    function bindTokenToIssue(issue, issueIndex, button) {
      if (!issue.suggestedToken) return;
      
      // –û—Ç–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É –∏ –º–µ–Ω—è–µ–º —Ç–µ–∫—Å—Ç
      button.disabled = true;
      button.textContent = '‚è≥ –ü—Ä–∏–≤—è–∑–∫–∞...';
      button.style.background = '#999';
      
      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø—Ä–∏–≤—è–∑–∫—É —Ç–æ–∫–µ–Ω–∞
      parent.postMessage({
        pluginMessage: {
          type: 'dsv-bind-token',
          nodeId: issue.nodeId,
          property: mapPropertyDisplayToKey(issue.property),
          tokenId: issue.suggestedToken.id,
          issueIndex: issueIndex
        }
      }, '*');
    }
    
    // –§—É–Ω–∫—Ü–∏—è –º–∞–ø–ø–∏–Ω–≥–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–≥–æ –∏–º–µ–Ω–∏ —Å–≤–æ–π—Å—Ç–≤–∞ –∫ –∫–ª—é—á—É API
    function mapPropertyDisplayToKey(displayName) {
      const mapping = {
        'Fill': 'fills',
        'Stroke': 'strokes',
        'Corner Radius': 'cornerRadius',
        'Padding Left': 'paddingLeft',
        'Padding Right': 'paddingRight',
        'Padding Top': 'paddingTop',
        'Padding Bottom': 'paddingBottom',
        'Gap': 'itemSpacing',
        'Effect': 'effects',
        'Opacity': 'opacity',
        'Width': 'width',
        'Height': 'height'
      };
      
      // –ï—Å–ª–∏ —ç—Ç–æ —É–≥–æ–ª —Å –ø–æ—Å—Ç—Ñ–∏–∫—Å–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä "Corner Radius Top-Left")
      if (displayName.startsWith('Corner Radius ')) {
        const cornerPart = displayName.replace('Corner Radius ', '').replace('-', '');
        if (cornerPart === 'TopLeft') return 'topLeftRadius';
        if (cornerPart === 'TopRight') return 'topRightRadius';
        if (cornerPart === 'BottomLeft') return 'bottomLeftRadius';
        if (cornerPart === 'BottomRight') return 'bottomRightRadius';
      }
      
      return mapping[displayName] || displayName.toLowerCase();
    }
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç –ø–ª–∞–≥–∏–Ω–∞
    window.onmessage = (event) => {
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ pluginMessage
      if (!event || !event.data || !event.data.pluginMessage) {
        return; // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –æ—Ç –ø–ª–∞–≥–∏–Ω–∞
      }
      
      const message = event.data.pluginMessage;
      
      if (!message || !message.type) {
        debugWarn('–ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–µ–∑ —Ç–∏–ø–∞:', message);
        return;
      }
      
      if (message.type === 'set-mode') {
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ UI –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞
        setupUIMode(message.mode);
      } else if (message.type === 'progress') {
        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (–¥–ª—è –æ–±—ã—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∫–æ–Ω–æ–∫)
        displayMessage({
          type: 'progress',
          message: message.message,
          percent: message.percent
        });
        
        // –ï—Å–ª–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–æ—Å—Ç–∏–≥ 100%, —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–Ω–æ–ø–∫–µ –∏—Å—Ö–æ–¥–Ω—ã–π –≤–∏–¥
        if (message.percent === 100) {
          isCheckingInProgress = false;
          checkButton.textContent = '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å';
          checkButton.style.backgroundColor = '#F86025';
        }
      } else if (message.type === 'svg-export-progress') {
        // –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–ª—è SVG —ç–∫—Å–ø–æ—Ä—Ç–∞
        debugLog('SVG Export: –ü–æ–ª—É—á–µ–Ω –ø—Ä–æ–≥—Ä–µ—Å—Å —ç–∫—Å–ø–æ—Ä—Ç–∞:', message);
        
        if (svgExportProgress.style.display !== 'none') {
          // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫
          exportCounter.textContent = `${message.current}/${message.total}`;
          
          // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç
          const percent = Math.round((message.current / message.total) * 100);
          exportPercentage.textContent = `${percent}%`;
          
          // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å–±–∞—Ä
          exportProgressFill.style.width = `${percent}%`;
          
          // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—É—â—É—é –∏–∫–æ–Ω–∫—É
          if (message.currentIcon) {
            exportCurrentIcon.textContent = message.currentIcon;
          }
          
          // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç
          if (message.message) {
            exportProgressText.textContent = message.message;
          }
        }
      } else if (message.type === 'error') {
        // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –æ—à–∏–±–∫—É
        displayMessage({
          type: 'error',
          message: message.message
        });
        
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–Ω–æ–ø–∫–µ –∏—Å—Ö–æ–¥–Ω—ã–π –≤–∏–¥
        isCheckingInProgress = false;
        checkButton.textContent = '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å';
        checkButton.style.backgroundColor = '#F86025';
      } else if (message.type === 'create-cell-result') {
        // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–∑–¥–∞–Ω–∏—è Cell
        if (message.result.success) {
          displayMessage({
            type: 'success',
            message: message.result.message
          });
        } else {
          displayMessage({
            type: 'error',
            message: message.result.message
          });
        }
      } else if (message.type === 'check-results') {
        // –°–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å
        statusElement.style.display = 'none';
        progressContainer.style.display = 'none';
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
        currentResults = message.results;
        
        // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –æ–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫
        displayResults(message.results);
        
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–Ω–æ–ø–∫–µ –∏—Å—Ö–æ–¥–Ω—ã–π –≤–∏–¥
        isCheckingInProgress = false;
        checkButton.textContent = '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å';
        checkButton.style.backgroundColor = '#F86025';
        
        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ –¥–ª—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
        setTimeout(function() {
          if (message.results.length === 0) {
            // –°–∫—Ä—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫, –µ—Å–ª–∏ –æ—à–∏–±–æ–∫ –Ω–µ—Ç
            errorBadge.style.display = 'none';
          } else {
            // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫
            let totalErrors = 0;
            message.results.forEach(result => {
              totalErrors += result.errors.length;
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏
            if (totalErrors > 0) {
              errorBadge.textContent = totalErrors;
              errorBadge.style.display = 'inline-flex';
              errorBadge.classList.add('animate-pulse');
            } else {
              errorBadge.style.display = 'none';
            }
          }
        }, 100);
      } else if (message.type === 'fix-result') {
        // –û–±–Ω–æ–≤–ª—è–µ–º UI –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—à–∏–±–∫–∏
        if (message.result.success) {
          displayMessage({
            type: 'success',
            message: message.result.message
          });
          
          // –ù–µ –∑–∞–ø—É—Å–∫–∞–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏,
          // —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å —Å–ø–∏—Å–æ–∫ –æ—à–∏–±–æ–∫ –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ
          // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤—Ä—É—á–Ω—É—é –∫–Ω–æ–ø–∫–æ–π "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å"
        } else {
          displayMessage({
            type: 'error',
            message: message.result.message
          });
        }
      } else if (message.type === 'fix-all-result') {
        // –°–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å
        statusElement.style.display = 'none';
        progressContainer.style.display = 'none';
        
        // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö –æ—à–∏–±–æ–∫
        if (message.result.success) {
          displayMessage({
            type: 'success',
            message: message.result.message
          });
          
          // –ó–∞–ø—É—Å–∫–∞–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É
          checkButton.click();
        } else {
          displayMessage({
            type: 'error',
            message: message.result.message
          });
        }
      } else if (message.type === 'settings') {
        // –û–±–Ω–æ–≤–ª—è–µ–º —á–µ–∫–±–æ–∫—Å—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
        for (const [key, value] of Object.entries(message.settings)) {
          if (checkboxes[key]) {
            checkboxes[key].checked = value;
          }
        }
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ–∫–±–æ–∫—Å–æ–≤ —Å —É—á–µ—Ç–æ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
        updateCheckboxStates();
      } else if (message.type === 'settings-updated') {
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
        debugLog('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã:', message.settings);
      } else if (message.type === 'selected-node-id') {
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è ID –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞
        if (message.success) {
          const nodeId = message.nodeId;
          const nodeName = message.nodeName || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –æ–±—ä–µ–∫—Ç';
          
          // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ ID
          currentNodeIdDisplay.textContent = `ID: ${nodeId} (${nodeName})`;
          
          // –î–æ–±–∞–≤–ª—è–µ–º ID –≤ textarea
          const currentText = nodeIdsTextarea.value;
          const newLine = currentText ? '\n' : '';
          nodeIdsTextarea.value = currentText + newLine + nodeId;
          
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
          displayMessage({
            type: 'success',
            message: `ID –ø–æ–ª—É—á–µ–Ω: ${nodeName}`
          });
        } else {
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
          displayMessage({
            type: 'error',
            message: message.message || '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å ID –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞'
          });
        }
      } else if (message.type === 'scan-result') {
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏–∫–æ–Ω–æ–∫
        debugLog('SVG Export: –ü–æ–ª—É—á–µ–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:', message.result);
        
        // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–Ω–æ–ø–∫–µ –∏—Å—Ö–æ–¥–Ω—ã–π –≤–∏–¥
        scanIconsButton.textContent = '–ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –∏–∫–æ–Ω–∫–∏';
        scanIconsButton.disabled = false;
        
        if (message.result.success) {
          // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
          scannedComponentSets = message.result.componentSets;
          debugLog('SVG Export: –°–æ—Ö—Ä–∞–Ω–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç-—Å–µ—Ç–æ–≤:', scannedComponentSets);
          
          // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
          componentSetsCount.textContent = message.result.componentSetsCount;
          totalVariantsCount.textContent = message.result.totalVariants;
          
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ –∫–Ω–æ–ø–∫—É —ç–∫—Å–ø–æ—Ä—Ç–∞
          if (message.result.componentSetsCount > 0) {
            exportStats.style.display = 'block';
            colorOptions.style.display = 'block';
            exportIconsButton.style.display = 'block';
            exportInfo.style.display = 'block';
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏ –æ–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–ø–æ—Å–æ–±–µ –∑–∞–≥—Ä—É–∑–∫–∏
            const downloadMethodInfo = document.getElementById('download-method-info');
            if (downloadMethodInfo) {
              if (typeof JSZip !== 'undefined') {
                downloadMethodInfo.textContent = 'üíæ –°–∫–∞—á–∞–µ—Ç—Å—è –æ–¥–∏–Ω ZIP —Ñ–∞–π–ª —Å–æ –≤—Å–µ–º–∏ –∏–∫–æ–Ω–∫–∞–º–∏';
                downloadMethodInfo.style.color = '#4CAF50';
              } else {
                downloadMethodInfo.textContent = 'üìÅ –§–∞–π–ª—ã –±—É–¥—É—Ç —Å–∫–∞—á–∞–Ω—ã –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏ (—Ä–µ–∑–µ—Ä–≤–Ω—ã–π —Ä–µ–∂–∏–º)';
                downloadMethodInfo.style.color = '#2196F3';
              }
            }
            
            displayMessage({
              type: 'success',
              message: `–ù–∞–π–¥–µ–Ω–æ ${message.result.componentSetsCount} –∫–æ–º–ø–æ–Ω–µ–Ω—Ç-—Å–µ—Ç–æ–≤ —Å ${message.result.totalVariants} –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏`
            });
          } else {
            exportStats.style.display = 'none';
            colorOptions.style.display = 'none';
            exportIconsButton.style.display = 'none';
            exportInfo.style.display = 'none';
            
            displayMessage({
              type: 'error',
              message: '–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç-—Å–µ—Ç–æ–≤ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º "orb-icon-"'
            });
          }
        } else {
          debugLog('SVG Export: –û—à–∏–±–∫–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:', message.result.message);
          displayMessage({
            type: 'error',
            message: message.result.message || '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏–∫–æ–Ω–æ–∫'
          });
        }
      } else if (message.type === 'export-result') {
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞
        debugLog('SVG Export: –ü–æ–ª—É—á–µ–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ç–∫—Å–ø–æ—Ä—Ç–∞:', message.result);
        
        // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–Ω–æ–ø–∫–µ –∏—Å—Ö–æ–¥–Ω—ã–π –≤–∏–¥
        exportIconsButton.textContent = '–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ SVG (zip)';
        exportIconsButton.disabled = false;
        
        // –°–∫—Ä—ã–≤–∞–µ–º –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å–±–∞—Ä SVG —ç–∫—Å–ø–æ—Ä—Ç–∞
        svgExportProgress.style.display = 'none';
      } else if (message.type === 'save-svg-file') {
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è SVG —Ñ–∞–π–ª–∞ - –¥–æ–±–∞–≤–ª—è–µ–º –≤ –∞—Ä—Ö–∏–≤
        debugLog('SVG Export: –ü–æ–ª—É—á–µ–Ω —Ñ–∞–π–ª –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∞—Ä—Ö–∏–≤:', message.fileName);
        
        try {
          // –î–æ–±–∞–≤–ª—è–µ–º —Ñ–∞–π–ª –≤ –º–∞—Å—Å–∏–≤ –¥–ª—è –∞—Ä—Ö–∏–≤–∞
          svgFiles.push({
            name: message.fileName,
            data: message.svgData
          });
          
          debugLog(`SVG Export: –î–æ–±–∞–≤–ª–µ–Ω —Ñ–∞–π–ª –≤ –∞—Ä—Ö–∏–≤ (${svgFiles.length}/${expectedFilesCount}):`, message.fileName);
          
          // –ï—Å–ª–∏ –ø–æ–ª—É—á–∏–ª–∏ –≤—Å–µ —Ñ–∞–π–ª—ã, —Å–æ–∑–¥–∞–µ–º ZIP –∞—Ä—Ö–∏–≤
          if (svgFiles.length >= expectedFilesCount) {
            debugLog('SVG Export: –í—Å–µ —Ñ–∞–π–ª—ã –ø–æ–ª—É—á–µ–Ω—ã, —Å–æ–∑–¥–∞–µ–º ZIP –∞—Ä—Ö–∏–≤...');
            createAndDownloadZip().catch(error => {
              console.error('SVG Export: –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ ZIP –∞—Ä—Ö–∏–≤–∞:', error);
              displayMessage({
                type: 'error',
                message: `–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∞—Ä—Ö–∏–≤–∞: ${error.message}`
              });
            });
          }
        } catch (error) {
          console.error('SVG Export: –û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞ –≤ –∞—Ä—Ö–∏–≤:', message.fileName, error);
        }
      } else if (message.type === 'design-info-collected') {
        // AI Design Lint - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—Ä–∞–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥–∏–∑–∞–π–Ω–µ
        debugLog('AI Design Lint: –ü–æ–ª—É—á–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∏–∑–∞–π–Ω–µ:', message.designInfo);
        
        if (!message.designInfo.success) {
          if (aiAnalysisResult) {
            aiAnalysisResult.innerHTML = `<p style="color: #F02D2D;">${message.designInfo.message}</p>`;
          }
          if (analyzeDesignButton) {
            analyzeDesignButton.textContent = '–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∏–∑–∞–π–Ω';
            analyzeDesignButton.disabled = false;
          }
          return;
        }
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º designInfo –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏
        window.currentDesignInfo = message.designInfo;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
        if (aiAnalysisResult) {
          aiAnalysisResult.innerHTML = '<div class="ai-loading">–û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –∫ AI</div>';
        }
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –∫ Eliza API
        const token = yandexTokenInput ? yandexTokenInput.value.trim() : '';
        const userPrompt = aiPromptInput ? aiPromptInput.value.trim() : '';
        
        sendToElizaAPI(message.designInfo, userPrompt, token)
          .then(result => {
            if (analyzeDesignButton) {
              analyzeDesignButton.textContent = '–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∏–∑–∞–π–Ω';
              analyzeDesignButton.disabled = false;
            }
            
            if (result.success) {
              displayAIAnalysis(result.analysis, window.currentDesignInfo);
            } else {
              if (aiAnalysisResult) {
                aiAnalysisResult.innerHTML = `<p style="color: #F02D2D;">–û—à–∏–±–∫–∞: ${result.error}</p>`;
              }
            }
          })
          .catch(error => {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –∫ Eliza API:', error);
            if (analyzeDesignButton) {
              analyzeDesignButton.textContent = '–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∏–∑–∞–π–Ω';
              analyzeDesignButton.disabled = false;
            }
            if (aiAnalysisResult) {
              aiAnalysisResult.innerHTML = `<p style="color: #F02D2D;">–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –∫ API: ${error.message}</p>`;
            }
          });
      } else if (message.type === 'ai-lint-progress') {
        // AI Design Lint - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
        if (aiAnalysisResult) {
          aiAnalysisResult.innerHTML = `<div class="ai-loading">${message.message}</div>`;
        }
      } else if (message.type === 'saved-token') {
        // AI Design Lint - –ø–æ–ª—É—á–µ–Ω —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω
        if (message.token && yandexTokenInput) {
          yandexTokenInput.value = message.token;
        }
      } else if (message.type === 'token-saved') {
        // AI Design Lint - —Ç–æ–∫–µ–Ω —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω
        debugLog('AI Design Lint: –¢–æ–∫–µ–Ω —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω');
      } else if (message.type === 'custom-design-system-loaded') {
        // AI Design Lint - –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∫–∞—Å—Ç–æ–º–Ω–∞—è –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–∞
        if (message.data) {
          customDesignSystemJson = message.data;
          updateJsonStatus('design-system.json', true);
          debugLog('AI Design Lint: –ö–∞—Å—Ç–æ–º–Ω–∞—è –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞');
        }
      } else if (message.type === 'dsv-validation-result') {
        // Design System Validator - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏
        debugLog('Design System Validator: –ü–æ–ª—É—á–µ–Ω—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏', message.report);
        displayDSVResults(message.report);
      } else if (message.type === 'dsv-validation-progress') {
        // Design System Validator - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
        const progressCount = document.getElementById('dsv-progress-count');
        if (progressCount) {
          progressCount.textContent = message.processed || 0;
        }
        debugLog('Design System Validator: –ü—Ä–æ–≥—Ä–µ—Å—Å –ø—Ä–æ–≤–µ—Ä–∫–∏', message.processed);
      } else if (message.type === 'dsv-validation-error') {
        // Design System Validator - –æ—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏
        debugLog('Design System Validator: –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏', message.error);
        
        // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
        const loadingIndicator = document.getElementById('dsv-loading-indicator');
        if (loadingIndicator) loadingIndicator.style.display = 'none';
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
        const resultsPanel = document.getElementById('dsv-results-panel');
        if (resultsPanel) {
          resultsPanel.innerHTML = `<div style="background: #44444C; border-radius: 8px; padding: 16px; color: #F44336; text-align: center;">
            <div style="font-size: 18px; margin-bottom: 8px;">‚ùå</div>
            <div style="font-size: 14px; font-weight: 600; margin-bottom: 4px;">–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ</div>
            <div style="font-size: 12px; color: #AAAAAA;">${message.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}</div>
          </div>`;
          resultsPanel.style.display = 'block';
        }
      } else if (message.type === 'dsv-bind-token-result') {
        // Design System Validator - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏–≤—è–∑–∫–∏ —Ç–æ–∫–µ–Ω–∞
        debugLog('Design System Validator: –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏–≤—è–∑–∫–∏ —Ç–æ–∫–µ–Ω–∞', message.result);
        
        if (message.result.success) {
          // –£–¥–∞–ª—è–µ–º issue –∏–∑ –æ—Ç—á–µ—Ç–∞, —Ç–∞–∫ –∫–∞–∫ —Ç–æ–∫–µ–Ω –ø—Ä–∏–≤—è–∑–∞–Ω
          if (dsvCurrentReport && dsvCurrentReport.issues && message.issueIndex !== undefined) {
            dsvCurrentReport.issues.splice(message.issueIndex, 1);
            dsvCurrentReport.totalIssues = dsvCurrentReport.issues.length;
            
            // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            displayDSVResults(dsvCurrentReport);
          }
        } else {
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É (—É–∂–µ –ø–æ–∫–∞–∑–∞–Ω–∞ –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–∏ Figma)
          debugLog('Design System Validator: –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–∏–≤—è–∑–∫–µ —Ç–æ–∫–µ–Ω–∞', message.result.error);
        }
      } else if (message.type === 'dsv-export-tokens-result') {
        // Design System Validator - —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ç–∫—Å–ø–æ—Ä—Ç–∞ —Ç–æ–∫–µ–Ω–æ–≤
        debugLog('Design System Validator: –ü–æ–ª—É—á–µ–Ω—ã —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã', message.data);
        
        const exportStatus = document.getElementById('dsv-export-status');
        const exportStatusText = document.getElementById('dsv-export-status-text');
        
        if (message.success && message.data) {
          // –°–æ–∑–¥–∞—ë–º JSON —Å—Ç—Ä–æ–∫—É
          const jsonString = JSON.stringify(message.data, null, 2);
          
          // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∏–≤–∞–µ–º —Ñ–∞–π–ª
          const blob = new Blob([jsonString], { type: 'application/json' });
          const url = URL.createObjectURL(blob);
          const link = document.createElement('a');
          link.href = url;
          link.download = `design-tokens-export-${Date.now()}.json`;
          link.click();
          URL.revokeObjectURL(url);
          
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—Ö
          if (exportStatus) {
            exportStatus.style.display = 'block';
            exportStatusText.textContent = `‚úÖ –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ —Ç–æ–∫–µ–Ω–æ–≤: ${message.data.tokens.length} (—Ñ–∞–π–ª —Å–∫–∞—á–∞–Ω)`;
            exportStatusText.style.color = '#4CAF50';
          }
          
          debugLog('Design System Validator: –¢–æ–∫–µ–Ω—ã —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ —Å–∫–∞—á–∞–Ω—ã');
          
          // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
          setTimeout(() => {
            if (exportStatus) exportStatus.style.display = 'none';
          }, 5000);
        } else {
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
          if (exportStatus) {
            exportStatus.style.display = 'block';
            exportStatusText.textContent = `‚ùå –û—à–∏–±–∫–∞: ${message.error || '–ù–µ —É–¥–∞–ª–æ—Å—å —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω—ã'}`;
            exportStatusText.style.color = '#F44336';
          }
          
          debugError('Design System Validator: –û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ —Ç–æ–∫–µ–Ω–æ–≤', message.error);
        }
      } else if (message.type === 'dsv-tokens-saved') {
        // Design System Validator - —Ç–æ–∫–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
        debugLog('Design System Validator: –¢–æ–∫–µ–Ω—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ø–∞–º—è—Ç–∏ –ø–ª–∞–≥–∏–Ω–∞', message.count);
        
        const tokensJsonStatus = document.getElementById('dsv-tokens-json-status');
        const tokensJsonStatusText = document.getElementById('dsv-tokens-json-status-text');
        const clearTokensJsonButton = document.getElementById('dsv-clear-tokens-json-button');
        
        if (tokensJsonStatus && tokensJsonStatusText) {
          tokensJsonStatus.style.display = 'block';
          
          let statusText = `‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ç–æ–∫–µ–Ω–æ–≤: ${message.count}`;
          if (message.savedAt) {
            const date = new Date(message.savedAt);
            const timeStr = date.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });
            statusText += ` (${timeStr})`;
          }
          
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –µ—Å–ª–∏ —Ç–æ–∫–µ–Ω—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –Ω–∞–≤—Å–µ–≥–¥–∞
          if (message.persistent === false && message.warning) {
            statusText += '\n‚ö†Ô∏è ' + message.warning;
            tokensJsonStatusText.style.color = '#FF9800'; // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
          } else {
            tokensJsonStatusText.style.color = '#4CAF50'; // –ó–µ–ª—ë–Ω—ã–π –¥–ª—è —É—Å–ø–µ—Ö–∞
          }
          
          tokensJsonStatusText.textContent = statusText;
        }
        
        if (clearTokensJsonButton) {
          clearTokensJsonButton.disabled = false;
        }
      } else if (message.type === 'dsv-tokens-save-error') {
        // Design System Validator - –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤
        debugError('Design System Validator: –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤', message.error);
        
        const tokensJsonStatus = document.getElementById('dsv-tokens-json-status');
        const tokensJsonStatusText = document.getElementById('dsv-tokens-json-status-text');
        
        if (tokensJsonStatus && tokensJsonStatusText) {
          tokensJsonStatus.style.display = 'block';
          tokensJsonStatusText.textContent = `‚ùå –û—à–∏–±–∫–∞: ${message.error}`;
          tokensJsonStatusText.style.color = '#F44336';
        }
      } else if (message.type === 'dsv-tokens-loaded-from-storage') {
        // Design System Validator - —Ç–æ–∫–µ–Ω—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ clientStorage –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
        debugLog('Design System Validator: –¢–æ–∫–µ–Ω—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö', message.count);
        
        const tokensJsonStatus = document.getElementById('dsv-tokens-json-status');
        const tokensJsonStatusText = document.getElementById('dsv-tokens-json-status-text');
        const clearTokensJsonButton = document.getElementById('dsv-clear-tokens-json-button');
        
        if (tokensJsonStatus && tokensJsonStatusText) {
          tokensJsonStatus.style.display = 'block';
          
          let statusText = `‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ç–æ–∫–µ–Ω–æ–≤: ${message.count}`;
          if (message.savedAt) {
            const savedDate = new Date(message.savedAt);
            const now = new Date();
            const diffMs = now - savedDate;
            const diffMins = Math.floor(diffMs / 60000);
            const diffHours = Math.floor(diffMs / 3600000);
            const diffDays = Math.floor(diffMs / 86400000);
            
            let timeAgo = '';
            if (diffMins < 1) {
              timeAgo = '—Ç–æ–ª—å–∫–æ —á—Ç–æ';
            } else if (diffMins < 60) {
              timeAgo = `${diffMins} –º–∏–Ω. –Ω–∞–∑–∞–¥`;
            } else if (diffHours < 24) {
              timeAgo = `${diffHours} —á. –Ω–∞–∑–∞–¥`;
            } else {
              timeAgo = `${diffDays} –¥–Ω. –Ω–∞–∑–∞–¥`;
            }
            
            statusText += ` (–∏–∑ –ø–∞–º—è—Ç–∏, ${timeAgo})`;
          } else {
            statusText += ' (–∏–∑ –ø–∞–º—è—Ç–∏)';
          }
          
          tokensJsonStatusText.textContent = statusText;
          tokensJsonStatusText.style.color = '#4CAF50';
        }
        
        if (clearTokensJsonButton) {
          clearTokensJsonButton.disabled = false;
        }
      } else if (message.type === 'dsv-tokens-status') {
        // Design System Validator - —Å—Ç–∞—Ç—É—Å —Ç–æ–∫–µ–Ω–æ–≤ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
        debugLog('Design System Validator: –°—Ç–∞—Ç—É—Å —Ç–æ–∫–µ–Ω–æ–≤', message);
        
        const tokensJsonStatus = document.getElementById('dsv-tokens-json-status');
        const tokensJsonStatusText = document.getElementById('dsv-tokens-json-status-text');
        const clearTokensJsonButton = document.getElementById('dsv-clear-tokens-json-button');
        
        if (message.hasTokens && message.count > 0) {
          if (tokensJsonStatus && tokensJsonStatusText) {
            tokensJsonStatus.style.display = 'block';
            tokensJsonStatusText.textContent = `‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ç–æ–∫–µ–Ω–æ–≤: ${message.count}`;
            tokensJsonStatusText.style.color = '#4CAF50';
          }
          
          if (clearTokensJsonButton) {
            clearTokensJsonButton.disabled = false;
          }
        }
      } else {
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π
        debugWarn('–ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–º —Ç–∏–ø–æ–º:', message.type);
      }
    };
    
    // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —É–∂–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –Ω–∏–∂–µ —Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è debounce, —á—Ç–æ–±—ã –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —á–∞—Å—Ç–æ—Ç—É –≤—ã–∑–æ–≤–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏
    function debounce(func, wait) {
      let timeout;
      return function() {
        const context = this;
        const args = arguments;
        clearTimeout(timeout);
        timeout = setTimeout(() => func.apply(context, args), wait);
      };
    }
    
    /**
     * –û–±—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤
     * @param {Object} options - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏—è
     * @param {string} options.type - –¢–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è: 'error', 'success', 'progress'
     * @param {string} options.message - –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
     * @param {number} [options.percent] - –ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–∏–ø–∞ 'progress')
     */
    function displayMessage(options) {
      // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
      if (!options || !options.type || !options.message) {
        debugWarn('displayMessage: –Ω–µ–≤–µ—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã', options);
        return;
      }
      
      const { type, message, percent } = options;
      
      switch (type) {
        case 'error':
          // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ
          errorContainer.style.display = 'block';
          errorContainer.innerHTML = '';
          
          const errorMessage = document.createElement('div');
          errorMessage.className = 'error-message animate-fadeIn';
          errorMessage.textContent = message;
          
          errorContainer.appendChild(errorMessage);
          break;
          
        case 'success':
          // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± —É—Å–ø–µ—Ö–µ
          errorContainer.style.display = 'block';
          errorContainer.innerHTML = '';
          
          const successMessage = document.createElement('div');
          successMessage.className = 'success-message animate-pulse';
          successMessage.textContent = message;
          
          errorContainer.appendChild(successMessage);
          break;
          
        case 'progress':
          // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
          if (typeof percent !== 'number') {
            debugWarn('displayMessage: –ø—Ä–æ—Ü–µ–Ω—Ç –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —á–∏—Å–ª–æ–º:', percent);
            return;
          }
          
          progressFill.style.width = `${percent}%`;
          progressText.textContent = `${message} (${percent}%)`;
          break;
          
        default:
          debugWarn('displayMessage: –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è', type);
      }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—à–∏–±–∫–∏ (–æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
    function displayError(message) {
      if (!message) {
        debugWarn('displayError: —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ');
        message = '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞';
      }
      
      displayMessage({
        type: 'error',
        message: message
      });
    }
    
    // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± —É—Å–ø–µ—Ö–µ (–æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
    function displaySuccess(message) {
      if (!message) {
        debugWarn('displaySuccess: —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ');
        message = '–û–ø–µ—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ';
      }
      
      displayMessage({
        type: 'success',
        message: message
      });
    }
    
    // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (–æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
    function updateProgress(percent, message) {
      if (typeof percent !== 'number') {
        debugWarn('updateProgress: –ø—Ä–æ—Ü–µ–Ω—Ç –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —á–∏—Å–ª–æ–º:', percent);
        percent = 0;
      }
      
      if (!message) {
        debugWarn('updateProgress: —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ');
        message = '–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ...';
      }
      
      displayMessage({
        type: 'progress',
        message: message,
        percent: percent
      });
    }
    
    // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    parent.postMessage({ pluginMessage: { type: 'get-settings' } }, '*');
    
    // –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    document.addEventListener('DOMContentLoaded', function() {
      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã–±–æ—Ä–∞ —Ü–≤–µ—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (—á–µ—Ä–Ω—ã–π —Ü–≤–µ—Ç)
      const blackColorButton = document.querySelector('.color-preset-btn[data-color="#000000"]');
      if (blackColorButton) {
        const defaultColor = '#000000';
        setSelectedColor(defaultColor);
        updateActiveColorButton(blackColorButton);
        customFillColor.value = defaultColor;
        customFillHex.value = defaultColor;
      }
      
      // –°—á–µ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ —Å–∫—Ä—ã—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –æ—à–∏–±–æ–∫
      // –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞
      const header = document.querySelector('h1');
      if (header) {
        header.classList.add('animate-fadeIn');
        
        // –ù–∞—Ö–æ–¥–∏–º —Å–∏–º–≤–æ–ª "‚ú¶" –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ –∏ –¥–æ–±–∞–≤–ª—è–µ–º –µ–º—É –∞–Ω–∏–º–∞—Ü–∏—é
        const headerText = header.innerHTML;
        const starSymbol = "‚ú¶";
        if (headerText.includes(starSymbol)) {
          // –ó–∞–º–µ–Ω—è–µ–º —Å–∏–º–≤–æ–ª –Ω–∞ span —Å –∫–ª–∞—Å—Å–æ–º –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
          header.innerHTML = headerText.replace(
            starSymbol,
            `<span id="orbita-star" class="star-animation">${starSymbol}</span>`
          );
          
          // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–∏
          function animateStar() {
            const star = document.getElementById('orbita-star');
            if (star) {
              // –£–¥–∞–ª—è–µ–º –∫–ª–∞—Å—Å –∞–Ω–∏–º–∞—Ü–∏–∏, —á—Ç–æ–±—ã —Å–±—Ä–æ—Å–∏—Ç—å –µ—ë
              star.classList.remove('star-animation');
              // –§–æ—Ä—Å–∏—Ä—É–µ–º –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫—É
              void star.offsetWidth;
              // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å –∞–Ω–∏–º–∞—Ü–∏–∏ —Å–Ω–æ–≤–∞
              star.classList.add('star-animation');
            }
          }
          
          // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é —Å—Ä–∞–∑—É
          animateStar();
          
          // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –∫–∞–∂–¥—ã–µ 15 —Å–µ–∫—É–Ω–¥
          setInterval(animateStar, 15000);
        }
      }
      
      // –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –∫–Ω–æ–ø–æ–∫
      const buttons = document.querySelectorAll('button');
      buttons.forEach((button, index) => {
        button.classList.add('animate-slideIn');
        button.style.animationDelay = `${index * 0.1}s`;
      });
      
      // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å—ã –∞–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ –º–µ–Ω—é –Ω–∞—Å—Ç—Ä–æ–µ–∫
      if (settingsDropdown) {
        settingsDropdown.classList.add('animate-fadeIn');
      }
    });
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ–ª–æ–∂–µ–Ω–∏—è tooltip
    function adjustTooltipPosition() {
      // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ tooltip —ç–ª–µ–º–µ–Ω—Ç—ã
      const tooltips = document.querySelectorAll('.tooltip');
      
      tooltips.forEach(tooltip => {
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å—Ç–∏–ª–∏
        tooltip.style.left = '';
        tooltip.style.right = '';
        tooltip.style.bottom = '';
        tooltip.style.top = '';
        tooltip.style.marginLeft = '';
        tooltip.style.marginTop = '';
        
        // –ü–æ–ª—É—á–∞–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π —ç–ª–µ–º–µ–Ω—Ç (–∏–∫–æ–Ω–∫–∞ –≤–æ–ø—Ä–æ—Å–∞ –∏–ª–∏ –∫–Ω–æ–ø–∫–∞ —Ñ–∏–∫—Å)
        const parent = tooltip.parentElement;
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å tooltip –∏–ª–∏ –µ—Å–ª–∏ —Ä–æ–¥–∏—Ç–µ–ª—å –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ hover
        if (getComputedStyle(tooltip).visibility === 'visible' || parent.matches(':hover')) {
          // –ü–æ–ª—É—á–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –∏ –ø–æ–∑–∏—Ü–∏—é tooltip –∏ –æ–∫–Ω–∞
          const tooltipRect = tooltip.getBoundingClientRect();
          const parentRect = parent.getBoundingClientRect();
          const windowWidth = window.innerWidth;
          const windowHeight = window.innerHeight;
          const headerHeight = document.querySelector('.header-container').getBoundingClientRect().height;
          
          // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—ã—Ö–æ–¥–∏—Ç –ª–∏ tooltip –∑–∞ –ª–µ–≤—ã–π –∫—Ä–∞–π –æ–∫–Ω–∞
          if (tooltipRect.left < 0) {
            tooltip.style.left = '0';
            tooltip.style.right = 'auto';
            tooltip.style.marginLeft = '0';
          }
          
          // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—ã—Ö–æ–¥–∏—Ç –ª–∏ tooltip –∑–∞ –ø—Ä–∞–≤—ã–π –∫—Ä–∞–π –æ–∫–Ω–∞
          if (tooltipRect.right > windowWidth) {
            tooltip.style.left = 'auto';
            tooltip.style.right = '0';
            tooltip.style.marginLeft = '0';
          }
          
          // –í—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç—É–ª—Ç–∏–ø –Ω–∞–¥ —ç–ª–µ–º–µ–Ω—Ç–æ–º, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –≤–µ—Ä—Ö–Ω–∏–π –∫—Ä–∞–π –æ–∫–Ω–∞
          // –≠—Ç–æ –≤–∞–∂–Ω–µ–µ, —á–µ–º –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ —à–∞–ø–∫–æ–π
          // –ö–æ–º–º–µ–Ω—Ç–∏—Ä—É–µ–º —ç—Ç—É –ø—Ä–æ–≤–µ—Ä–∫—É, —á—Ç–æ–±—ã —Ç—É–ª—Ç–∏–ø –≤—Å–µ–≥–¥–∞ –±—ã–ª —Å–≤–µ—Ä—Ö—É
          /*
          if (tooltipRect.top < headerHeight || tooltipRect.top < 0) {
            tooltip.style.bottom = 'auto';
            tooltip.style.top = '100%';
            tooltip.style.marginTop = '5px';
          }
          */
          
          // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—ã—Ö–æ–¥–∏—Ç –ª–∏ tooltip –∑–∞ –Ω–∏–∂–Ω–∏–π –∫—Ä–∞–π –æ–∫–Ω–∞
          if (tooltipRect.bottom > windowHeight) {
            tooltip.style.top = 'auto';
            tooltip.style.bottom = '100%';
            tooltip.style.marginBottom = '5px';
          }
        }
      });
    }
    
    // –°–æ–∑–¥–∞–µ–º –¥–µ–±–∞—É–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é —Ñ—É–Ω–∫—Ü–∏–∏ adjustTooltipPosition
    const debouncedAdjustTooltipPosition = debounce(adjustTooltipPosition, 100);
    
    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ–ª–æ–∂–µ–Ω–∏—è tooltip
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    document.addEventListener('mouseover', function(e) {
      if (e.target.closest('.tooltip-icon') || e.target.closest('.fix-button')) {
        debouncedAdjustTooltipPosition();
      }
    });
    
    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —á–∞—Å—Ç—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ –º—ã—à–∏
    document.addEventListener('mousemove', debounce(function(e) {
      if (document.querySelector('.tooltip[style*="visibility: visible"]')) {
        debouncedAdjustTooltipPosition();
      }
    }, 100));
    
    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
    window.addEventListener('resize', debouncedAdjustTooltipPosition);
    
    // –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é adjustTooltipPosition –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    document.addEventListener('DOMContentLoaded', debouncedAdjustTooltipPosition);
    
    // –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–π
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–µ, —Ç–∞–∫ –∫–∞–∫ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º
    /**
     * –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∫–æ–Ω–æ–∫ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
     * @param {Array} results - –ú–∞—Å—Å–∏–≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏
     */
    window.displayResults = function(results) {
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ results —è–≤–ª—è–µ—Ç—Å—è –º–∞—Å—Å–∏–≤–æ–º
      if (!Array.isArray(results)) {
        debugWarn('displayResults: results –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –º–∞—Å—Å–∏–≤–æ–º', results);
        results = [];
      }
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ resultsContainer —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
      if (!resultsContainer) {
        console.error('displayResults: resultsContainer –Ω–µ –Ω–∞–π–¥–µ–Ω');
        return;
      }
      
      // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
      resultsContainer.innerHTML = '';
      resultsContainer.classList.add('animate-fadeIn');
      
      // –û–±–Ω–æ–≤–ª—è–µ–º badge —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ—à–∏–±–æ–∫
      updateErrorBadge(results);
      
      // –ï—Å–ª–∏ –Ω–µ—Ç –æ—à–∏–±–æ–∫, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
      if (results.length === 0) {
        const successMessage = document.createElement('div');
        successMessage.className = 'success-message animate-pulse';
        successMessage.textContent = '–í—Å–µ –∏–∫–æ–Ω–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º! üéâ';
        resultsContainer.appendChild(successMessage);
        return;
      }
      
      // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –Ω—É–∂–Ω–∞ –ª–∏ –ª–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (–µ—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –±–æ–ª—å—à–µ 20)
      const needsLazyLoading = results.length > 20;
      const initialBatchSize = 10;
      
      // –°–æ–∑–¥–∞–µ–º DocumentFragment –¥–ª—è –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤
      const fragment = document.createDocumentFragment();
      
      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
      const createResultElements = (startIndex, endIndex) => {
        // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–π –æ—à–∏–±–∫–∏ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ
        for (let i = startIndex; i < endIndex && i < results.length; i++) {
          const result = results[i];
          
          // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ result —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–ª—è
          if (!result || typeof result !== 'object') {
            debugWarn('displayResults: –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞', result);
            continue;
          }
          
          // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –æ—à–∏–±–∫–∏
          const errorItem = createErrorItem(result, i);
          
          // –î–æ–±–∞–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç –≤ —Ñ—Ä–∞–≥–º–µ–Ω—Ç
          fragment.appendChild(errorItem);
        }
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        resultsContainer.appendChild(fragment);
        
        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ–ª–æ–∂–µ–Ω–∏—è tooltip –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        requestAnimationFrame(adjustTooltipPosition);
      };
      
      // –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –ª–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞, –¥–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä–≤—É—é –ø–∞—Ä—Ç–∏—é —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º IntersectionObserver
      if (needsLazyLoading) {
        // –°–æ–∑–¥–∞–µ–º –ø–µ—Ä–≤—É—é –ø–∞—Ä—Ç–∏—é —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        createResultElements(0, initialBatchSize);
        
        // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
        const loadingIndicator = document.createElement('div');
        loadingIndicator.id = 'loading-more-indicator';
        loadingIndicator.className = 'loading';
        loadingIndicator.textContent = '–ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤...';
        resultsContainer.appendChild(loadingIndicator);
        
        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º IntersectionObserver –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ
        let currentIndex = initialBatchSize;
        const batchSize = 5; // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∑–∞–≥—Ä—É–∂–∞–µ–º—ã—Ö –∑–∞ —Ä–∞–∑
        
        const observer = new IntersectionObserver((entries) => {
          if (entries[0].isIntersecting && currentIndex < results.length) {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–ª–µ–¥—É—é—â—É—é –ø–∞—Ä—Ç–∏—é —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            const nextBatchEnd = Math.min(currentIndex + batchSize, results.length);
            createResultElements(currentIndex, nextBatchEnd);
            currentIndex = nextBatchEnd;
            
            // –ï—Å–ª–∏ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã, —É–¥–∞–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ—Ç–∫–ª—é—á–∞–µ–º observer
            if (currentIndex >= results.length) {
              loadingIndicator.remove();
              observer.disconnect();
            }
          }
        }, { threshold: 0.1 });
        
        // –ù–∞—á–∏–Ω–∞–µ–º –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –∑–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º –∑–∞–≥—Ä—É–∑–∫–∏
        observer.observe(loadingIndicator);
      } else {
        // –ï—Å–ª–∏ –ª–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ –Ω—É–∂–Ω–∞, —Å–æ–∑–¥–∞–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å—Ä–∞–∑—É
        createResultElements(0, results.length);
      }
    };
    
    /**
     * –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—á–µ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏
     * @param {Array} results - –ú–∞—Å—Å–∏–≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏
     */
    function updateErrorBadge(results) {
      if (!results || !Array.isArray(results) || !errorBadge) {
        return;
      }
      
      if (results.length === 0) {
        // –°–∫—Ä—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫, –µ—Å–ª–∏ –æ—à–∏–±–æ–∫ –Ω–µ—Ç
        errorBadge.style.display = 'none';
        return;
      }
      
      // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫
      let totalErrors = 0;
      results.forEach(result => {
        if (result && Array.isArray(result.errors)) {
          totalErrors += result.errors.length;
        }
      });
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏
      if (totalErrors > 0) {
        errorBadge.textContent = totalErrors;
        errorBadge.style.display = 'inline-flex';
        errorBadge.classList.add('animate-pulse');
      } else {
        errorBadge.style.display = 'none';
      }
    }
    
    /**
     * –°–æ–∑–¥–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—à–∏–±–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
     * @param {Object} result - –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
     * @param {number} index - –ò–Ω–¥–µ–∫—Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ –º–∞—Å—Å–∏–≤–µ
     * @returns {HTMLElement} - –°–æ–∑–¥–∞–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
     */
    function createErrorItem(result, index) {
      const errorItem = document.createElement('div');
      errorItem.className = 'error-item';
      
      // –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏—é —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π (–æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –∑–∞–¥–µ—Ä–∂–∫—É)
      errorItem.classList.add('animate-slideIn');
      errorItem.style.animationDelay = `${Math.min(index * 0.05, 0.5)}s`;
      
      // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
      const componentName = document.createElement('div');
      componentName.className = 'component-name';
      componentName.textContent = result.nodeName || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç';
      
      // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É
      if (result.nodeId) {
        componentName.addEventListener('click', debounce(() => {
          parent.postMessage({
            pluginMessage: {
              type: 'focus-node',
              nodeId: result.nodeId
            }
          }, '*');
        }, 300));
      }
      
      errorItem.appendChild(componentName);
      
      // –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, –µ—Å–ª–∏ –µ—Å—Ç—å
      if (result.parentName) {
        const parentName = document.createElement('div');
        parentName.className = 'parent-name';
        parentName.textContent = `‚óá ${result.parentName}`;
        errorItem.appendChild(parentName);
      }
      
      // –°–æ–∑–¥–∞–µ–º —Å–ø–∏—Å–æ–∫ –æ—à–∏–±–æ–∫
      const errorList = document.createElement('ul');
      errorList.className = 'error-list';
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –µ—Å—Ç—å –º–∞—Å—Å–∏–≤ –æ—à–∏–±–æ–∫
      if (!Array.isArray(result.errors)) {
        debugWarn('createErrorItem: –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –º–∞—Å—Å–∏–≤ –æ—à–∏–±–æ–∫ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ', result);
        return errorItem;
      }
      
      // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–π –æ—à–∏–±–∫–∏
      result.errors.forEach((error, errorIndex) => {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø –æ—à–∏–±–∫–∏ - —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∞ –∏–ª–∏ –æ–±—ä–µ–∫—Ç
        let errorObj;
        if (typeof error === 'string') {
          // –ï—Å–ª–∏ —ç—Ç–æ —Å—Ç—Ä–æ–∫–∞ (—Å–ª—É—á–∞–π, –∫–æ–≥–¥–∞ –Ω–∏—á–µ–≥–æ –Ω–µ –≤—ã–±—Ä–∞–Ω–æ –∏–ª–∏ –Ω–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤),
          // –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –µ—ë –≤ –æ–±—ä–µ–∫—Ç —Å –ø–æ–ª–µ–º message
          errorObj = {
            message: error,
            type: 'general'
          };
        } else if (error && typeof error === 'object' && error.message) {
          errorObj = error;
        } else {
          debugWarn('createErrorItem: –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ—à–∏–±–∫–∞', error);
          return;
        }
        
        const errorListItem = document.createElement('li');
        
        // –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏—é —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π (–æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –∑–∞–¥–µ—Ä–∂–∫—É)
        errorListItem.classList.add('animate-fadeIn');
        errorListItem.style.animationDelay = `${Math.min((index * 0.05) + (errorIndex * 0.02), 0.7)}s`;
        
        // –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ
        const errorMessage = document.createElement('div');
        errorMessage.className = 'error-message';
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏
        const errorText = document.createElement('span');
        errorText.textContent = errorObj.message;
        errorMessage.appendChild(errorText);
        
        // –î–æ–±–∞–≤–ª—è–µ–º –∏–∫–æ–Ω–∫—É —Å –ø–æ–¥—Å–∫–∞–∑–∫–æ–π, –µ—Å–ª–∏ –µ—Å—Ç—å tooltip
        if (errorObj.tooltip) {
          const tooltipIcon = document.createElement('div');
          tooltipIcon.className = 'tooltip-icon';
          tooltipIcon.textContent = '?';
          
          const tooltip = document.createElement('div');
          tooltip.className = 'tooltip';
          tooltip.textContent = errorObj.tooltip;
          
          tooltipIcon.appendChild(tooltip);
          errorMessage.appendChild(tooltipIcon);
        }
        
        errorListItem.appendChild(errorMessage);
        
        // –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫—É "—Ñ–∏–∫—Å" –¥–ª—è –æ—à–∏–±–∫–∏
        const fixButton = document.createElement('button');
        fixButton.className = 'fix-button';
        
        // –î–æ–±–∞–≤–ª—è–µ–º SVG-–∏–∫–æ–Ω–∫—É –∏ —Ç—É–ª—Ç–∏–ø
        fixButton.innerHTML = `
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M7.99899 20L14.999 12.997C15.5285 12.4679 15.8261 11.7501 15.8264 11.0016C15.8267 10.253 15.5296 9.53501 15.0005 9.0055C14.4714 8.476 13.7536 8.17837 13.0051 8.17809C12.2565 8.1778 11.5385 8.47489 11.009 9.004L4.00199 16.001C3.73935 16.2634 3.53097 16.5751 3.38875 16.918C3.24654 17.261 3.17327 17.6286 3.17313 17.9999C3.17299 18.3712 3.24598 18.7389 3.38794 19.082C3.5299 19.4251 3.73805 19.7369 4.00049 19.9995C4.26294 20.2621 4.57455 20.4705 4.91753 20.6127C5.26051 20.755 5.62814 20.8282 5.99943 20.8284C6.37073 20.8285 6.73841 20.7555 7.0815 20.6136C7.42458 20.4716 7.73635 20.2624 7.99899 20ZM11 11L13 13L14 12C14.1313 11.8687 14.2355 11.7128 14.3066 11.5412C14.3776 11.3696 14.4142 11.1857 14.4142 11C14.4142 10.8143 14.3776 10.6304 14.3066 10.4588C14.2355 10.2872 14.1313 10.1313 14 10C13.8687 9.86868 13.7128 9.76451 13.5412 9.69344C13.3696 9.62237 13.1857 9.58579 13 9.58579C12.8143 9.58579 12.6304 9.62237 12.4588 9.69344C12.2872 9.76451 12.1313 9.86868 12 10L11 11Z" fill="white"/>
            <path d="M6.75901 4.897C6.82501 4.65 7.17501 4.65 7.24101 4.897L7.60001 6.225C7.61142 6.26715 7.63367 6.30558 7.66455 6.33646C7.69543 6.36734 7.73386 6.38959 7.77601 6.401L9.10401 6.759C9.35101 6.825 9.35101 7.175 9.10401 7.241L7.77501 7.6C7.73286 7.61141 7.69443 7.63366 7.66355 7.66454C7.63267 7.69542 7.61042 7.73385 7.59901 7.776L7.24001 9.103C7.17401 9.35 6.82401 9.35 6.75801 9.103L6.40001 7.775C6.3886 7.73285 6.36635 7.69442 6.33547 7.66354C6.30459 7.63266 6.26616 7.61041 6.22401 7.599L4.89501 7.241C4.64901 7.175 4.64901 6.825 4.89501 6.759L6.22501 6.4C6.26716 6.38859 6.30559 6.36634 6.33647 6.33546C6.36735 6.30458 6.3896 6.26615 6.40101 6.224L6.75901 4.897ZM16.759 3.897C16.825 3.65 17.175 3.65 17.241 3.897L17.599 5.225C17.6104 5.26715 17.6327 5.30558 17.6636 5.33646C17.6944 5.36734 17.7329 5.38959 17.775 5.401L19.103 5.759C19.35 5.825 19.35 6.175 19.103 6.241L17.775 6.599C17.7329 6.61041 17.6944 6.63266 17.6636 6.66354C17.6327 6.69442 17.6104 6.73285 17.599 6.775L17.241 8.103C17.175 8.35 16.825 8.35 16.759 8.103L16.4 6.775C16.3885 6.73273 16.3661 6.69422 16.335 6.66333C16.304 6.63244 16.2653 6.61026 16.223 6.599L14.895 6.241C14.649 6.175 14.649 5.825 14.895 5.759L16.223 5.401C16.2653 5.38974 16.304 5.36756 16.335 5.33667C16.3661 5.30578 16.3885 5.26727 16.4 5.225L16.759 3.897ZM17.759 12.897C17.825 12.65 18.175 12.65 18.241 12.897L18.599 14.225C18.6104 14.2672 18.6327 14.3056 18.6636 14.3365C18.6944 14.3673 18.7329 14.3896 18.775 14.401L20.103 14.759C20.35 14.825 20.35 15.175 20.103 15.241L18.775 15.599C18.7329 15.6104 18.6944 15.6327 18.6636 15.6635C18.6327 15.6944 18.6104 15.7328 18.599 15.775L18.241 17.103C18.175 17.35 17.825 17.35 17.759 17.103L17.401 15.775C17.3895 15.7327 17.3671 15.6942 17.336 15.6633C17.305 15.6324 17.2663 15.6103 17.224 15.599L15.896 15.241C15.65 15.175 15.65 14.825 15.896 14.759L17.224 14.401C17.2663 14.3897 17.305 14.3676 17.336 14.3367C17.3671 14.3058 17.3895 14.2673 17.401 14.225L17.759 12.897Z" fill="white"/>
          </svg>
          <div class="tooltip">–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–∏—Ç—å</div>
        `;
        
        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –¥–≤–æ–π–Ω–æ–≥–æ –∫–ª–∏–∫–∞
        // –ï—Å–ª–∏ nodeId –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (–æ–±—â–∞—è –æ—à–∏–±–∫–∞) –∏–ª–∏ —Ç–∏–ø –æ—à–∏–±–∫–∏ general, –¥–µ–ª–∞–µ–º –∫–Ω–æ–ø–∫—É –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–π
        if (!result.nodeId || errorObj.type === 'general' || errorObj.type === 'empty-color-layer') {
          fixButton.style.opacity = '0.5';
          fixButton.style.cursor = 'not-allowed';
          fixButton.disabled = true;
          
          // –ú–µ–Ω—è–µ–º —Ç–µ–∫—Å—Ç —Ç—É–ª—Ç–∏–ø–∞
          const tooltip = fixButton.querySelector('.tooltip');
          if (tooltip) {
            if (errorObj.type === 'empty-color-layer') {
              tooltip.textContent = '–í—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç';
            } else {
              tooltip.textContent = '–¢—Ä–µ–±—É–µ—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è';
            }
          }
        } else {
          fixButton.addEventListener('click', debounce(() => {
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ø–ª–∞–≥–∏–Ω –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—à–∏–±–∫–∏
            parent.postMessage({
              pluginMessage: {
                type: 'fix-error',
                nodeId: result.nodeId,
                errorType: errorObj.type
              }
            }, '*');
            
            // –í–∏–∑—É–∞–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            fixButton.classList.add('animate-pulse');
            setTimeout(() => fixButton.classList.remove('animate-pulse'), 500);
          }, 300));
        }
        
        errorListItem.appendChild(fixButton);
        errorList.appendChild(errorListItem);
      });
      
      errorItem.appendChild(errorList);
      return errorItem;
    }
    
    // –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∏ ZIP –∞—Ä—Ö–∏–≤–∞
    async function createAndDownloadZip() {
      try {
        debugLog('SVG Export: –°–æ–∑–¥–∞–µ–º ZIP –∞—Ä—Ö–∏–≤ —Å', svgFiles.length, '—Ñ–∞–π–ª–∞–º–∏');
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ JSZip
        if (typeof JSZip === 'undefined') {
          debugLog('SVG Export: JSZip –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥');
          downloadFilesSequentially();
          return;
        }
        
        debugLog('SVG Export: JSZip –¥–æ—Å—Ç—É–ø–Ω–∞, —Å–æ–∑–¥–∞–µ–º ZIP –∞—Ä—Ö–∏–≤');
        
        // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π ZIP –∞—Ä—Ö–∏–≤
        const zip = new JSZip();
        
        // –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ SVG —Ñ–∞–π–ª—ã –≤ –∞—Ä—Ö–∏–≤
        svgFiles.forEach(file => {
          debugLog('SVG Export: –î–æ–±–∞–≤–ª—è–µ–º –≤ ZIP:', file.name);
          zip.file(file.name, file.data);
        });
        
        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º ZIP —Ñ–∞–π–ª
        const zipBlob = await zip.generateAsync({
          type: 'blob',
          compression: 'DEFLATE',
          compressionOptions: {
            level: 6
          }
        });
        
        // –°–æ–∑–¥–∞–µ–º –∏–º—è –∞—Ä—Ö–∏–≤–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã
        const now = new Date();
        const dateStr = now.toISOString().slice(0, 10); // YYYY-MM-DD
        const timeStr = now.toTimeString().slice(0, 8).replace(/:/g, '-'); // HH-MM-SS
        const zipFileName = `orbita-icons-${dateStr}-${timeStr}.zip`;
        
        // –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫—É –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
        const url = URL.createObjectURL(zipBlob);
        const a = document.createElement('a');
        a.href = url;
        a.download = zipFileName;
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∏–≤–∞–µ–º —Ñ–∞–π–ª
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        
        // –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º –ø–∞–º—è—Ç—å
        URL.revokeObjectURL(url);
        
        debugLog('SVG Export: ZIP –∞—Ä—Ö–∏–≤ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω –∏ –∑–∞–≥—Ä—É–∂–µ–Ω:', zipFileName);
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
        displayMessage({
          type: 'success',
          message: `ZIP –∞—Ä—Ö–∏–≤ —Å ${svgFiles.length} –∏–∫–æ–Ω–∫–∞–º–∏ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω!`
        });
        
        // –û—á–∏—â–∞–µ–º –º–∞—Å—Å–∏–≤ —Ñ–∞–π–ª–æ–≤
        svgFiles = [];
        expectedFilesCount = 0;
        
      } catch (error) {
        console.error('SVG Export: –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ ZIP –∞—Ä—Ö–∏–≤–∞:', error);
        displayMessage({
          type: 'error',
          message: `–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∞—Ä—Ö–∏–≤–∞: ${error.message}`
        });
      }
    }
    
    // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –ø–æ –æ–¥–Ω–æ–º—É (–∫–æ–≥–¥–∞ JSZip –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞)
    function downloadFilesSequentially() {
      debugLog('SVG Export: –ù–∞—á–∏–Ω–∞–µ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ', svgFiles.length, '—Ñ–∞–π–ª–æ–≤');
      
      let downloadIndex = 0;
      
      function downloadNextFile() {
        if (downloadIndex >= svgFiles.length) {
          debugLog('SVG Export: –í—Å–µ —Ñ–∞–π–ª—ã —É—Å–ø–µ—à–Ω–æ —Å–∫–∞—á–∞–Ω—ã');
          displayMessage({
            type: 'success',
            message: `–í—Å–µ ${svgFiles.length} –∏–∫–æ–Ω–æ–∫ —Å–∫–∞—á–∞–Ω—ã –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏!`
          });
          
          // –û—á–∏—â–∞–µ–º –º–∞—Å—Å–∏–≤ —Ñ–∞–π–ª–æ–≤
          svgFiles = [];
          expectedFilesCount = 0;
          return;
        }
        
        const file = svgFiles[downloadIndex];
        debugLog(`SVG Export: –°–∫–∞—á–∏–≤–∞–µ–º —Ñ–∞–π–ª ${downloadIndex + 1}/${svgFiles.length}:`, file.name);
        
        try {
          // –°–æ–∑–¥–∞–µ–º Blob –∏–∑ SVG –¥–∞–Ω–Ω—ã—Ö
          const blob = new Blob([file.data], { type: 'image/svg+xml' });
          
          // –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫—É –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = file.name;
          
          // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∏–≤–∞–µ–º —Ñ–∞–π–ª
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          
          // –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º –ø–∞–º—è—Ç—å
          URL.revokeObjectURL(url);
          
          downloadIndex++;
          
          // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ñ–∞–π–ª—É —Å –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
          setTimeout(downloadNextFile, 300); // 300ms –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —Å–∫–∞—á–∏–≤–∞–Ω–∏—è–º–∏
          
        } catch (error) {
          console.error('SVG Export: –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏ —Ñ–∞–π–ª–∞:', file.name, error);
          downloadIndex++;
          setTimeout(downloadNextFile, 300);
        }
      }
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
      displayMessage({
        type: 'success',
        message: `–ù–∞—á–∏–Ω–∞–µ–º —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ ${svgFiles.length} —Ñ–∞–π–ª–æ–≤. –í–∞—à –±—Ä–∞—É–∑–µ—Ä –º–æ–∂–µ—Ç –∑–∞–ø—Ä–æ—Å–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∑–∫–∏.`
      });
      
      // –ù–∞—á–∏–Ω–∞–µ–º —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ
      downloadNextFile();
    }
    
    // –§—É–Ω–∫—Ü–∏–∏ displayError –∏ displaySuccess —É–∂–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤—ã—à–µ —Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    
    // ============================================
    // AI Design Lint —Ñ—É–Ω–∫—Ü–∏–∏
    // ============================================
    
    const analyzeDesignButton = document.getElementById('analyze-design-button');
    const yandexTokenInput = document.getElementById('yandex-token');
    const aiPromptInput = document.getElementById('ai-prompt');
    const aiAnalysisResult = document.getElementById('ai-analysis-result');
    const aiMainScreen = document.getElementById('ai-main-screen');
    const aiSettingsScreen = document.getElementById('ai-settings-screen');
    const aiSettingsButton = document.getElementById('ai-settings-button');
    const aiSettingsBackButton = document.getElementById('ai-settings-back-button');
    const aiSaveSettingsButton = document.getElementById('ai-save-settings-button');
    const aiLoadJsonButton = document.getElementById('ai-load-json-button');
    const aiClearJsonButton = document.getElementById('ai-clear-json-button');
    const aiJsonFileInput = document.getElementById('ai-json-file-input');
    const aiJsonStatus = document.getElementById('ai-json-status');
    const aiJsonStatusText = document.getElementById('ai-json-status-text');
    const aiViewJsonButton = document.getElementById('ai-view-json-button');
    const aiJsonModal = document.getElementById('ai-json-modal');
    const aiCloseJsonModal = document.getElementById('ai-close-json-modal');
    const aiJsonPreview = document.getElementById('ai-json-preview');
    const aiChatSection = document.getElementById('ai-chat-section');
    const aiFollowUpInput = document.getElementById('ai-follow-up-input');
    const aiAskQuestionButton = document.getElementById('ai-ask-question-button');
    const aiClearHistoryButton = document.getElementById('ai-clear-history-button');
    const aiTokensCount = document.getElementById('ai-tokens-count');
    const aiChatTokensInfo = document.getElementById('ai-chat-tokens-info');
    
    // –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ JSON
    let customDesignSystemJson = null;
    
    // –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞ —Å AI
    let aiChatHistory = [];
    let lastDesignInfo = null;
    let lastSystemPrompt = null;
    
    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —ç–∫—Ä–∞–Ω –Ω–∞—Å—Ç—Ä–æ–µ–∫
    if (aiSettingsButton) {
      aiSettingsButton.addEventListener('click', () => {
        aiMainScreen.style.display = 'none';
        aiSettingsScreen.style.display = 'block';
      });
    }
    
    // –í–æ–∑–≤—Ä–∞—Ç –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω
    if (aiSettingsBackButton) {
      aiSettingsBackButton.addEventListener('click', () => {
        aiSettingsScreen.style.display = 'none';
        aiMainScreen.style.display = 'block';
      });
    }
    
    // –ó–∞–≥—Ä—É–∑–∫–∞ JSON —Ñ–∞–π–ª–∞
    if (aiLoadJsonButton && aiJsonFileInput) {
      aiLoadJsonButton.addEventListener('click', () => {
        aiJsonFileInput.click();
      });
      
      aiJsonFileInput.addEventListener('change', (e) => {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = (event) => {
            try {
              const jsonData = JSON.parse(event.target.result);
              customDesignSystemJson = jsonData;
              
              // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ clientStorage
              saveCustomDesignSystem(jsonData);
              
              // –û–±–Ω–æ–≤–ª—è–µ–º UI
              updateJsonStatus(file.name, true);
              
              debugLog('AI Design Lint: JSON –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º—ã –∑–∞–≥—Ä—É–∂–µ–Ω:', jsonData);
            } catch (error) {
              console.error('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON:', error);
              displayMessage({
                type: 'error',
                message: '–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è JSON —Ñ–∞–π–ª–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç.'
              });
            }
          };
          reader.readAsText(file);
        }
      });
    }
    
    // –û—á–∏—Å—Ç–∫–∞ JSON
    if (aiClearJsonButton) {
      aiClearJsonButton.addEventListener('click', () => {
        customDesignSystemJson = null;
        clearCustomDesignSystem();
        updateJsonStatus('', false);
        aiJsonFileInput.value = '';
      });
    }
    
    // –ü—Ä–æ—Å–º–æ—Ç—Ä JSON
    if (aiViewJsonButton && aiJsonModal && aiJsonPreview) {
      aiViewJsonButton.addEventListener('click', () => {
        if (customDesignSystemJson) {
          aiJsonPreview.textContent = JSON.stringify(customDesignSystemJson, null, 2);
          aiJsonModal.style.display = 'block';
        }
      });
    }
    
    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    if (aiCloseJsonModal && aiJsonModal) {
      aiCloseJsonModal.addEventListener('click', () => {
        aiJsonModal.style.display = 'none';
      });
      
      // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –Ω–∞ —Ñ–æ–Ω
      aiJsonModal.addEventListener('click', (e) => {
        if (e.target === aiJsonModal) {
          aiJsonModal.style.display = 'none';
        }
      });
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ JSON
    function updateJsonStatus(fileName, hasJson) {
      if (aiJsonStatus && aiJsonStatusText && aiClearJsonButton) {
        if (hasJson) {
          aiJsonStatus.style.display = 'block';
          aiJsonStatusText.textContent = `‚úì –ó–∞–≥—Ä—É–∂–µ–Ω: ${fileName}`;
          aiJsonStatusText.style.color = '#4CAF50';
          aiClearJsonButton.disabled = false;
        } else {
          aiJsonStatus.style.display = 'none';
          aiJsonStatusText.textContent = '–§–∞–π–ª –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω';
          aiJsonStatusText.style.color = '#AAAAAA';
          aiClearJsonButton.disabled = true;
        }
      }
    }
    
    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–π –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º—ã
    function saveCustomDesignSystem(jsonData) {
      parent.postMessage({
        pluginMessage: {
          type: 'save-custom-design-system',
          data: jsonData
        }
      }, '*');
    }
    
    // –û—á–∏—Å—Ç–∫–∞ –∫–∞—Å—Ç–æ–º–Ω–æ–π –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º—ã
    function clearCustomDesignSystem() {
      parent.postMessage({
        pluginMessage: {
          type: 'clear-custom-design-system'
        }
      }, '*');
    }
    
    // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π –∫–∞—Å—Ç–æ–º–Ω–æ–π –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º—ã
    function loadCustomDesignSystem() {
      parent.postMessage({
        pluginMessage: {
          type: 'get-custom-design-system'
        }
      }, '*');
    }
    
    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
    if (aiSaveSettingsButton) {
      aiSaveSettingsButton.addEventListener('click', () => {
        const token = yandexTokenInput ? yandexTokenInput.value.trim() : '';
        
        if (token) {
          saveToken(token);
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        aiSaveSettingsButton.textContent = '‚úì –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ!';
        setTimeout(() => {
          aiSaveSettingsButton.textContent = '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏';
          // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω
          aiSettingsScreen.style.display = 'none';
          aiMainScreen.style.display = 'block';
        }, 1500);
      });
    }
    
    // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ —á–µ—Ä–µ–∑ Figma API
    function loadSavedToken() {
      // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Ç–æ–∫–µ–Ω –∏–∑ –ø–ª–∞–≥–∏–Ω–∞
      parent.postMessage({
        pluginMessage: {
          type: 'get-saved-token'
        }
      }, '*');
    }
    
    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ —á–µ—Ä–µ–∑ Figma API
    function saveToken(token) {
      if (token) {
        parent.postMessage({
          pluginMessage: {
            type: 'save-token',
            token: token
          }
        }, '*');
      }
    }
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ –∫–Ω–æ–ø–∫—É "–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∏–∑–∞–π–Ω"
    if (analyzeDesignButton) {
      analyzeDesignButton.addEventListener('click', async () => {
        console.log('AI Design Lint: –ö–Ω–æ–ø–∫–∞ –Ω–∞–∂–∞—Ç–∞');
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
        analyzeDesignButton.textContent = '–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º...';
        analyzeDesignButton.disabled = true;
        
        // –°–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞—Ä—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
        if (aiAnalysisResult) {
          aiAnalysisResult.style.display = 'none';
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
        const componentAnalysisPanel = document.getElementById('component-analysis-panel');
        if (componentAnalysisPanel) {
          componentAnalysisPanel.style.display = 'block';
          // –ù–ï —É–¥–∞–ª—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ! –ü—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ –≤ –Ω–∞—á–∞–ª–æ
          const loadingIndicator = document.createElement('div');
          loadingIndicator.id = 'analysis-loading-indicator';
          loadingIndicator.style.cssText = 'color: #AAAAAA; text-align: center; padding: 32px; background: #2A2A32; border-radius: 8px; margin-bottom: 16px;';
          loadingIndicator.textContent = '‚è≥ –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç...';
          componentAnalysisPanel.insertBefore(loadingIndicator, componentAnalysisPanel.firstChild);
          console.log('AI Design Lint: –ü–∞–Ω–µ–ª—å –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–∫–∞–∑–∞–Ω–∞');
        } else {
          console.error('AI Design Lint: –ü–∞–Ω–µ–ª—å component-analysis-panel –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
        }
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
        console.log('AI Design Lint: –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ analyze-component');
        parent.postMessage({
          pluginMessage: {
            type: 'analyze-component'
          }
        }, '*');
      });
    } else {
      console.error('AI Design Lint: –ö–Ω–æ–ø–∫–∞ analyze-design-button –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
    }

    // ============================================
    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
    // ============================================
    
    // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å–µ–∫—Ü–∏–π
    function toggleSection(sectionId) {
      const section = document.getElementById(sectionId);
      const toggle = event.target;
      
      if (section.style.display === 'none') {
        section.style.display = 'block';
        toggle.textContent = '‚ñº';
      } else {
        section.style.display = 'none';
        toggle.textContent = '‚ñ∂';
      }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞
    function displayAnalysisResults(analysis) {
      console.log('AI Design Lint: displayAnalysisResults –≤—ã–∑–≤–∞–Ω–∞ —Å –¥–∞–Ω–Ω—ã–º–∏:', analysis);
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∞–Ω–∞–ª–∏–∑ –¥–ª—è AI —á–∞—Ç–∞
      currentAnalysis = analysis;
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–∞–Ω–µ–ª—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
      const componentAnalysisPanel = document.getElementById('component-analysis-panel');
      if (!componentAnalysisPanel) {
        console.error('AI Design Lint: –ü–∞–Ω–µ–ª—å component-analysis-panel –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –ø—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤');
        return;
      }
      
      // –£–¥–∞–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å
      const loadingIndicator = document.getElementById('analysis-loading-indicator');
      if (loadingIndicator) {
        loadingIndicator.remove();
      }
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å
      componentAnalysisPanel.style.display = 'block';
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ü–µ–Ω–∫—É
      const scoreNumber = document.getElementById('score-number');
      const layersCount = document.getElementById('layers-count');
      const tokensCount = document.getElementById('tokens-count');
      const hardcodedCount = document.getElementById('hardcoded-count');
      const issuesCount = document.getElementById('issues-count');
      
      console.log('AI Design Lint: –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏:', {
        score: analysis.score,
        layers: analysis.totalLayers,
        tokens: analysis.tokensUsed?.length,
        hardcoded: analysis.hardcodedValues?.length,
        issues: analysis.recommendations?.length
      });
      
      if (scoreNumber) scoreNumber.textContent = analysis.score || 0;
      if (layersCount) layersCount.textContent = analysis.totalLayers || 0;
      if (tokensCount) tokensCount.textContent = analysis.tokensUsed ? analysis.tokensUsed.length : 0;
      if (hardcodedCount) hardcodedCount.textContent = analysis.hardcodedValues ? analysis.hardcodedValues.length : 0;
      if (issuesCount) issuesCount.textContent = analysis.recommendations ? analysis.recommendations.length : 0;
      
      // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ç–æ–∫–µ–Ω—ã
      displayTokens(analysis.tokensUsed || []);
      
      // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º hardcoded –∑–Ω–∞—á–µ–Ω–∏—è
      displayHardcodedValues(analysis.hardcodedValues || []);
      
      // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
      displayRecommendations(analysis.recommendations || []);
      
      // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤
      displayTokenSuggestions(analysis.tokenSuggestions || []);
      
      // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
      const analyzeDesignButton = document.getElementById('analyze-design-button');
      if (analyzeDesignButton) {
        analyzeDesignButton.textContent = '–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∏–∑–∞–π–Ω';
        analyzeDesignButton.disabled = false;
      }
      
      console.log('AI Design Lint: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ');
    }
    
    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
    function displayTokens(tokens) {
      const tokensList = document.getElementById('tokens-list');
      if (!tokensList) return;
      
      if (tokens.length === 0) {
        tokensList.innerHTML = '<div style="color: #AAAAAA; font-size: 12px; text-align: center; padding: 16px;">–¢–æ–∫–µ–Ω—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
          return;
        }
        
      tokensList.innerHTML = tokens.map(token => `
        <div class="token-item" onclick="highlightLayer('${token.nodeId}', event)" style="cursor: pointer;" title="–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Å–ª–æ—é –≤ Figma">
          <div class="token-info">
            <div class="token-name">${token.name}</div>
            <div class="token-type">${token.type}</div>
          </div>
          <div style="font-size: 11px; color: #AAAAAA;">${token.path}</div>
        </div>
      `).join('');
    }
    
    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ hardcoded –∑–Ω–∞—á–µ–Ω–∏–π
    function displayHardcodedValues(hardcodedValues) {
      const hardcodedList = document.getElementById('hardcoded-list');
      if (!hardcodedList) return;
      
      if (hardcodedValues.length === 0) {
        hardcodedList.innerHTML = '<div style="color: #4CAF50; font-size: 12px; text-align: center; padding: 16px;">‚úÖ –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–æ–∫–µ–Ω—ã</div>';
        return;
      }
      
      hardcodedList.innerHTML = hardcodedValues.map(item => `
        <div class="hardcoded-item" onclick="highlightLayer('${item.nodeId}', event)" style="cursor: pointer;" title="–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Å–ª–æ—é –≤ Figma">
          <div class="hardcoded-info">
            <div class="hardcoded-type">${item.type}</div>
            <div class="hardcoded-description">${item.description}</div>
          </div>
          <div class="hardcoded-value">${item.value}</div>
        </div>
      `).join('');
    }
    
    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
    function displayRecommendations(recommendations) {
      const recommendationsList = document.getElementById('recommendations-list');
      if (!recommendationsList) return;
      
      if (recommendations.length === 0) {
        recommendationsList.innerHTML = '<div style="color: #4CAF50; font-size: 12px; text-align: center; padding: 16px;">‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º</div>';
        return;
      }
      
      recommendationsList.innerHTML = recommendations.map(rec => `
        <div class="recommendation-item">
          <span class="recommendation-priority ${rec.priority}">${rec.priority.toUpperCase()}</span>
          <div class="recommendation-message">${rec.message}</div>
        </div>
      `).join('');
    }
    
    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π —Ç–æ–∫–µ–Ω–æ–≤
    function displayTokenSuggestions(suggestions) {
      const suggestionsList = document.getElementById('token-suggestions-list');
      if (!suggestionsList) return;
      
      if (suggestions.length === 0) {
        suggestionsList.innerHTML = '<div style="color: #4CAF50; font-size: 12px; text-align: center; padding: 16px;">‚úÖ –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–æ–∫–µ–Ω—ã</div>';
        return;
      }
      
      suggestionsList.innerHTML = suggestions.map(suggestion => `
        <div class="token-suggestion-item" onclick="highlightLayer('${suggestion.hardcodedValue.nodeId}', event)" style="cursor: pointer;" title="–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Å–ª–æ—é –≤ Figma">
          <div class="suggestion-header">
            <div class="suggestion-hardcoded">${suggestion.hardcodedValue.type}: ${suggestion.hardcodedValue.value}</div>
            <div class="suggestion-confidence">${Math.round(suggestion.confidence * 100)}%</div>
          </div>
          <div class="suggestion-token">‚Üí ${suggestion.suggestedToken.name}</div>
          <div class="suggestion-reason">${suggestion.reason}</div>
        </div>
      `).join('');
    }
    
    // –§—É–Ω–∫—Ü–∏—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏ —Å–ª–æ—è
    function highlightLayer(nodeId, event) {
      console.log('AI Design Lint: –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–æ—é:', nodeId);
      
      // –î–æ–±–∞–≤–ª—è–µ–º –≤–∏–∑—É–∞–ª—å–Ω—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –¥–ª—è –≤—Å–µ—Ö –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
      if (event) {
        const clickedElement = event.target.closest('.hardcoded-item, .token-item, .token-suggestion-item');
        if (clickedElement) {
          const originalBg = clickedElement.style.backgroundColor;
          const originalColor = clickedElement.style.color;
          
          clickedElement.style.backgroundColor = '#F86025';
          clickedElement.style.color = 'white';
          clickedElement.style.transition = 'all 0.15s ease';
          
          setTimeout(() => {
            clickedElement.style.backgroundColor = originalBg;
            clickedElement.style.color = originalColor;
          }, 200);
        }
      }
      
      debugLog('Highlighting layer:', nodeId);
      
      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–æ–º–∞–Ω–¥—É –≤ –ø–ª–∞–≥–∏–Ω –¥–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏ —Å–ª–æ—è
      parent.postMessage({
        pluginMessage: {
          type: 'highlight-layer',
          nodeId: nodeId
        }
      }, '*');
    }
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç –ø–ª–∞–≥–∏–Ω–∞
    window.addEventListener('message', (event) => {
      const message = event.data.pluginMessage;
      
      if (message.type === 'analysis-result') {
        console.log('AI Design Lint: –ü–æ–ª—É—á–µ–Ω analysis-result:', message);
        
        // –£–¥–∞–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
        const loadingIndicator = document.getElementById('analysis-loading-indicator');
        if (loadingIndicator) {
          loadingIndicator.remove();
        }
        
        if (message.success) {
          console.log('AI Design Lint: –ê–Ω–∞–ª–∏–∑ —É—Å–ø–µ—à–µ–Ω, –≤—ã–∑—ã–≤–∞–µ–º displayAnalysisResults');
          displayAnalysisResults(message.analysis);
        } else {
          console.error('AI Design Lint: –û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞:', message.message);
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
          const componentAnalysisPanel = document.getElementById('component-analysis-panel');
          if (componentAnalysisPanel) {
            componentAnalysisPanel.innerHTML = `
              <div style="color: #F44336; text-align: center; padding: 16px; background: #2A2A32; border-radius: 8px;">
                ‚ùå ${message.message}
              </div>
            `;
            componentAnalysisPanel.style.display = 'block';
          }
          
          // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
          const analyzeDesignButton = document.getElementById('analyze-design-button');
          if (analyzeDesignButton) {
            analyzeDesignButton.textContent = '–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∏–∑–∞–π–Ω';
            analyzeDesignButton.disabled = false;
          }
        }
      } else if (message.type === 'layer-highlighted') {
        if (message.success) {
          debugLog('–°–ª–æ–π –ø–æ–¥—Å–≤–µ—á–µ–Ω:', message.nodeId);
        } else {
          console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥—Å–≤–µ—Ç–∫–µ —Å–ª–æ—è:', message.message);
        }
      }
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —ç–∫—Å–ø–æ—Ä—Ç–∞
    document.addEventListener('DOMContentLoaded', () => {
      const exportJsonButton = document.getElementById('export-json-button');
      const exportMarkdownButton = document.getElementById('export-markdown-button');
      
      if (exportJsonButton) {
        exportJsonButton.addEventListener('click', () => {
          exportAnalysis('json');
        });
      }
      
      if (exportMarkdownButton) {
        exportMarkdownButton.addEventListener('click', () => {
          exportAnalysis('markdown');
        });
      }
    });

    // ============================================
    // –§—É–Ω–∫—Ü–∏–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞
    // ============================================
    
    // –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞
    function exportAnalysis(format) {
      if (currentAnalysis) {
        if (format === 'json') {
          exportAsJSON(currentAnalysis);
        } else if (format === 'markdown') {
          exportAsMarkdown(currentAnalysis);
        }
      } else {
        alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∞–Ω–∞–ª–∏–∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞');
      }
    }
    
    // –≠–∫—Å–ø–æ—Ä—Ç –≤ JSON
    function exportAsJSON(analysis) {
      const data = {
        timestamp: new Date().toISOString(),
        componentType: analysis.componentType,
        score: analysis.score,
        totalLayers: analysis.totalLayers,
        tokensUsed: analysis.tokensUsed || [],
        hardcodedValues: analysis.hardcodedValues || [],
        recommendations: analysis.recommendations || [],
        accessibility: analysis.accessibility || {}
      };
      
      const jsonString = JSON.stringify(data, null, 2);
      downloadFile('component-analysis.json', jsonString, 'application/json');
    }
    
    // –≠–∫—Å–ø–æ—Ä—Ç –≤ Markdown
    function exportAsMarkdown(analysis) {
      const timestamp = new Date().toLocaleString('ru-RU');
      
      let markdown = `# –ê–Ω–∞–ª–∏–∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞\n\n`;
      markdown += `**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** ${timestamp}\n\n`;
      markdown += `## –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞\n\n`;
      markdown += `- **–û—Ü–µ–Ω–∫–∞:** ${analysis.score}/100\n`;
      markdown += `- **–¢–∏–ø –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞:** ${analysis.componentType}\n`;
      markdown += `- **–í—Å–µ–≥–æ —Å–ª–æ–µ–≤:** ${analysis.totalLayers}\n\n`;
      
      // –¢–æ–∫–µ–Ω—ã
      markdown += `## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤\n\n`;
      if (analysis.tokensUsed && analysis.tokensUsed.length > 0) {
        markdown += `‚úÖ **–ù–∞–π–¥–µ–Ω–æ —Ç–æ–∫–µ–Ω–æ–≤:** ${analysis.tokensUsed.length}\n\n`;
        analysis.tokensUsed.forEach(token => {
          markdown += `- **${token.name}** (${token.type}) - ${token.path}\n`;
        });
      } else {
        markdown += `‚ùå –¢–æ–∫–µ–Ω—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã\n`;
      }
      markdown += `\n`;
      
      // Hardcoded –∑–Ω–∞—á–µ–Ω–∏—è
      markdown += `## Hardcoded –∑–Ω–∞—á–µ–Ω–∏—è\n\n`;
      if (analysis.hardcodedValues && analysis.hardcodedValues.length > 0) {
        markdown += `‚ö†Ô∏è **–ù–∞–π–¥–µ–Ω–æ hardcoded –∑–Ω–∞—á–µ–Ω–∏–π:** ${analysis.hardcodedValues.length}\n\n`;
        analysis.hardcodedValues.forEach(item => {
          markdown += `- **${item.type}:** ${item.description} (${JSON.stringify(item.value)})\n`;
        });
      } else {
        markdown += `‚úÖ Hardcoded –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã\n`;
      }
      markdown += `\n`;
      
      // –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
      markdown += `## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏\n\n`;
      if (analysis.recommendations && analysis.recommendations.length > 0) {
        analysis.recommendations.forEach(rec => {
          const priority = rec.priority === 'high' ? 'üî¥' : rec.priority === 'medium' ? 'üü°' : 'üü¢';
          markdown += `${priority} **${rec.priority.toUpperCase()}:** ${rec.message}\n\n`;
        });
      } else {
        markdown += `‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º\n\n`;
      }
      
      // –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
      markdown += `## –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å\n\n`;
      markdown += `- **–¢–µ–∫—Å—Ç–æ–≤—ã–µ –º–µ—Ç–∫–∏:** ${analysis.accessibility?.hasLabels ? '‚úÖ' : '‚ùå'}\n`;
      markdown += `- **Alt —Ç–µ–∫—Å—Ç:** ${analysis.accessibility?.hasAltText ? '‚úÖ' : '‚ùå'}\n`;
      markdown += `- **–ö–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç—å:** ${analysis.accessibility?.colorContrast || '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}\n\n`;
      
      markdown += `---\n*–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –ø–ª–∞–≥–∏–Ω–æ–º Orbita DS ‚ú¶ Icons Checker*\n`;
      
      downloadFile('component-analysis.md', markdown, 'text/markdown');
    }
    
    // –§—É–Ω–∫—Ü–∏—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞
    function downloadFile(filename, content, mimeType) {
      const blob = new Blob([content], { type: mimeType });
      const url = URL.createObjectURL(blob);
      
      const link = document.createElement('a');
      link.href = url;
      link.download = filename;
      link.style.display = 'none';
      
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      URL.revokeObjectURL(url);
    }

    // ============================================
    // AI Chat —Ñ—É–Ω–∫—Ü–∏–∏
    // ============================================
    
    let currentAnalysis = null;
    let chatHistory = [];
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è AI —á–∞—Ç–∞
    function initializeAIChat() {
      const chatSendButton = document.getElementById('ai-chat-send-button');
      const chatInput = document.getElementById('ai-chat-input');
      
      if (chatSendButton) {
        chatSendButton.addEventListener('click', sendChatMessage);
      }
      
      if (chatInput) {
        chatInput.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            sendChatMessage();
          }
        });
      }
    }
    
    // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ AI —á–∞—Ç
    function sendChatMessage() {
      const chatInput = document.getElementById('ai-chat-input');
      const chatHistory = document.getElementById('ai-chat-history');
      const chatSendButton = document.getElementById('ai-chat-send-button');
      
      if (!chatInput || !chatHistory) return;
      
      const message = chatInput.value.trim();
      if (!message) return;
      
      // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∏—Å—Ç–æ—Ä–∏—é
      addMessageToHistory('user', message);
      
      // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
      chatInput.value = '';
      
      // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
      if (chatSendButton) {
        chatSendButton.disabled = true;
        chatSendButton.textContent = '‚è≥ AI –¥—É–º–∞–µ—Ç...';
      }
      
      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –∫ Eliza API
      sendToElizaAPI(message);
    }
    
    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞
    function addMessageToHistory(role, content) {
      const chatHistory = document.getElementById('ai-chat-history');
      if (!chatHistory) return;
      
      // –£–±–∏—Ä–∞–µ–º placeholder –µ—Å–ª–∏ –µ—Å—Ç—å
      const placeholder = chatHistory.querySelector('[style*="color: #AAAAAA"]');
      if (placeholder) {
        placeholder.remove();
      }
      
      const messageDiv = document.createElement('div');
      messageDiv.style.marginBottom = '6px';
      messageDiv.style.padding = '6px 8px';
      messageDiv.style.borderRadius = '4px';
      messageDiv.style.fontSize = '11px';
      messageDiv.style.lineHeight = '1.4';
      
      if (role === 'user') {
        messageDiv.style.backgroundColor = '#F86025';
        messageDiv.style.color = 'white';
        messageDiv.style.marginLeft = '15px';
        messageDiv.innerHTML = `<strong>–í—ã:</strong> ${content}`;
      } else {
        messageDiv.style.backgroundColor = '#44444C';
        messageDiv.style.color = 'white';
        messageDiv.style.marginRight = '15px';
        messageDiv.innerHTML = `<strong>AI:</strong> ${content}`;
      }
      
      chatHistory.appendChild(messageDiv);
      chatHistory.scrollTop = chatHistory.scrollHeight;
      
      // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π
      updateTokensCount();
    }
    
    // –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ Yandex AI (–∫–∞–∫ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º analyzeWithAI)
    async function sendToElizaAPI(message) {
      try {
        console.log('AI Assistant: –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ AI...');
        
        // –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω
        const token = yandexTokenInput ? yandexTokenInput.value.trim() : '';
        if (!token) {
          addMessageToHistory('assistant', '‚ùå –û—à–∏–±–∫–∞: –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω Yandex OAuth —Ç–æ–∫–µ–Ω. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.');
          return;
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∞–Ω–∞–ª–∏–∑–∞
        if (!currentAnalysis) {
          addMessageToHistory('assistant', '‚ùå –°–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∞–Ω–∞–ª–∏–∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, –Ω–∞–∂–∞–≤ "–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∏–∑–∞–π–Ω"');
          return;
        }
        
        // –§–æ—Ä–º–∏—Ä—É–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è AI
        const context = buildAIContext();
        console.log('AI Assistant: –ö–æ–Ω—Ç–µ–∫—Å—Ç —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω');
        
        // –§–æ—Ä–º–∏—Ä—É–µ–º –ø—Ä–æ–º–ø—Ç
        const systemPrompt = `–¢—ã - —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–∞–º –∏ Figma. 

–ö–æ–Ω—Ç–µ–∫—Å—Ç –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞:
${context}

–û—Ç–≤–µ—á–∞–π –∫—Ä–∞—Ç–∫–æ –∏ –ø–æ –¥–µ–ª—É. –î–∞–≤–∞–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å–æ —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ —Ç–æ–∫–µ–Ω—ã –∏–∑ –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º—ã Orbita.`;

        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –∫ Yandex API (–∫–∞–∫ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏)
        const response = await fetch('https://api.eliza.yandex.net/v1/chat/completions', {
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            model: 'yandexgpt-lite',
            messages: [
              {
                role: 'system',
                content: systemPrompt
              },
              {
                role: 'user',
                content: message
              }
            ],
            temperature: 0.6,
            maxTokens: 500
          })
        });
        
        if (!response.ok) {
          const errorText = await response.text();
          console.error('AI Assistant: –û—à–∏–±–∫–∞ API:', response.status, errorText);
          throw new Error(`HTTP ${response.status}: ${response.statusText}`);
        }
        
        const data = await response.json();
        console.log('AI Assistant: –û—Ç–≤–µ—Ç –ø–æ–ª—É—á–µ–Ω:', data);
        
        // –ò–∑–≤–ª–µ–∫–∞–µ–º –æ—Ç–≤–µ—Ç (–∫–∞–∫ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏)
        const aiResponse = data.result?.alternatives?.[0]?.message?.text || 
                          data.choices?.[0]?.message?.content ||
                          '–ò–∑–≤–∏–Ω–∏—Ç–µ, –Ω–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç –æ—Ç AI.';
        
        addMessageToHistory('assistant', aiResponse);
        
      } catch (error) {
        console.error('AI Assistant: –û—à–∏–±–∫–∞:', error);
        addMessageToHistory('assistant', `‚ùå –û—à–∏–±–∫–∞: ${error.message}`);
      } finally {
        // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
        const chatSendButton = document.getElementById('ai-chat-send-button');
        if (chatSendButton) {
          chatSendButton.disabled = false;
          chatSendButton.textContent = 'üí¨ –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å AI';
        }
      }
    }
    
    // –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è AI
    function buildAIContext() {
      if (!currentAnalysis) return '–ê–Ω–∞–ª–∏–∑ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω';
      
      return JSON.stringify({
        score: currentAnalysis.score,
        totalLayers: currentAnalysis.totalLayers,
        tokensUsed: currentAnalysis.tokensUsed?.length || 0,
        hardcodedValues: currentAnalysis.hardcodedValues?.length || 0,
        recommendations: currentAnalysis.recommendations?.length || 0,
        componentType: currentAnalysis.componentType
      });
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤
    function updateTokensCount() {
      const tokensCount = document.getElementById('ai-chat-tokens-count');
      const tokensInfo = document.getElementById('ai-chat-tokens-info');
      
      if (tokensCount) {
        const count = chatHistory.length;
        tokensCount.textContent = count;
      }
      
      if (tokensInfo) {
        tokensInfo.style.display = chatHistory.length > 0 ? 'block' : 'none';
      }
    }
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    document.addEventListener('DOMContentLoaded', initializeAIChat);
    
    
  </script>
</body>
</html>